!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=56)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CONST={url:{tmTypes:{followingT:"FOLLOWING",followingSubT:["FOLLOWING_BY_LIST","FOLLOWING_BY_ACTIVE_AUDIENCE"],unfollowingT:"UNFOLLOWING",unfollowingSubT:["UNFOLLOWING_BY_LIST","UNFOLLOWING_BY_ALL","UNFOLLOWING_BY_NON_RECIPROCAL"],chatBotT:"CHAT_BOT",chatBotSubT:["DEFAULT_CHAT_BOT"],automessagesT:"AUTO_ANSWER",automessagesSubT:["DEFAULT_AUTO_ANSWER"],autogreetT:"AUTO_GREETING",autogreetSubT:["DEFAULT_AUTO_GREETING"],storiesT:"STORIES",storiesSubT:["STORIES_BY_LIST","STORIES_BY_FOLLOWERS","STORIES_BY_ACTIVE_AUDIENCE"],autocommentsT:"AUTO_COMMENT",autocommentsSubT:["DEFAULT_AUTO_COMMENT"]},base:"http://api.luxgram.ru/v1/",registration:"registration/basic/",login:"registration/basic/login",confirmation:"registration/basic/confirmation?token",instagram_addAccount:"instagram-accounts/",instagramAccount_getMetaData:"instagram-accounts/meta",instagram_getAccountByUser:function(e){return"instagram-accounts/meta/"+e},instagram_modifyAccount:function(e){return"instagram-accounts/"+e},instagramTaskManager_getPosts:function(e){return"instagram-accounts/"+e+"/posts"},instagramAccount_checkpoint:"instagram-accounts/checkpoint/",instagramAccount_confirmKey:"instagram-accounts/checkpoint/",instagramDirect_Basic:"instagram-direct",instagramDirect_postMessage:"instagram-direct/",instagramDirect_getMetaData:"instagram-direct/meta",instagramDirect_RequestPending:"instagram-direct/pending",instagramTaskManager:"instagram-task-manager/",instagramTaskManager_getMetaData:"instagram-task-manager/meta",instagramTaskManager_getTaskByTypes:"instagram-task-manager/meta/type/",instagramTaskManager_getDefaultConfigs:"instagram-task-manager/config/type",instagramTaskManager_postStartFollowingList:"instagram-task-manager/task",instagramTaskManager_postStartTask:"instagram-task-manager/task",instagramTaskManager_getTaskTypes:"instagram-task-manager/task/types",instagramTaskManager_putStopTaskByID:function(e){return"instagram-task-manager/task/"+e},instagramTaskManager_delRemoveTaskByID:function(e){return"instagram-task-manager/task/"+e},instagramTaskManager_postImageAttachment:"instagram-task-manager/task/attachment/image",instagramTaskManager_postTextAttachment:"instagram-task-manager/task/attachment/users_list",instagramTaskManager_getLogsChatBot:"instagram-task-manager/logs/type/"},user:{defaulAvatar:"https://i.imgur.com/jNNT4LE.png",email:"",password:"",token:""},cookieStorage:{token:"user_logged",emailConfirmed:"email_confirmed"},uiSelectors:{headerLoginBox:"nav .login-box",headerNavLoginBtn:"nav ul li .js_login",headerRegBox:"nav .register-box",headerRegBtn:"nav ul li .js_register",instagram:{addAccountBtnSelector:"#js_show-login-box",addAccountBtnId:"js_show-login-box"}},events:{USER_LOGGED:"user_logged",USER_LOGOUT:"user_logout",USER_EMAIL_CONFIRMED:"user_email_confirmed",STOP_FIXED_SPINNER:"stop_fixed_spinner",messages:{RECIEVE_NEW_MESSAGE:"receive_new_message"},instagramAccouns:{INSTAGRAM_ACCOUNS_NEED_REFRESH:"instagram_accouns_need_refresh",INSTAGRAM_ACCOUNS_RENDERED:"instagram_accouns_rendered",INSTAGRAM_ACCOUNS_RENDERED_LAZY:"instagram_accouns_rendered_lazy"},modal:{IMAGE_POST_SELECTED:"image_post_selected",IMAGE_UPLOADED_AVATAR:"IMAGE_UPLOADED_AVATAR"},autoarnswer:{IMAGE_UPLOADED:"image_loaded",TEXT_FILE_UPLOADED:"text_file_uploaded"},tasks:{NEW_TASK_CREATED:"new_task_created"},logs:{STOP_LOGS:"stop_logs"}},logsState:{selectCls:"js_logs-accounts",selectClsLogsTaskType:"js_logs-subtypes",wrapperSubtype:".log-subype"},getPath:function(e,t){return"function"==typeof this.url[e]&&t?this.url.base+this.url[e](t):this.url.base+this.url[e]},getPathTypeSubtype:function(e,t,n){var a=t.type,r=t.subtype,s=t.username;return"function"==typeof this.url[e]&&a&&r?s&&n?this.url.base+this.url[e](t,n):s?this.url.base+this.url[e](t):this.url.base+this.url[e](a,r):this.url.base+this.url[e]},getPathByArr:function(e,t,n){var a=this.url.base+this.url[e],r=function(e,t){return e+"/"+t},s=a+t.reduce(r);return n?s+"?page="+n:s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(e,t,n){$(e).empty().append(t?"<p>status: "+t+"</p>":"").append("<p>"+n+" </p>")}function t(e,t){var n=t,a=e;a.empty(),n.forEach(function(e,t){var n=$('<li class="list-group-item"></li>').appendTo(a);$("<a/>").addClass("ui-all").text(e.username).appendTo(n)})}function n(e){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)}function a(e,t){var n=new Date(e),a=n.getMonth()+1,r=n.getDate(),s=n.getHours(),i=n.getMinutes();a=(a<10?"0":"")+a,r=(r<10?"0":"")+r,s=(s<10?"0":"")+s,i=(i<10?"0":"")+i;return t?r+"-"+a+"-"+n.getFullYear()+" "+s+":"+i:s+":"+i}function r(e){return!e||0===Object.keys(e).length}function s(e,t,n){r(t);var a=n||"подписок";e.empty();for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&$('<div class="custom-control custom-radio">\n                '+function(e,t){switch(e){case"AGGRESSIVE":return'<input type="radio" id="'+e+'" name="customRadio" value="'+e+'" class="custom-control-input">\n                    <label class="custom-control-label" for="'+e+'"><strong>Агрессивный:</strong> '+t+" "+a+" в час</label>";case"MIDDLE":return'<input type="radio" id="'+e+'" name="customRadio" value="'+e+'" class="custom-control-input">\n                    <label class="custom-control-label" for="'+e+'"><strong>Средний:</strong> '+t+" "+a+" в час</label>";case"SAFE":return'<input type="radio" id="'+e+'" name="customRadio" value="'+e+'" class="custom-control-input" checked>\n                    <label class="custom-control-label" for="'+e+'"><strong>Безопасный:</strong> '+t+" "+a+" в час</label>"}}(s,t[s])+"\n            </div>").appendTo(e)}function i(e){return e.val().trim().split(",").map(function(e){return e.trim().replace("↵","")}).filter(function(e){return e.length>0})}function o(e,t,n){var a=n.textRusArray,r=n.logsState,s=r.selectClsLogsTaskType,i=function(e){var t=a&&!!a.length;switch(e){case 0:return t?a[e]:"По подписчикам";case 1:return t?a[e]:"По активной аудитории конкурентов";case 2:return t?a[e]:"default - (3)";default:return"default"}};e.empty().addClass("border-light-color"),$('<div class="">Выберите тип</div><select name="task-subtype" class="'+s+'"></select>').appendTo(e),t.length&&(n.isRenderEmptyOption&&$('<option class="list-group-item py-2 js_empty-subtype" value="---">---</option>').appendTo($("."+s)),t.forEach(function(e,t){$('<option class="list-group-item py-2" value="'+e+'">\n                '+i(t)+"\n            </option>").appendTo($("."+s))}),n.dropdownOnSelectCb&&$("."+s).on("change",function(){n.dropdownOnSelectCb()}))}return{showInfoMessage:e,fillList:t,fillRadioGroupList:s,isEmail:n,getFormattedDateUtil:a,getValByCommaSeparator:i,addDropdown:o}}()},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),l=n(16),u=a(l),c=n(4),d=a(c),p=function(e){return e&&e.subtype&&(e.subtype.includes("subtype/")||(e.subtype="subtype/"+e.subtype)),Object.values(e)},f=function(){function e(){r(this,e),this.network=new u.default,this.cookieStorage=d.default,this.settingPost={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}},this.postStartFollowingList=this.postStartFollowingList,this.postStartTask=this.postStartTask}return i(e,[{key:"getToken",value:function(e){var t=this.cookieStorage.get(o.CONST.cookieStorage.token);return e?{headers:{token:t}}:t}},{key:"getMetadata",value:function(e,t){var n=p(e);return this.network.sendRequest(""+o.CONST.getPathByArr("instagramTaskManager_getTaskByTypes",n),this.getToken("asHeader"),t)}},{key:"getMetadataLazy",value:function(e,t){var n=p(e);return n.push("?lazy=true"),this.network.sendRequest(""+o.CONST.getPathByArr("instagramTaskManager_getTaskByTypes",n),this.getToken("asHeader"),t)}},{key:"getTaskTypes",value:function(e,t){return this.network.sendRequest(""+o.CONST.getPath("instagramTaskManager_getTaskTypes"),this.getToken("asHeader"),t)}},{key:"stopTaskByID",value:function(e,t){var n=s({},this.settingPost,{method:"PUT",headers:s({},this.settingPost.headers,{token:this.getToken()})}),a=o.CONST.getPath("instagramTaskManager_putStopTaskByID",e);return this.network.sendRequest(a,n,t)}},{key:"deleteTaskByID",value:function(e,t){var n=s({},this.settingPost,{method:"DELETE",headers:s({},this.settingPost.headers,{token:this.getToken()})}),a=o.CONST.getPath("instagramTaskManager_delRemoveTaskByID",e);return this.network.sendRequest(a,n,t)}},{key:"getDefaultConfigs",value:function(e,t){var n=o.CONST.getPath("instagramTaskManager_getDefaultConfigs")+"/"+e.type+"/subtype/"+e.subtype;return this.network.sendRequest(n,this.getToken("asHeader"),t)}},{key:"postStartFollowingList",value:function(e,t,n){var a=s({},this.settingPost,{headers:s({},this.settingPost.headers,{token:this.getToken(),"X-Auth-Token":"e2f4336abea440489c51c5c10294ea12"})});a.body=JSON.stringify(e);var r=n?""+o.CONST.getPath(n):""+o.CONST.getPath("instagramTaskManager_postStartFollowingList");return this.network.sendRequest(r,a,t)}},{key:"postStartTask",value:function(e,t){return this.postStartFollowingList(e,t,"instagramTaskManager_postStartTask")}},{key:"postStartComments",value:function(e,t){return this.postStartFollowingList(e,t,"instagramTaskManager_postStartTask")}},{key:"postImageAutomessages",value:function(e,t){var n={method:"POST",headers:{token:this.getToken(),Accept:"application/json","Content-type":"multipart/form-data"}};n.body=JSON.stringify(e);var a=""+o.CONST.getPath("instagramTaskManager_postImageAttachment");return this.network.sendRequest(a,n,t)}},{key:"getLogsChatBot",value:function(e,t,n){return this.network.sendRequest(""+o.CONST.getPathByArr("instagramTaskManager_getLogsChatBot",e,t),this.getToken("asHeader"),n)}},{key:"getPostsAutomessages",value:function(e,t){var n=e.cursor?"?cursor="+e.cursor:"",a=""+o.CONST.getPath("instagramTaskManager_getPosts",e.userName||"user_not_selected")+n;return this.network.sendRequest(a,this.getToken("asHeader"),t)}},{key:"getStoriesConfig",value:function(e,t){var n=o.CONST.getPath("instagramTaskManager_getDefaultConfigs")+"/"+e.type+"/subtype/"+e.subtype;return this.network.sendRequest(n,this.getToken("asHeader"),t)}}]),e}(),m=null;m||(m=new f),t.default=m},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),l=n(16),u=a(l),c=n(4),d=a(c),p=function(){function e(){r(this,e),this.network=new u.default,this.cookieStorage=d.default,this.settingPost={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}}}return i(e,[{key:"isLoggedIn",value:function(){return!!this.getToken()}},{key:"isEmailConfirmed",value:function(){return"confirmed"===this.cookieStorage.get(o.CONST.cookieStorage.emailConfirmed)}},{key:"getToken",value:function(e){var t=this.cookieStorage.get(o.CONST.cookieStorage.token);return e?{headers:{token:t}}:t}},{key:"login",value:function(e,t){var n=s({},this.settingPost,{body:JSON.stringify(e)});return this.network.sendRequest(o.CONST.getPath("login"),n,t)}},{key:"addInstagramAccount",value:function(e,t){var n=e.username,a=e.password,r=e.ip,i=e.port,l=e.usernameProxy,u=e.passwordProxy,c={proxy:{host:r,port:i,username:l,password:u}},d=JSON.stringify(s({username:n,password:a},c)),p=s({},this.settingPost,{body:d,headers:s({},this.settingPost.headers,{token:this.getToken()})});return this.network.sendRequest(o.CONST.getPath("instagram_addAccount"),p,t)}},{key:"editInstagramAccount",value:function(e,t){var n={method:"PUT",headers:s({},this.settingPost.headers,{token:this.getToken()}),body:t};o.CONST.getPath("instagram_modifyAccount",e);return this.network.sendRequest(""+o.CONST.getPath("instagram_modifyAccount",e),n)}},{key:"updateInstagramAccount",value:function(e,t){var n={headers:s({},this.settingPost.headers,{token:this.getToken()}),body:t};return this.network.sendRequest(""+o.CONST.getPath("instagram_getAccountByUser",e),n)}},{key:"delInstagramAccount",value:function(e){var t={method:"DELETE",headers:s({},this.settingPost.headers,{token:this.getToken()})};return this.network.sendRequest(""+o.CONST.getPath("instagram_modifyAccount",e),t)}},{key:"confirm",value:function(e){return this.network.sendRequest(""+(o.CONST.getPath("confirmation")+e))}},{key:"register",value:function(e){var t=s({},this.settingPost,{body:JSON.stringify(e)});return this.network.sendRequest(o.CONST.getPath("registration"),t)}},{key:"getMetadata",value:function(e){return this.network.sendRequest(""+o.CONST.getPath("instagramAccount_getMetaData"),this.getToken("asHeader"),e)}},{key:"getMetadataLazy",value:function(e){return this.network.sendRequest(o.CONST.getPath("instagramAccount_getMetaData")+"?lazy=true",this.getToken("asHeader"),e)}},{key:"getSecurityKey",value:function(e,t){var n=s({},this.settingPost,{body:JSON.stringify({type:t}),headers:s({},this.settingPost.headers,{token:this.getToken()})});return this.network.sendRequest(""+o.CONST.getPath("instagramAccount_checkpoint")+e,n)}},{key:"confirmSecurityKey",value:function(e,t){var n={method:"DELETE",body:JSON.stringify({security_code:e}),headers:s({},this.settingPost.headers,{token:this.getToken()})};return this.network.sendRequest(""+o.CONST.getPath("instagramAccount_confirmKey")+t,n)}}]),e}(),f=null;f||(f=new p),t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){var n=[],a=!0,r=!1,s=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,s=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s={get:function(e){var t=document.cookie.match("(?:(?:^|.*; *)"+e+" *= *([^;]*).*$)|^.*$")[1];if(t)return decodeURIComponent(t)},set:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{path:"/",days:365};n.days&&(n["max-age"]=60*n.days*60*24,delete n.days),n=Object.entries(n).reduce(function(e,t){var n=r(t,2);return e+"; "+n[0]+"="+n[1]},""),document.cookie=e+"="+(encodeURIComponent(t)+n)},remove:function(e,t){return s.set(e,"",a({"max-age":-1,path:"/",days:0},t))}};t.default=s},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){var a=n.progress,r=n.created_at,s=n.task_id,i=n.type,o=n.status,l=n.username,u=n.mode,c=function(e){$('<li class="list-group-item p-0 py-2" data-type="'+i+'" data-task-id="'+s+'">\n                '+e+"\n            </li>").appendTo(t)},d='<div class="card-block">\n        <h4 class="card-title">На паузе</h4>\n        <div class="text-right">\n            '+(a&&a.timestamp?'<span class="text-muted">'+p.default.getFormattedDateUtil(a.timestamp)+"</span>":"")+"\n            "+(r?'<span class="text-muted">'+p.default.getFormattedDateUtil(r)+"</span>":"")+'\n        </div>\n        <span class="text-success">10%</span>\n        <div class="progress mb-3">\n            <div class="progress-bar bg-success" role="progressbar" style="width: 10%; height: 6px;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>\n        </div>\n        <button class="btn btn-warning js_btn-delete-task">Удалить</button>',f='<div class="no-gutters px-2 row task-progress">\n            <div class="col-6 align-items-center d-flex">\n                <img src="'+sessionStorage.getItem(l)+'" class="rounded-circle avatar" alt="аватар"/>\n                <h2 class="mt-0 mb-1 ml-2">'+l+'</h2>\n            </div>\n            <div class="col-6 col-6--with-borders">\n                <p class="pb-1 name"><b>ID:</b> '+s+"</p>\n                "+(r?'<p class="pb-1"><b>Запущено:</b> '+p.default.getFormattedDateUtil(r,"showFullTime")+"</p>":"")+"\n                "+(u?'<p class="pb-1"><b>Режим:</b> '+m(u)+"</p>":"")+'\n                <div class="text-center">\n                    <button class="btn btn-outline-primary js_btn-stop-task"><i class="far fa-pause-circle fa-lg"></i></button>\n                    \x3c!--button class="btn btn-warning js_btn-delete-task ml-3"><i class="far fa-trash-alt fa-lg"></i></button--\x3e\n                </div>\n            </div>\n        </div>',g='<div class="no-gutters px-2 row task-stopped">\n            <div class="col-6 align-items-center d-flex">\n                <img src="'+sessionStorage.getItem(l)+'" class="rounded-circle avatar" alt="аватар"/>\n                <h2 class="mt-0 mb-1 ml-2">'+l+'</h2>\n            </div>\n            <div class="col-6 col-6--with-borders">\n                <p class="pb-1 name"><b>ID:</b> '+s+"</p>\n                "+(n.status.reason?'<p class="my-1">'+o.reason+"</p>":"")+"\n                "+(r?'<p class="pb-1"><b>Запущено:</b> '+p.default.getFormattedDateUtil(r,"showFullTime")+"</p>":"")+"\n                "+(u?'<p class="pb-1"><b>Режим:</b> '+m(u)+"</p>":"")+'\n                <div class="text-center">\n                    <button class="btn btn-warning js_btn-delete-task"><i class="far fa-trash-alt fa-lg"></i></button>\n                </div>\n            </div>\n\n        </div>',h='<div class="no-gutters px-2 row task-progress">\n            <div class="col-6 align-items-center d-flex">\n                <img src="'+sessionStorage.getItem(l)+'" class="rounded-circle avatar" alt="аватар"/>\n                <h2 class="mt-0 mb-1 ml-2">'+l+'</h2>\n            </div>\n            <div class="col-6 col-6--with-borders">\n                <p class="pb-1 name"><b>ID:</b> '+s+"</p>\n                "+(r?'<p class="pb-1"><b>Запущено:</b> '+p.default.getFormattedDateUtil(r,"showFullTime")+"</p>":"")+"\n                "+(u?'<p class="pb-1"><b>Режим:</b> '+m(u)+"</p>":"")+'\n                <div class="text-center">\n                    \x3c!--<button class="btn btn-outline-primary js_btn-stop-task"><i class="far fa-pause-circle fa-lg"></i></button>--\x3e\n                    <button class="btn btn-warning js_btn-delete-task ml-3"><i class="far fa-trash-alt fa-lg"></i></button>\n                </div>\n            </div>\n        </div>';switch(e){case"PAUSED":c(d);break;case"IN_PROGRESS":case"GLOBAL_PAUSE":c(f);break;case"STOPPED":c(g);break;case"FINISHED":c(h)}}function s(e,t){if(e.empty(),!t.length)return void $('<li class="list-group-item py-2">\n                <p>Нет ни одной задачи.</p>\n            </li>').appendTo(e);t.forEach(function(t){r(t.status.state,e,t)}),$("li",e).length||$('<li class="list-group-item py-2">\n            <p>Нет ни одной задачи.</p>\n        </li>').appendTo(e)}function i(e,t){var n=t||{type:f.CONST.url.tmTypes.followingT,subtype:f.CONST.url.tmTypes.followingSubT[0]},a=$(".js_btn-stop-task"),r=$(".js_btn-delete-task"),s=function(e){return $(e.target).closest("li").data("task-id")};a.on("click",function(t){var a=s(t);c.default.stopTaskByID(a).then(function(t){o(e,n)})}),r.on("click",function(t){var a=s(t);c.default.deleteTaskByID(a).then(function(t){o(e,n)})})}function o(e,t){var n=e.$all,a=t||{type:f.CONST.url.tmTypes.followingT,subtype:f.CONST.url.tmTypes.followingSubT[0]};c.default.getMetadata(a).then(function(a){"ok"===a.status.state&&(s(n,a.data.meta,"isAll"),i(e,t))})}function l(){var e={$runs:$(".follow-tasks-runs"),$stopped:$(".follow-tasks-stopped"),$all:$(".follow-tasks-all")};o(e),window.PubSub.subscribe(f.CONST.events.tasks.NEW_TASK_CREATED,function(t,n){var a={type:f.CONST.url.tmTypes.followingT,subtype:f.CONST.url.tmTypes.followingSubT[0]};o(e,a)})}Object.defineProperty(t,"__esModule",{value:!0}),t.getTasksData=o,t.init=l;var u=n(2),c=a(u),d=n(1),p=a(d),f=n(0),m=function(e){switch(e){case"AGGRESSIVE":return"Агрессивный";case"MIDDLE":return"Средний";case"SAFE":return" Безопасный"}}},function(e,t,n){"use strict";function a(e,t){var n=$(e),a=t.stepReducer,r=t.onSubmitHandler;$(".js_profile-user-follow>.container").removeClass("container"),n.find("fieldset:first-child").fadeIn("slow"),n.find('input[type="text"]').on("focus",function(){$(this).removeClass("input-error")}),n.find(".btn-next").on("click",function(){var e=$(this).parents("fieldset"),t=!0,n=e.find('input[name="userAccountRadio"]:checked');n.length>0&&(o.username=n.parents("li").data("username")),a&&a(e.index(),o),e.find('input[type="text"],input[type="email"]').each(function(){""===$(this).val()?($(this).addClass("input-error"),t=!1):$(this).removeClass("input-error")}),t&&e.fadeOut(400,function(){$(this).next().fadeIn()})}),n.find(".btn-previous").on("click",function(){$(this).parents("fieldset").fadeOut(400,function(){$(this).prev().fadeIn()})}),$(".js_follow-speed input[type=radio]").on("click",function(){}),n.on("submit",function(e){$(this).find('input[type="text"],input[type="number"],input[type="email"]').each(function(){""===$(this).val()?(e.preventDefault(),$(this).addClass("input-error")):$(this).removeClass("input-error")}),r&&r(e)}),$(".form-submit-finish .close").on("click",function(e){$(this).closest(".form-submit-finish").removeClass("d-block"),e.stopPropagation()}),$("#v-pills-create-task-tab").on("click",function(e){"none"===$("fieldset:first-child").css("display")&&n.find("fieldset").hide("fast",function(){n.find("fieldset:first-child").show("slow")}),$(".form-submit-finish").removeClass("d-block"),$("fieldset",l).find('input:not([type="radio"]), textarea').val("")})}function r(){var e=$(".accounts-list"),t=e.find("li.media");t.addClass("js_user-radio").removeClass("py-3 media");for(var n=0;n<t.length;n++){var a=$(t[n]);a.wrapInner(function(e){return'<label class="accounts-list--label-wrapper col mb-0 media py-3" for="customRadio-'+e+'"></label>'}(n)).append(function(e){return'<div class="">\n            <input type="radio" name="userAccountRadio" id="customRadio-'+e+'" class="custom-control-input d-none" value="">\n        </div>'}(n)),a.find(".user-checkpoint .text-danger").length&&a.remove()}$(".js_user-radio").on("click","input[type=radio]",function(e){var t=$(this).parents("fieldset");$("li.active",t).removeClass("active"),$(this).closest("li").addClass("active"),$(".btn-next",t).prop("disabled",!1)})}function s(e){$(".wizard-form").length&&(a(l,e),window.PubSub.subscribe(i.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_RENDERED,function(e,t){r()}))}Object.defineProperty(t,"__esModule",{value:!0}),t.init=s;var i=n(0),o={username:""},l=".wizard-form"},function(e,t,n){"use strict";function a(e){var t=e.find("input");t.replaceWith(t.clone()),e.find(h).hide(),e.find(".image-upload-wrap").show()}function r(e,t){switch(e.target.error.code){case e.target.error.NOT_FOUND_ERR:case e.target.error.NOT_READABLE_ERR:case e.target.error.ABORT_ERR:}}function s(e,t){if(e.lengthComputable){Math.round(e.loaded/e.total*100)}}function i(e){return"image/jpeg"===e.type}function o(e){var t=Math.round(e.size);return m>t}function l(e,t){var n=d.CONST.getPath("instagramTaskManager_postImageAttachment"),a=f.default.getToken(),r=e.files[0],s=new FormData,i=new XMLHttpRequest;if(t&&t.replaceWith){s.append("photo",r,r.name);var o=t.username;return i.open("PUT","http://api.luxgram.ru/v1/instagram-accounts/"+o+"/photo"),i.setRequestHeader("token",a),i.setRequestHeader("Accept","application/json"),i.setRequestHeader("cache-control","no-cache"),i.send(s),void i.addEventListener("readystatechange",function(){4===this.readyState&&window.PubSub.publish(d.CONST.events.autoarnswer.IMAGE_UPLOADED_AVATAR,{response:this.response})})}s.append("image",r,r.name),i.open("POST",n),i.setRequestHeader("token",a),i.setRequestHeader("Accept","application/json"),i.setRequestHeader("cache-control","no-cache"),i.send(s),i.addEventListener("readystatechange",function(){4===this.readyState&&window.PubSub.publish(d.CONST.events.autoarnswer.IMAGE_UPLOADED,{response:this.responseText,el:e})})}function u(e,t,n){var u=t.replaceWith,c=t.holderCls,d=c||g,p=$(e).closest(d);if(e.files&&e.files[0]){var v=new FileReader;if(!o(e.files[0])||!i(e.files[0]))return $(g).find("warning-image").remove(),$(g).append('\n                <div class="warning-image text-danger">\n                    <p>Доступный формат изображения jpeg или jpg</p>\n                    <p class="msg-max-size-img text-danger">Максимальный допустимый размер картинки '+m/1024/1024+"MB</p>\n                </div>\n            "),void setTimeout(function(){$(".warning-image").addClass("d-none")},5e3);v.onload=function(n){if(u){var a=t.imageCls;p.find(a).attr("src",n.target.result)}else p.find(".image-upload-wrap").hide(),p.find(".file-upload-image").attr("src",n.target.result),p.find(h).show(),p.find(".image-title").html(e.files[0].name)},v.onerror=r,v.onprogress=s,v.readAsDataURL(e.files[0]),setTimeout(function(){if("function"==typeof n){var a=f.default.getToken();n(e,a)}else l(e,t)},2e3)}else a(p)}function c(e,t){var n=e&&e.replaceWith?e.uploadBtnCls:".file-upload-btn",r=$(n),s=$(".file-upload-input"),i=$(".remove-image");r.off(),s.off(),i.off(),r.on("click",function(t){var n=e&&e.replaceWith?e.holderCls:".col";$(t.target).closest(n).find(g).find("input.file-upload-input").trigger("click"),t.stopPropagation()}),s.on("change",function(n){u(n.target,e,t)}),i.on("click",function(e){var t=$(e.target).closest(".col").find(g);a(t),t.removeAttr("attached-img-id")})}Object.defineProperty(t,"__esModule",{value:!0}),t.init=c;var d=n(0),p=n(2),f=function(e){return e&&e.__esModule?e:{default:e}}(p),m=1048576,g=".file-upload",h=".file-upload-content",v=$(".image-upload-wrap");v.bind("dragover",function(){$(".image-upload-wrap").addClass("image-dropping")}),v.bind("dragleave",function(){$(".image-upload-wrap").removeClass("image-dropping")})},function(e,t,n){"use strict";function a(e,t,n){var a=$(f.pagination),r=n.settings.pagination;e.on("click",function(t){var n=a.find("li.page-number.active"),s=r.previous;if(!r.previous)return void e.addClass("disabled").prop("disabled","disabled");b=r.previous,n.removeClass("active"),l(m,v,s)}),t.on("click",function(t){var n=a.find("li.page-number.active"),s=n.index(),i=r.next;r.next&&(b=r.next,n.removeClass("active"),s&&e.hasClass("disabled")&&e.removeClass("disabled"),l(m,v,i))}),$(f.logsTabBtn).on("click",function(e){b=1}),$(f.pagination+" "+f.paginationPgNumber).on("click",function(e){e.preventDefault();var t=$(e.target).text();b=parseInt(t,10),l(m,v,b)})}function r(e,t){var n=e.settings.pagination,r=$('<li class="page-item '+(n.previous?"":"disabled")+'"><a class="page-link" href="#" '+(n.previous?"":'tabindex="-1"')+">Назад</a></li>"),i=$('<li class="page-item '+(n.next?"":"disabled")+'"><a class="page-link" href="#" '+(n.next?"":'tabindex="-1"')+">Вперед</a></li>");s(t),(n.next||n.pages&&n.current===n.pages[n.pages.length-1])&&(t.append(r),n&&n.pages&&n.pages.forEach(function(e){$('<li class="page-item page-number '+(n.current===e?"active":"")+'"><a class="page-link" href="#">'+e+"</a></li>").appendTo(t)}),t.append(i)),a(r,i,e)}function s(e){e.empty()}function i(e,t,n){var a=$(".logs-pagination"),i=t.logs;if(e.empty(),!i.length)return $('<li class="list-group-item py-2">\n            <p>Нет ни одного лога.</p>\n        </li>').appendTo(e),void s(a);r(t,a),i.forEach(function(t){var n=t.level,a=t.value;$('<li class="list-group-item p-0 py-2">\n              <div class="media-body d-flex">\n                  <div class="col task-type '+("ERROR"===n?"text-danger":"")+" "+("WARN"===n?"text-warning":"")+'">\n                      '+(a?""+a:"")+"\n                  </div>\n              </div>\n          </li>").appendTo(e),$("li",e).length||$('<li class="list-group-item py-2" >\n                <p>Нет ни одного лога.</p>\n            </li>').appendTo(e)})}function o(){var e=$("#v-pills-tab");e.off(),e.on("click","a",function(e){e.preventDefault(),"v-pills-logs-tab"!==$(e.target).attr("id")&&_&&clearInterval(_)})}function l(e,t,n){t.username=h(g);var a=[t.type,"subtype/"+t.subtype,"account/"+t.username];p.default.getLogsChatBot(a,n).then(function(n){if("ok"===n.status.state){i(e,n.data),o();var a=n.data.settings.invoke_in_millis;_&&clearInterval(_),b<=1&&(_=setInterval(function(){l(e,t,b)},a))}else $('<li class="list-group-item py-2">\n                <p>Нет доступа</p>\n            </li>').appendTo(e)})}function u(e){f=e,m=$(f.tasksList),v.type=e.pathType,v.subtype=e.pathSubType}function c(e,t){$(t.currentPageCls).length&&(g=e,u(t),h()&&l(m,v))}Object.defineProperty(t,"__esModule",{value:!0}),t.init=c;var d=n(2),p=function(e){return e&&e.__esModule?e:{default:e}}(d),f={currentPageCls:"",tasksList:"",logsTabBtn:"",pagination:"",paginationPgNumber:""},m="$(clsConst.tasksList)",g="someClass",h=function(){return $("."+g+" option:selected").val()},v={username:h()},b=null,_=""},function(e,t,n){"use strict";function a(e,t){var n=e.$wrapper,a=e.logsState,r=e.OnChangeSelectCb,s=a.selectCls;n.empty().addClass("border-light-color"),$('<div class="">Выберите аккаунт</div><select name="task-type" class="'+s+'"></select>').appendTo(n),t.forEach(function(e){$('<option class="list-group-item py-2" value="'+e+'">\n            '+e+"\n        </option>").appendTo($("."+s))}),r()}function r(){u.default.getMetadataLazy().then(function(e){if("ok"===e.status.state&&e.data&&e.data.accounts){a(c,e.data.accounts),window.PubSub.publish(o.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_RENDERED_LAZY,e.data.accounts)}})}function s(e){$("#v-pills-logs-tab").on("click",function(e){r()})}function i(e,t){var n=$(".log-users-list");Object.assign(c,{$wrapper:n,OnChangeSelectCb:e,logsState:t}),s()}Object.defineProperty(t,"__esModule",{value:!0}),t.init=i;var o=n(0),l=n(3),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c={}},function(e,t,n){"use strict";function a(e,t){var n=/^[A-Za-z0-9,._ \n]+$/,a=function(e,a){var r=a?"":$(e.target).closest("div input").val(),i=a?"":$(e.target).closest("div").find(".bootstrap-tagsinput input").val()+","+r,o=!a&&"itemRemoved"===e.type,l=o?r:"";t.attr("disabled","disabled");var u=i.length&&n.test(i),c=l.length&&n.test(l);(u||c)&&","!==i?($(e.target).closest("div").find(s).removeClass("border-danger"),t.removeAttr("disabled","disabled")):a||$(e.target).closest("div").find(s).addClass("border-danger")};a(null,"isInit"),$("input").on("beforeItemAdd",a),$("input").on("itemRemoved",a)}function r(){$('input[data-role="tagsinput"]').tagsinput("items")}Object.defineProperty(t,"__esModule",{value:!0}),t.nextBtnvalidateCompetitorsHandler=a,t.initTagsInput=r,n(51);var s=".bootstrap-tagsinput"},function(e,t,n){(function(e){!function(n,a){"use strict";var r={};n.PubSub=r;var s=n.define;!function(e){function t(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function n(e){return function(){throw e}}function a(e,t,a){try{e(t,a)}catch(e){setTimeout(n(e),0)}}function r(e,t,n){e(t,n)}function s(e,t,n,s){var i,o=u[t],l=s?r:a;if(u.hasOwnProperty(t))for(i in o)o.hasOwnProperty(i)&&l(o[i],e,n)}function i(e,t,n){return function(){var a=String(e),r=a.lastIndexOf(".");for(s(e,e,t,n);-1!==r;)a=a.substr(0,r),r=a.lastIndexOf("."),s(e,a,t,n)}}function o(e){for(var n=String(e),a=Boolean(u.hasOwnProperty(n)&&t(u[n])),r=n.lastIndexOf(".");!a&&-1!==r;)n=n.substr(0,r),r=n.lastIndexOf("."),a=Boolean(u.hasOwnProperty(n)&&t(u[n]));return a}function l(e,t,n,a){e="symbol"==typeof e?e.toString():e;var r=i(e,t,a);return!!o(e)&&(!0===n?r():setTimeout(r,0),!0)}var u={},c=-1;e.publish=function(t,n){return l(t,n,!1,e.immediateExceptions)},e.publishSync=function(t,n){return l(t,n,!0,e.immediateExceptions)},e.subscribe=function(e,t){if("function"!=typeof t)return!1;e="symbol"==typeof e?e.toString():e,u.hasOwnProperty(e)||(u[e]={});var n="uid_"+String(++c);return u[e][n]=t,n},e.subscribeOnce=function(t,n){var a=e.subscribe(t,function(){e.unsubscribe(a),n.apply(this,arguments)});return e},e.clearAllSubscriptions=function(){u={}},e.clearSubscriptions=function(e){var t;for(t in u)u.hasOwnProperty(t)&&0===t.indexOf(e)&&delete u[t]},e.unsubscribe=function(t){var n,a,r,s="string"==typeof t&&(u.hasOwnProperty(t)||function(e){var t;for(t in u)if(u.hasOwnProperty(t)&&0===t.indexOf(e))return!0;return!1}(t)),i=!s&&"string"==typeof t,o="function"==typeof t,l=!1;if(s)return void e.clearSubscriptions(t);for(n in u)if(u.hasOwnProperty(n)){if(a=u[n],i&&a[t]){delete a[t],l=t;break}if(o)for(r in a)a.hasOwnProperty(r)&&a[r]===t&&(delete a[r],l=!0)}return l}}(r),"function"==typeof s&&s.amd?s(function(){return r}):(void 0!==e&&e.exports&&(t=e.exports=r),t.PubSub=r,e.exports=t=r)}("object"==typeof window&&window||this)}).call(t,n(54)(e))},function(e,t,n){"use strict";function a(e,t,n){var a=function(e,t,n){e?t.insertAfter(n.find("li:last-child")):t.appendTo(n)};n||e.empty(),t.forEach(function(t,r){var s=t.id,i=t.type,o=$('<li class="col-4 list-group list-inline-item m-0 p-0" data-post-id="'+s+'" data-post-type="'+i+'">\n            '+("photo"===t.type?'<img src="'+t.url+'" class="img-responsive p-2" alt="image" style="max-height: 230px;"/>':'<div class="'+t.type+' h-100">\n                    \x3c!--style="background-image: url('+t.url+');"--\x3e\n                    <img src="'+t.url+'" class="img-responsive p-2 w-100" alt="video-cover" style="max-height: 200px;"/>\n                    <i class="fas fa-video fa-2x position-absolute text-white align-self-start"></i>\n                  </div>')+"\n        </li>");a(n,o,e)})}function r(e,t){$("#load-more").attr("cursor",t),e.removeClass("d-none")}function s(e){e.addClass("d-none")}function i(e,t,n){$("li",e).on("click",function(e){var a=$(e.target).closest("li"),r=a.attr("data-post-id"),s=a.attr("data-post-type"),i=n.closest(".col");window.PubSub.publish(l.CONST.events.modal.IMAGE_POST_SELECTED,{$btnLi:a,closestCol:i}),t.modal("hide"),n.closest(".col").find(".js_uploaded-img-from-posts").length&&n.closest(".col").find(".js_uploaded-img-from-posts").remove();var o=$('<div class="js_uploaded-img-from-posts uploaded-img-from-posts" \n                data-post-id="'+r+'" data-post-type="'+s+'">\n                    <button class="btn btn-warning uploaded-img-from-posts--remove-btn ml-2 js_delete-post-img">Удалить</button>\n                </div').prepend(a.find("img"));n.closest(".col").append(o),$(".js_delete-post-img").off().on("click",function(e){$(e.target).closest(".col").find(".js_uploaded-img-from-posts").remove()})})}function o(e,t,n){var l=n.loadMoreHandler,u=n.targetButton;c.default.getPostsAutomessages(t).then(function(t){if("ok"===t.status.state){var n=t.data,c=e?$(".modal-footer",e):null,d=$(".modal-body .posts-list",e);if(!n.posts.length)return u.popover({container:"body",content:"У текущего аккаунта нет ни одного поста",placement:"bottom"}),void setTimeout(function(){u.popover("destroy")},4e3);e?(a(d,n.posts),e.modal("show"),e.modal("handleUpdate"),i(d,e,u)):n.posts&&(a(d,n.posts,"appendToList"),i(d,$("#postsGridModal"),u)),n.pagination&&n.pagination.cursor?(r(c,n.pagination.cursor),l(o)):s($(".modal-footer",e))}})}Object.defineProperty(t,"__esModule",{value:!0}),t.fillPosts=a,t.getPosts=o;var l=n(0),u=n(2),c=function(e){return e&&e.__esModule?e:{default:e}}(u)},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e,t){t.length&&e.length&&(e.appendTo(t),e.addClass("col"),t.addClass("row"),t.find(".log-subype").addClass("col-auto"))}function s(e){function t(e){l.pathSubType=$("."+m+" option:selected").val(),$(".js_logs-container").addClass("d-block"),$("option.js_empty-subtype").remove()}function n(){var e=$("."+f+" option:selected").val();c(e),u.init(f,l)}function a(){t(),n(),$("."+m).on("change",function(){t(),u.init(f,l)}),$("."+f).on("change",function(){n()})}var s=e.logsState,i=e.logsSubtypes,l=e.clsConst,c=e.setUserNameCb,p=e.textRusArray,f=s.selectCls,m=s.selectClsLogsTaskType;o.default.addDropdown($(s.wrapperSubtype),i,{logsState:s,isRenderEmptyOption:!1,textRusArray:p}),d.init(a,s),r($(".log-users-list "),$(".log-subype--box"))}Object.defineProperty(t,"__esModule",{value:!0}),t.initLogsTab=s;var i=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i),l=n(8),u=a(l),c=n(9),d=a(c)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){return"text/plain"===e.type}function s(e){var t=Math.round(e.size);return g>t}function i(e){var t=u.CONST.getPath("instagramTaskManager_postTextAttachment"),n=d.default.getToken(),a=e.files[0],r=new FormData;r.append("file",a,a.name);var s=new XMLHttpRequest;s.open("POST",t),s.setRequestHeader("token",n),s.setRequestHeader("Accept","application/json"),s.setRequestHeader("cache-control","no-cache"),s.send(r),s.addEventListener("readystatechange",function(){4===this.readyState&&window.PubSub.publish(u.CONST.events.autoarnswer.TEXT_FILE_UPLOADED,{response:this.responseText,el:e})}),f.default.add($(".add-file"),"")}function o(e){var t=$(e).closest(m);if(e.files&&e.files[0]){var n=new FileReader;if(!s(e.files[0])||!r(e.files[0]))return $(m).append('\n                <div class="warning-image text-danger">\n                    <p>Доступный формат изображения '+h+'</p>\n                    <p class="msg-max-size-img text-danger">Максимальный допустимый размер картинки 100 MB</p>\n                </div>\n            '),void setTimeout(function(){$(".warning-image").addClass("d-none")},5e3);n.onload=function(n){t.find(".image-upload-wrap").hide(),t.find(".file-upload-image").attr("src",n.target.result),t.find(".image-title").html(e.files[0].name)},n.readAsDataURL(e.files[0]),setTimeout(function(){return i(e)},2e3)}}function l(e,t){m=e,$(".input-txt-file").change(function(){""!==$(this).val()?($(this).prev().text("Выбрано файлов: "+$(this)[0].files.length),o($(this)[0])):$(this).prev().text("Выберете файл")}),window.PubSub.subscribe(u.CONST.events.autoarnswer.TEXT_FILE_UPLOADED,function(e,n){var a=n.response,r=a.length?JSON.parse(a):"",s=r&&r.data&&r.data.list_id;$(n.el).closest(m).attr("attached-txt-id",s),t&&"function"==typeof t&&t();var i=$(".js_add-new-task fieldset").get(2);$(i).find(".btn-next").removeAttr("disabled"),f.default.remove()})}Object.defineProperty(t,"__esModule",{value:!0}),t.attachTxtFileHandler=l;var u=n(0),c=n(2),d=a(c),p=n(17),f=a(p),m="",g=104857600,h="txt"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.emoji=void 0,n(22);t.emoji=function(e){$(e.page).length&&$('textarea[data-emoji-picker="true"]').emojioneArea({pickerPosition:"bottom",tonesStyle:"square",filtersPosition:"bottom",search:!0,events:{keyup:function(e,t){}}})}},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=[],a=!0,r=!1,s=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,s=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(){function e(){a(this,e)}return s(e,[{key:"cbErrorDefault",value:function(e){var t=$("#description").length?$("#description"):$(".error-msg");o.default.showInfoMessage(t,e.status.state,e.status.message||"error")}},{key:"checkStatus",value:function(e){if(e.status&&e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}},{key:"sendRequest",value:function(e,t,n){var a=this;return fetch(e,t).then(function(e){return Promise.all([e,e.json()])}).then(function(e){var t=r(e,2),s=t[0],i=t[1];return s.ok||(n?n(i):a.cbErrorDefault(i),a.checkStatus(s)),i})}}]),e}();t.default=l},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s={inline:"global-inline-spinner",overlay:"global-overlay-spinner",fixed:"global-fixed-spinner",button:"button--load"},i=function(){function e(t){a(this,e),this.startButtonSpinner=function(e,t){e.addClass(s.button),e.find(".spinner-box--button").length||e.prepend('<div class="spinner-box spinner-box--button justify-content-center position-relative p-0 m-0 bg-transparent '+t+'">\n            <div class="spin-animation">\n                <svg aria-hidden="true" data-prefix="far" data-icon="sync-alt" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" \n                    class="fa-fw">\n                    <path fill="currentColor" d="M483.515 28.485L431.35 80.65C386.475 35.767 324.485 8 256 8 123.228 8 14.824 112.338 8.31 243.493 7.971 250.311 13.475 256 20.301 256h28.045c6.353 0 11.613-4.952 11.973-11.294C66.161 141.649 151.453 60 256 60c54.163 0 103.157 21.923 138.614 57.386l-54.128 54.129c-7.56 7.56-2.206 20.485 8.485 20.485H492c6.627 0 12-5.373 12-12V36.971c0-10.691-12.926-16.045-20.485-8.486zM491.699 256h-28.045c-6.353 0-11.613 4.952-11.973 11.294C445.839 370.351 360.547 452 256 452c-54.163 0-103.157-21.923-138.614-57.386l54.128-54.129c7.56-7.56 2.206-20.485-8.485-20.485H20c-6.627 0-12 5.373-12 12v143.029c0 10.691 12.926 16.045 20.485 8.485L80.65 431.35C125.525 476.233 187.516 504 256 504c132.773 0 241.176-104.338 247.69-235.493.339-6.818-5.165-12.507-11.991-12.507z" class=""></path></svg>\n            </div>\n        </div>')},this.stopButtonSpinner=function(e){e.removeClass(s.button)},this.cfg=t||{},$.extend(s,this.cfg.classes)}return r(e,[{key:"start",value:function(e,t){e.find("i").toggleClass(t).addClass("fa-spin fa-spinner")}},{key:"stop",value:function(e,t){e.find("i").toggleClass(t).removeClass("fa-spin fa-spinner")}},{key:"add",value:function(e,t){this.$el=e,e.prepend('<div class="spinner-box justify-content-center '+t+'">\n            <div class="spin-animation">\n                <svg aria-hidden="true" data-prefix="far" data-icon="sync-alt" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-sync-alt fa-w-16 fa-fw fa-2x"><path fill="currentColor" d="M483.515 28.485L431.35 80.65C386.475 35.767 324.485 8 256 8 123.228 8 14.824 112.338 8.31 243.493 7.971 250.311 13.475 256 20.301 256h28.045c6.353 0 11.613-4.952 11.973-11.294C66.161 141.649 151.453 60 256 60c54.163 0 103.157 21.923 138.614 57.386l-54.128 54.129c-7.56 7.56-2.206 20.485 8.485 20.485H492c6.627 0 12-5.373 12-12V36.971c0-10.691-12.926-16.045-20.485-8.486zM491.699 256h-28.045c-6.353 0-11.613 4.952-11.973 11.294C445.839 370.351 360.547 452 256 452c-54.163 0-103.157-21.923-138.614-57.386l54.128-54.129c7.56-7.56 2.206-20.485-8.485-20.485H20c-6.627 0-12 5.373-12 12v143.029c0 10.691 12.926 16.045 20.485 8.485L80.65 431.35C125.525 476.233 187.516 504 256 504c132.773 0 241.176-104.338 247.69-235.493.339-6.818-5.165-12.507-11.991-12.507z" class=""></path></svg>\n            </div>\n        </div>')}},{key:"remove",value:function(){this.$el&&this.$el.length&&this.$el.find(".spinner-box").remove()}}]),e}(),o=null;o||(o=new i),t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(e,t,n){var a=n.textRusArray,r=n.logsState,s=r.selectClsLogsTaskType,i=function(e){var t=a&&!!a.length;switch(e){case 0:return t?a[e]:"По списку";case 1:return t?a[e]:"По активной аудитории конкурентов";case 2:return t?a[e]:"default - (3)";default:return"default"}};e.empty().addClass("border-light-color"),$('<div class="">Выберите тип</div><select name="task-subtype" class="'+s+'"></select>').appendTo(e),t.length&&($('<option class="list-group-item py-2 js_empty-subtype" value="---">---</option>').appendTo($("."+s)),t.forEach(function(e,t){$('<option class="list-group-item py-2" value="'+e+'">\n                '+i(t)+"\n            </option>").appendTo($("."+s))}),$("."+s).on("change",function(e){n.dropdownOnSelectCb(e)}))}return{addDropdown:e}}()},function(e,t,n){"use strict";function a(e){var t=$(e.target).find("option:selected").val(),n=s({},c,{subtype:t});$(".js_logs-container").addClass("d-block"),$("option.js_empty-subtype").remove(),(0,o.getTasksData)(d,n)}function r(e){var t=e.isInCorrectPage,n=e.initialPath,r=e.textRusArray;t&&(c={type:n.type,subtype:n.subtype},u.default.addDropdown(p.wrapperSubtype,n.subtypes,{logsState:p,dropdownOnSelectCb:a,textRusArray:r}),window.PubSub.subscribe(i.CONST.events.tasks.NEW_TASK_CREATED,function(e,t){(0,o.getTasksData)(d,c)}))}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.init=r;var i=n(0),o=n(5),l=n(18),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c={type:"",subtype:""},d={$all:$(".tasks-all"),$stopped:$(".tasks-stopped")},p={wrapperSubtype:$(".subtype--box")}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){function e(e){var t=$(e.target);t.find(".first-step").removeClass("d-none"),t.find(".second-step").addClass("d-none"),$(".js_confirm-key").val(""),$(".js_success-feedback",t).removeAttr("style").empty()}var t="";$(".js_pass-checkpoint-btn").on("click",function(e){var n=$(e.target),a=n.data("username");t=n.data("checkpointType")||t;var r="PHONE"===t?"телефон":"email";if("EMAIL_OR_PHONE"===t)return e.stopPropagation(),void $("#security-code-phoneOremail").modal({show:!0,username:a});p.default.getSecurityKey(a,t).then(function(e){if("ok"===e.status.state){var t=$("#security-code");$(".js_success-feedback",t).empty().text("Ключ подтверждения был отправлен Вам на "+r),$("#security-code").attr("data-username",a)}})}),$(".js_confirm-security-code").on("click",function(e){var t=$(e.target),n=t.closest("#security-code").data("username"),a=t.closest(".modal").find(".modal-dialog form input.js_confirm-key"),r=a.val().trim(),s=t.closest(".modal");e.stopPropagation(),6===r.length&&p.default.confirmSecurityKey(r,n).then(function(e){"ok"===e.status.state&&s.modal("hide")}).catch(function(e){$(".js_success-feedback",s).text("Запрос не отправлен").css("color","red")})}),$("form input[minlength]").on("blur",function(){var e=$(this).val().trim().length;Number($(this).attr("minlength"))!==e?$(this).css("borderColor","red"):$(this).css("borderColor","#ced4da")}),$("#security-code-phoneOremail").on("hide.bs.modal",e),$("#security-code").on("hide.bs.modal",e),$(".js_get-security-code-phoneOremail").on("click",function(e){var t=$("#security-code-phoneOremail"),n=$(e.target).closest(t).find(".js_btn-type-switcher input:checked"),a=n.val(),r="PHONE"===a?"телефон":"email",s=t.data()["bs.modal"]._config,i=s.username;p.default.getSecurityKey(i,a).then(function(e){"ok"===e.status.state&&($(".first-step",t).addClass("d-none"),$(".second-step",t).removeClass("d-none"),$(".js_success-feedback",t).empty().text("Ключ подтверждения был отправлен Вам на "+r))})})}function s(e,t){var n=t,a=e,r=g.CONST.user.defaulAvatar;a.empty().addClass("border-light-color"),n.forEach(function(e){T(e,a,r).appendTo(a)}),window.PubSub.publish(g.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_RENDERED,{name:name,dataArray:t})}function i(e){$(".profile-user .spinner-box").addClass("d-none"),s(b,e.data.accounts),r()}function o(){m.default.showInfoMessage($(".error-msg"),"",C)}function l(){var e=$(".accounts-list");$(".profile-user .spinner-box").removeClass("d-none"),p.default.getMetadata(o).then(function(t){e.empty(),i(t)}).catch(function(e){setTimeout(function(){m.default.showInfoMessage($(".error-msg"),e.status||"",C)},3e3),$(".spinner-box").addClass("d-none")});var t={deleteBtnCls:".js_acc-delete",updateBtnCls:".js_acc-refresh",editBtnCls:".js_acc-edit"};(0,h.settingButtonsHandler)(t)}function u(){$(".js_add-instagram-account").on("click",function(e){var t=$(e.target),n=t.closest(".modal").find(".modal-dialog .modal-body"),a=n.find('input[name="username"]').val().trim(),r=n.find('input[name="pass"]').val().trim(),s=n.find('input[name="ip"]').val().trim(),i=n.find('input[name="port"]').val().trim(),o=n.find('input[name="usernameProxy"]').val().trim(),l=n.find('input[name="passProxy"]').val().trim(),u=$("form",n),c=u.get(0);if(e.preventDefault(),c.checkValidity()?S({username:a,password:r,usernameProxy:o,passwordProxy:l,ip:s,port:i}):(c.reportValidity&&c.reportValidity(),u.addClass("form-validation")),!(a&&r&&s&&function(e){return/^(?=\d+\.\d+\.\d+\.\d+$)(?:(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\.?){4}$/.test(e)}(s)&&i&&function(e){return/^([0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$/.test(e)}(i)&&o&&l))return void e.stopPropagation()})}function c(){if(b.length){var e=p.default.getMetadata(o);b.length&&(u(),e.then(function(e){i(e);var t={deleteBtnCls:".js_acc-delete",updateBtnCls:".js_acc-refresh",editBtnCls:".js_acc-edit"};(0,h.settingButtonsHandler)(t)}).catch(function(e){setTimeout(function(){m.default.showInfoMessage($(".error-msg"),e.status||"","Не получилось загрузить доступные Instagram аккаунты")},3e3),$(".spinner-box").addClass("d-none")}),window.PubSub.subscribe(g.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_NEED_REFRESH,function(e,t){l()}),window.PubSub.subscribe(g.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_RENDERED,function(e,t){t.dataArray.forEach(function(e){var t=e.info&&e.info.profile_pic_url||g.CONST.user.defaulAvatar;sessionStorage.setItem(e.username,t)})}))}}Object.defineProperty(t,"__esModule",{value:!0}),t.renderItem=void 0,t.init=c;var d=n(3),p=a(d),f=n(1),m=a(f),g=n(0),h=n(39),v=$(".instagram-accounts-page").length,b=$(".accounts-list"),_=function(e,t,n){return e?'<li class="list-inline-item '+n+'"><span class="figure">'+e+"</span><span>"+t+"</span></li>":'<li class="list-inline-item '+n+'"><span class="figure">0</span><span>'+t+"</span></li>"},y=function(e){return'<div class="col">\n        <ul class="list-inline text-center counts-list">\n        '+(e?_(e.media_count,"Публикации","media-count")+"\n            "+_(e.follower_count,"Подписчики","follower-count")+"\n            "+_(e.following_count,"Подписки","following-count"):_(!1,"Публикации","media-count")+"\n            "+_(!1,"Подписчики","follower-count")+"\n            "+_(!1,"Подписки","following-count"))+"\n        </ul>\n    </div>"},w=function(e,t){return"TRIGGERED"===e.status?'<button class="btn btn-outline-secondary js_pass-checkpoint-btn d-block mx-auto" \n            data-checkpoint-type="'+(e.type||"EMAIL")+'"\n            data-username="'+(t.username||"")+'"\n            data-toggle="modal" data-target="#security-code">\n            <i class="fas fa-key"></i>Пройти чекпоинт</button>':"FAIL"===t.status?'<span class="text-danger">Ошибка при добавлении</span>':void 0},k=function(e){var t=e.username,n=void 0===t?"":t,a=e.info,r=a.name,s=void 0===r?"":r,i=a.email,o=void 0===i?"":i,l=a.url,u=void 0===l?"":l,c=a.biography,d=void 0===c?"":c,p=a.profile_pic_url,f=void 0===p?"":p,m=a.follower_count,g=a.following_count,h=a.media_count,b=a.is_business,_=a.is_private;if(v||window.location.href.includes("instagram-accounts"))return'<div class="account-setting col-1 d-flex flex-column">\n            <button class="btn btn-outline-success p-1 mb-1 js_acc-edit" \n                data-username="'+n+'"\n                data-name="'+s+'"\n                data-email="'+o+'"\n                data-url="'+u+'"\n                data-biography="'+d+'"\n                data-img="'+f+'"\n                data-follower_count="'+m+'"\n                data-following_count="'+g+'"\n                data-media_count="'+h+'"\n                data-is_business="'+b+'"\n                data-is_private="'+_+'"\n            ><i class="fas fa-pen m-0"></i></button>\n            <button class="btn btn-outline-secondary p-1 mb-1 js_acc-refresh" data-username="'+n+'"><i class="fas fa-retweet m-0"></i></button>\n            <button class="btn btn-outline-danger p-1 js_acc-delete" data-username="'+n+'"><i class="fas fa-trash m-0"></i></button>\n        </div>'},T=t.renderItem=function(e,t,n){var a=e.info,r=e.checkpoint||e,s=n||g.CONST.user.defaulAvatar;return a?$('<li class="media py-3" data-username="'+e.username+'">\n        '+(a.profile_pic_url?'<img class="ml-3 rounded" alt="User photo" src="'+a.profile_pic_url+'">':'<img class="ml-3 rounded" alt="default avatar" src="'+s+'">')+'\n        <div class="media-body d-flex">\n            <div class="col user-info">\n                '+(e.username?'<p class="mt-0 mb-1 name lead">'+e.username+"</p>":"")+"\n                "+(a.name?'<h4 class="mt-0 mb-1">'+a.name+"</h4>":"")+"\n                "+(a.name,"")+'\n\n            </div>\n            <div class="col user-checkpoint">\n                '+("TRIGGERED"===r.status?'<button class="btn btn-outline-secondary js_pass-checkpoint-btn d-block mx-auto"\n                        data-checkpoint-type="'+(r.type||"EMAIL")+'"\n                        data-username="'+(e.username||"")+'"\n                        data-toggle="modal" data-target="#security-code">\n                    <i class="fas fa-key"></i>Пройти чекпоинт</button>':"")+"\n            </div>\n            "+y(a)+"\n            "+(k(e)||"")+"\n        </div>\n    </li>"):$('<li class="media py-3" data-username="'+e.username+'">\n            <img class="ml-3 rounded" alt="default avatar" src="'+s+'">\n            <div class="media-body d-flex">\n                <div class="col user-info">\n                    '+(e.username?'<h4 class="mt-0 mb-1 name">'+e.username+"</h4>":"")+'\n                </div>\n                <div class="col user-checkpoint">\n                    '+w(r,e)+"\n                </div>\n                "+y()+"\n                "+(k(e)||"")+"\n            </div>\n        </li>").appendTo(t)},C="Не получилось загрузить доступные Instagram аккаунты",S=function(e){var t=function(e){m.default.showInfoMessage($(".error-msg"),e.status.state,e.status.message||"Login error")};p.default.addInstagramAccount(e,t).then(function(e){e&&e.status&&l()}).catch(function(e){})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),l=n(16),u=a(l),c=n(4),d=a(c),p=function(){function e(){r(this,e),this.network=new u.default,this.cookieStorage=d.default,this.settingPost={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}}}return i(e,[{key:"isLoggedIn",value:function(){return!!this.getToken()}},{key:"isEmailConfirmed",value:function(){return"confirmed"===this.cookieStorage.get(o.CONST.cookieStorage.emailConfirmed)}},{key:"getToken",value:function(){return this.cookieStorage.get(o.CONST.cookieStorage.token)}},{key:"getMetadata",value:function(e,t){return this.network.sendRequest(""+o.CONST.getPath("instagramDirect_getMetaData"),{headers:{token:this.getToken()}},t)}},{key:"getMetadataDetailUsers",value:function(e,t){var n=e.cursor?"?cursor="+e.cursor:"";return this.network.sendRequest(o.CONST.getPath("instagramDirect_getMetaData")+"/"+e.username+n,{headers:{token:this.getToken()}},t)}},{key:"getMetadataDetailConversation",value:function(e,t,n){var a=t.cursor?"?cursor="+t.cursor:"";return this.network.sendRequest(o.CONST.getPath("instagramDirect_getMetaData")+"/"+t.username+"/"+t.conversationId+a,{headers:{token:e}},n)}},{key:"postMetadataDetailConversation",value:function(e,t,n){var a=s({},this.settingPost,{body:JSON.stringify({value:t.value}),headers:s({},this.settingPost.headers,{token:this.getToken()})});return this.network.sendRequest(o.CONST.getPath("instagramDirect_postMessage")+"/"+t.username+"/"+t.conversationId+"/text",a,n)}},{key:"getRequestPending",value:function(e,t){return this.network.sendRequest(o.CONST.getPath("instagramDirect_RequestPending")+"/"+e,{headers:{token:this.getToken()}},t)}},{key:"putRequestPending",value:function(e,t){var n=s({},this.settingPost,{method:"PUT",headers:s({},this.settingPost.headers,{token:this.getToken()})}),a=e.username,r=e.conversationId;return this.network.sendRequest(o.CONST.getPath("instagramDirect_RequestPending")+"/"+a+"/"+r,n,t)}},{key:"delRequestPending",value:function(e,t){var n={method:"DELETE",headers:s({},this.settingPost.headers,{token:this.getToken()})},a=e.username,r=e.conversationId;return this.network.sendRequest(o.CONST.getPath("instagramDirect_RequestPending")+"/"+a+"/"+r,n,t)}}]),e}(),f=null;f||(f=new p),t.default=f},function(e,t){!function(e,t,n){"use strict";function a(e){O?e():x.push(e)}function r(e,t,a){var r=!0,s=1;if(t){t=t.toLowerCase();do{var i=1==s?"@"+t:t;$[e.id][i]&&$[e.id][i].length&&n.each($[e.id][i],function(t,n){return r=!1!==n.apply(e,a||[])})}while(r&&s--)}return r}function s(e,t,a,r){r=r||function(e,t){return n(t.currentTarget)},n.each(a,function(s,i){s=n.isArray(a)?i:s,(S[e.id][i]||(S[e.id][i]=[])).push([t,s,r])})}function i(e,t,n){return e.replace("{name}",n||"").replace("{img}",O.imagePathPNG+(E<2?t.toUpperCase():t)+".png").replace("{uni}",t).replace("{alt}",O.convert(t))}function o(e,t,n){return e.replace(/:?\+?[\w_\-]+:?/g,function(e){e=":"+e.replace(/:$/,"").replace(/^:/,"")+":";var a=O.emojioneList[e];return a?(E>3&&(a=a.unicode),i(t,a[a.length-1],e)):n?"":e})}function l(n){var a,r;if(t.getSelection){if(a=t.getSelection(),a.getRangeAt&&a.rangeCount){r=a.getRangeAt(0),r.deleteContents();var s=e.createElement("div");s.innerHTML=n;for(var i,o,l=e.createDocumentFragment();i=s.firstChild;)o=l.appendChild(i);r.insertNode(l),o&&(r=r.cloneRange(),r.setStartAfter(o),r.collapse(!0),a.removeAllRanges(),a.addRange(r))}}else e.selection&&"Control"!=e.selection.type&&e.selection.createRange().pasteHTML(n)}function u(e){return"object"==typeof e}function c(e){if(e.filters){var t=N.filters;n.each(e.filters,function(e,a){if(!u(a)||n.isEmptyObject(a))return void delete t[e];n.each(a,function(n,a){t[e][n]=a})}),e.filters=t}return n.extend({},N,e)}function d(){var e=O.cacheBustParam;return u(O.jsEscapeMap)?"?v=1.2.4"===e?"2.0.0":"?v=2.0.1"===e?"2.1.0":"?v=2.1.1"===e?"2.1.1":"?v=2.1.2"===e?"2.1.2":"?v=2.1.3"===e?"2.1.3":"2.1.4":"1.5.2"}function p(e){switch(e){case"1.5.2":return 0;case"2.0.0":return 1;case"2.1.0":case"2.1.1":return 2;case"2.1.2":return 3;case"2.1.3":case"2.1.4":default:return 4}}function f(e,t){return e.replace(M,function(e){var n=O[0===E?"jsecapeMap":"jsEscapeMap"];return void 0!==e&&e in n?i(t,n[e]):e})}function m(e,t){return e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/`/g,"&#x60;").replace(/(?:\r\n|\r|\n)/g,"\n").replace(/(\n+)/g,"<div>$1</div>").replace(/\n/g,"<br/>").replace(/<br\/><\/div>/g,"</div>"),t.shortnames&&(e=O.shortnameToUnicode(e)),f(e,t.emojiTemplate).replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/  /g,"&nbsp;&nbsp;")}function g(e,t){switch(e=e.replace(/<img[^>]*alt="([^"]+)"[^>]*>/gi,"$1").replace(/\n|\r/g,"").replace(/<br[^>]*>/gi,"\n").replace(/(?:<(?:div|p|ol|ul|li|pre|code|object)[^>]*>)+/gi,"<div>").replace(/(?:<\/(?:div|p|ol|ul|li|pre|code|object)>)+/gi,"</div>").replace(/\n<div><\/div>/gi,"\n").replace(/<div><\/div>\n/gi,"\n").replace(/(?:<div>)+<\/div>/gi,"\n").replace(/([^\n])<\/div><div>/gi,"$1\n").replace(/(?:<\/div>)+/gi,"</div>").replace(/([^\n])<\/div>([^\n])/gi,"$1\n$2").replace(/<\/div>/gi,"").replace(/([^\n])<div>/gi,"$1\n").replace(/\n<div>/gi,"\n").replace(/<div>\n/gi,"\n\n").replace(/<(?:[^>]+)?>/g,"").replace(/&#8291;/g,"").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x60;/g,"`").replace(/&amp;/g,"&"),t.saveEmojisAs){case"image":e=f(e,t.emojiTemplate);break;case"shortname":e=O.toShort(e)}return e}function h(){var e=this,t=e.editor[0].offsetWidth-e.editor[0].clientWidth,n=parseInt(e.button.css("marginRight"));n!==t&&(e.button.css({marginRight:t}),"top"===e.pickerPosition&&e.picker.css({right:parseInt(e.picker.css("right"))-n+t}))}function v(){var e=this;if(!e.sprite&&e.lasyEmoji[0]){var t=e.picker.offset().top,a=t+e.picker.height()+20;e.lasyEmoji.each(function(){var e=n(this),r=e.offset().top;r>t&&r<a&&e.attr("src",e.data("src")).removeClass("lazy-emoji")}),e.lasyEmoji=e.lasyEmoji.filter(".lazy-emoji")}}function b(e,t){return(t?"":".")+j+(e?"-"+e:"")}function _(e){var t=n("<div/>",u(e)?e:{class:b(e,!0)});return n.each(A.call(arguments).slice(1),function(e,a){n.isFunction(a)&&(a=a.call(t)),a&&n(a).appendTo(t)}),t}function y(a,i,d){d=c(d),a.sprite=d.sprite&&E<3,a.inline=null===d.inline?i.is("INPUT"):d.inline,a.shortnames=d.shortnames,a.pickerPosition=d.pickerPosition,a.saveEmojisAs=d.saveEmojisAs,a.emojiTemplate='<img alt="{alt}" class="emojione'+(a.sprite?'-{uni}" src="'+P+'"/>':'emoji" src="{img}"/>');var p,f,y,w,C,$,S,x,A,N=i.is("TEXTAREA")||i.is("INPUT")?"val":"text",M=_({class:j+" "+(i.attr("class")||""),role:"application"},p=a.editor=_("editor").attr({contenteditable:!0,placeholder:d.placeholder||i.data("placeholder")||i.attr("placeholder")||"",tabindex:0}),f=a.button=_("button",_("button-open"),_("button-close")).attr("title",d.buttonTitle),y=a.picker=_("picker",_("wrapper",C=_("filters"),A=_("scroll-area",S=_("emojis-list"),w=_("tones",function(){if(d.tones){this.addClass(b("tones-"+d.tonesStyle,!0));for(var e=0;e<=5;e++)this.append(n("<i/>",{class:"btn-tone btn-tone-"+e+(e?"":" active"),"data-skin":e,role:"button"}))}})))).addClass(b("picker-position-"+d.pickerPosition,!0)).addClass(b("filters-position-"+d.filtersPosition,!0)).addClass("hidden"));n.each(d.attributes,function(e,t){p.attr(e,t)}),n.each(d.filters,function(e,t){var r=0;if("tones"!==e)n("<i/>",{class:b("filter",!0)+" "+b("filter-"+e,!0),"data-filter":e,title:t.title}).wrapInner(o(t.icon,a.sprite?'<i class="emojione-{uni}"/>':'<img class="emojioneemoji" src="{img}"/>')).appendTo(C);else{if(!d.tones)return;r=5}do{var s=_("category").attr({name:e,"data-tone":r}).appendTo(S),i=t.emoji.replace(/[\s,;]+/g,"|");r>0&&(s.hide(),i=i.split("|").join("_tone"+r+"|")+"_tone"+r),i=o(i,a.sprite?'<i class="emojibtn" role="button" data-name="{name}"><i class="emojione-{uni}"></i></i>':'<i class="emojibtn" role="button" data-name="{name}"><img class="emojioneemoji lazy-emoji" data-src="{img}"/></i>',!0).split("|").join(""),s.html(i),n("<h1/>").text(t.title).prependTo(s)}while(--r>0)}),d.filters=null,a.sprite||(a.lasyEmoji=S.find(".lazy-emoji")),$=C.find(b("filter")),$.eq(0).addClass("active"),x=S.find(b("category")),d.container?n(d.container).wrapInner(M):M.insertAfter(i),d.hideSource&&i.hide(),a.setText(i[N]()),i[N](a.getText()),h.apply(a),s(a,S.find(".emojibtn"),{click:"emojibtn.click"}),s(a,t,{resize:"!resize"}),s(a,w.children(),{click:"tone.click"}),s(a,[y,f],{mousedown:"!mousedown"},p),s(a,f,{click:"button.click"}),s(a,p,{paste:"!paste"},p),s(a,p,["focus","blur"],function(){return!a.stayFocused&&p}),s(a,y,{mousedown:"picker.mousedown",mouseup:"picker.mouseup",click:"picker.click",keyup:"picker.keyup",keydown:"picker.keydown",keypress:"picker.keypress"}),s(a,p,["mousedown","mouseup","click","keyup","keydown","keypress"]),s(a,y.find(".emojionearea-filter"),{click:"filter.click"}),u(d.events)&&!n.isEmptyObject(d.events)&&n.each(d.events,function(e,t){a.on(e.replace(/_/g,"."),t)});var I=!1;if(A.on("scroll",function(){if(!I&&(v.call(a),A.is(":not(.skinnable)"))){var e=x.eq(0),t=A.offset().top;x.each(function(a,r){if(n(r).offset().top-t>=10)return!1;e=n(r)});var r=$.filter('[data-filter="'+e.attr("name")+'"]');r[0]&&!r.is(".active")&&($.removeClass("active"),r.addClass("active"))}}),a.on("@filter.click",function(e){var t=e.is(".active");if(A.is(".skinnable")){if(t)return;w.children().eq(0).click()}I=!0,t||($.filter(".active").removeClass("active"),e.addClass("active"));var n=x.filter('[name="'+e.data("filter")+'"]').offset().top,r=A.scrollTop(),s=A.offset().top;A.stop().animate({scrollTop:n+r-s-2},200,"swing",function(){v.call(a),I=!1})}).on("@picker.show",v).on("@tone.click",function(e){w.children().removeClass("active");var t=e.addClass("active").data("skin");t?(A.addClass("skinnable"),x.hide().filter("[data-tone="+t+"]").show()):(A.removeClass("skinnable"),x.hide().filter("[data-tone=0]").show()),v.call(a)}).on("@button.click",function(e){e.is(".active")?a.hidePicker():a.showPicker()}).on("@!paste",function(e){a.stayFocused=!0,l("<span>&#8291;</span>");var s=k(e[0]),i=e.scrollTop(),o=n("<div/>",{contenteditable:!0}).css({position:"fixed",left:"-999px",width:"1px",height:"1px",top:"20px",overflow:"hidden"}).appendTo(n("BODY")).focus();t.setTimeout(function(){var t="caret-"+(new Date).getTime();e.focus(),T(e[0],s);var u=g(o.html().replace(/\r\n|\n|\r/g,"<br>"),a),c=m(u,a);l(c),o.remove(),l('<i id="'+t+'"></i>'),e.scrollTop(i);var d=n("#"+t),p=d.offset().top-e.offset().top,f=e.height();(i+p>=f||i>p)&&e.scrollTop(i+p-2*f/3),d.remove(),a.stayFocused=!1,h.apply(a),r(a,"paste",[e,u,c])},200)}).on("@emojibtn.click",function(e){M.is(".focused")||p.focus(),k(p[0]),l(o(e.data("name"),a.emojiTemplate))}).on("@!resize @keyup @emojibtn.click",h).on("@!mousedown",function(e,t){return M.is(".focused")||e.focus(),t.preventDefault(),!1}).on("@change",function(e){var t=e.html().replace(/<\/?(?:div|span|p)[^>]*>/gi,"");t.length&&!/^<br[^>]*>$/i.test(t)||a.editor.html(a.content=""),i[N](a.getText())}).on("@focus",function(){M.addClass("focused")}).on("@blur",function(e){M.removeClass("focused"),d.hidePickerOnBlur&&a.hidePicker();var t=e.html();a.content!==t?(a.content=t,r(a,"change",[e]),i.blur().trigger("change")):i.blur()}),d.shortcuts&&a.on("@keydown",function(e,t){t.ctrlKey||(9==t.which?(t.preventDefault(),f.click()):27==t.which&&(t.preventDefault(),f.is(".active")&&a.hidePicker()))}),d.autocomplete){var R=function(){var e={};d.shortcuts&&(e.onKeydown=function(e,t){if(!e.ctrlKey&&13==e.which)return t.KEY_ENTER});var t=n.map(O.emojioneList,function(e,t){return d.autocompleteTones?t:/_tone[12345]/.test(t)?null:t});t.sort(),p.textcomplete([{id:j,match:/(:[\-+\w]*)$/,search:function(e,a){a(n.map(t,function(t){return 0===t.indexOf(e)?t:null}))},template:function(e){return o(e,a.emojiTemplate)+" "+e.replace(/:/g,"")},replace:function(e){return o(e,a.emojiTemplate)},cache:!0,maxCount:15,index:1}],e)};n.fn.textcomplete?R():n.getScript("https://cdn.rawgit.com/yuku-t/jquery-textcomplete/v1.3.4/dist/jquery.textcomplete.js",R)}a.inline&&(M.addClass(b("inline",!0)),a.on("@keydown",function(e,t){13==t.which&&t.preventDefault()})),/firefox/i.test(navigator.userAgent)&&e.execCommand("enableObjectResizing",!1,!1)}function w(e,t){t=t.replace(/^@/,"");var a=e.id;S[a][t]&&(n.each(S[a][t],function(a,s){n.each(n.isArray(s[0])?s[0]:[s[0]],function(a,i){n(i).on(s[1],function(){var a=A.call(arguments),i=n.isFunction(s[2])?s[2].apply(e,[t].concat(a)):s[2];i&&r(e,t,[i].concat(a))})})}),S[a][t]=null)}var k,T,C=0,$={},S={},O=t.emojione,x=[],P="data:image/gif;base64,R0lGODlhAQABAJH/AP///wAAAMDAwAAAACH5BAEAAAIALAAAAAABAAEAAAICVAEAOw==",A=[].slice,j="emojionearea",E=0,N={attributes:{dir:"ltr",spellcheck:!1,autocomplete:"off",autocorrect:"off",autocapitalize:"off"},placeholder:null,container:null,hideSource:!0,shortnames:!0,sprite:!0,pickerPosition:"top",filtersPosition:"top",hidePickerOnBlur:!0,buttonTitle:"Use the TAB key to insert emoji faster",tones:!0,tonesStyle:"bullet",inline:null,saveEmojisAs:"unicode",shortcuts:!0,autocomplete:!0,autocompleteTones:!1,filters:{tones:{title:"Diversity",emoji:"santa runner surfer swimmer lifter ear nose point_up_2 point_down point_left point_right punch wave ok_hand thumbsup thumbsdown clap open_hands boy girl man woman cop bride_with_veil person_with_blond_hair man_with_gua_pi_mao man_with_turban older_man grandma baby construction_worker princess angel information_desk_person guardsman dancer nail_care massage haircut muscle spy hand_splayed middle_finger vulcan no_good ok_woman bow raising_hand raised_hands person_frowning person_with_pouting_face pray rowboat bicyclist mountain_bicyclist walking bath metal point_up basketball_player fist raised_hand v writing_hand"},smileys_people:{icon:"yum",title:"Smileys & People",emoji:"grinning grimacing grin joy smiley smile sweat_smile laughing innocent wink blush slight_smile upside_down relaxed yum relieved heart_eyes kissing_heart kissing kissing_smiling_eyes kissing_closed_eyes stuck_out_tongue_winking_eye stuck_out_tongue_closed_eyes stuck_out_tongue money_mouth nerd sunglasses hugging smirk no_mouth neutral_face expressionless unamused rolling_eyes thinking flushed disappointed worried angry rage pensive confused slight_frown frowning2 persevere confounded tired_face weary triumph open_mouth scream fearful cold_sweat hushed frowning anguished cry disappointed_relieved sleepy sweat sob dizzy_face astonished zipper_mouth mask thermometer_face head_bandage sleeping zzz poop smiling_imp imp japanese_ogre japanese_goblin skull ghost alien robot smiley_cat smile_cat joy_cat heart_eyes_cat smirk_cat kissing_cat scream_cat crying_cat_face pouting_cat raised_hands clap wave thumbsup thumbsdown punch fist v ok_hand raised_hand open_hands muscle pray point_up point_up_2 point_down point_left point_right middle_finger hand_splayed metal vulcan writing_hand nail_care lips tongue ear nose eye eyes bust_in_silhouette busts_in_silhouette speaking_head baby boy girl man woman person_with_blond_hair older_man older_woman man_with_gua_pi_mao man_with_turban cop construction_worker guardsman spy santa angel princess bride_with_veil walking runner dancer dancers couple two_men_holding_hands two_women_holding_hands bow information_desk_person no_good ok_woman raising_hand person_with_pouting_face person_frowning haircut massage couple_with_heart couple_ww couple_mm couplekiss kiss_ww kiss_mm family family_mwg family_mwgb family_mwbb family_mwgg family_wwb family_wwg family_wwgb family_wwbb family_wwgg family_mmb family_mmg family_mmgb family_mmbb family_mmgg womans_clothes shirt jeans necktie dress bikini kimono lipstick kiss footprints high_heel sandal boot mans_shoe athletic_shoe womans_hat tophat helmet_with_cross mortar_board crown school_satchel pouch purse handbag briefcase eyeglasses dark_sunglasses ring closed_umbrella"},animals_nature:{icon:"hamster",title:"Animals & Nature",emoji:"dog cat mouse hamster rabbit bear panda_face koala tiger lion_face cow pig pig_nose frog octopus monkey_face see_no_evil hear_no_evil speak_no_evil monkey chicken penguin bird baby_chick hatching_chick hatched_chick wolf boar horse unicorn bee bug snail beetle ant spider scorpion crab snake turtle tropical_fish fish blowfish dolphin whale whale2 crocodile leopard tiger2 water_buffalo ox cow2 dromedary_camel camel elephant goat ram sheep racehorse pig2 rat mouse2 rooster turkey dove dog2 poodle cat2 rabbit2 chipmunk feet dragon dragon_face cactus christmas_tree evergreen_tree deciduous_tree palm_tree seedling herb shamrock four_leaf_clover bamboo tanabata_tree leaves fallen_leaf maple_leaf ear_of_rice hibiscus sunflower rose tulip blossom cherry_blossom bouquet mushroom chestnut jack_o_lantern shell spider_web earth_americas earth_africa earth_asia full_moon waning_gibbous_moon last_quarter_moon waning_crescent_moon new_moon waxing_crescent_moon first_quarter_moon waxing_gibbous_moon new_moon_with_face full_moon_with_face first_quarter_moon_with_face last_quarter_moon_with_face sun_with_face crescent_moon star star2 dizzy sparkles comet sunny white_sun_small_cloud partly_sunny white_sun_cloud white_sun_rain_cloud cloud cloud_rain thunder_cloud_rain cloud_lightning zap fire boom snowflake cloud_snow snowman2 snowman wind_blowing_face dash cloud_tornado fog umbrella2 umbrella droplet sweat_drops ocean"},food_drink:{icon:"pizza",title:"Food & Drink",emoji:"green_apple apple pear tangerine lemon banana watermelon grapes strawberry melon cherries peach pineapple tomato eggplant hot_pepper corn sweet_potato honey_pot bread cheese poultry_leg meat_on_bone fried_shrimp egg hamburger fries hotdog pizza spaghetti taco burrito ramen stew fish_cake sushi bento curry rice_ball rice rice_cracker oden dango shaved_ice ice_cream icecream cake birthday custard candy lollipop chocolate_bar popcorn doughnut cookie beer beers wine_glass cocktail tropical_drink champagne sake tea coffee baby_bottle fork_and_knife fork_knife_plate"},activity:{icon:"basketball",title:"Activity",emoji:"soccer basketball football baseball tennis volleyball rugby_football 8ball golf golfer ping_pong badminton hockey field_hockey cricket ski skier snowboarder ice_skate bow_and_arrow fishing_pole_and_fish rowboat swimmer surfer bath basketball_player lifter bicyclist mountain_bicyclist horse_racing levitate trophy running_shirt_with_sash medal military_medal reminder_ribbon rosette ticket tickets performing_arts art circus_tent microphone headphones musical_score musical_keyboard saxophone trumpet guitar violin clapper video_game space_invader dart game_die slot_machine bowling"},travel_places:{icon:"rocket",title:"Travel & Places",emoji:"red_car taxi blue_car bus trolleybus race_car police_car ambulance fire_engine minibus truck articulated_lorry tractor motorcycle bike rotating_light oncoming_police_car oncoming_bus oncoming_automobile oncoming_taxi aerial_tramway mountain_cableway suspension_railway railway_car train monorail bullettrain_side bullettrain_front light_rail mountain_railway steam_locomotive train2 metro tram station helicopter airplane_small airplane airplane_departure airplane_arriving sailboat motorboat speedboat ferry cruise_ship rocket satellite_orbital seat anchor construction fuelpump busstop vertical_traffic_light traffic_light checkered_flag ship ferris_wheel roller_coaster carousel_horse construction_site foggy tokyo_tower factory fountain rice_scene mountain mountain_snow mount_fuji volcano japan camping tent park motorway railway_track sunrise sunrise_over_mountains desert beach island city_sunset city_dusk cityscape night_with_stars bridge_at_night milky_way stars sparkler fireworks rainbow homes european_castle japanese_castle stadium statue_of_liberty house house_with_garden house_abandoned office department_store post_office european_post_office hospital bank hotel convenience_store school love_hotel wedding classical_building church mosque synagogue kaaba shinto_shrine"},objects:{icon:"bulb",title:"Objects",emoji:"watch iphone calling computer keyboard desktop printer mouse_three_button trackball joystick compression minidisc floppy_disk cd dvd vhs camera camera_with_flash video_camera movie_camera projector film_frames telephone_receiver telephone pager fax tv radio microphone2 level_slider control_knobs stopwatch timer alarm_clock clock hourglass_flowing_sand hourglass satellite battery electric_plug bulb flashlight candle wastebasket oil money_with_wings dollar yen euro pound moneybag credit_card gem scales wrench hammer hammer_pick tools pick nut_and_bolt gear chains gun bomb knife dagger crossed_swords shield smoking skull_crossbones coffin urn amphora crystal_ball prayer_beads barber alembic telescope microscope hole pill syringe thermometer label bookmark toilet shower bathtub key key2 couch sleeping_accommodation bed door bellhop frame_photo map beach_umbrella moyai shopping_bags balloon flags ribbon gift confetti_ball tada dolls wind_chime crossed_flags izakaya_lantern envelope envelope_with_arrow incoming_envelope e-mail love_letter postbox mailbox_closed mailbox mailbox_with_mail mailbox_with_no_mail package postal_horn inbox_tray outbox_tray scroll page_with_curl bookmark_tabs bar_chart chart_with_upwards_trend chart_with_downwards_trend page_facing_up date calendar calendar_spiral card_index card_box ballot_box file_cabinet clipboard notepad_spiral file_folder open_file_folder dividers newspaper2 newspaper notebook closed_book green_book blue_book orange_book notebook_with_decorative_cover ledger books book link paperclip paperclips scissors triangular_ruler straight_ruler pushpin round_pushpin triangular_flag_on_post flag_white flag_black closed_lock_with_key lock unlock lock_with_ink_pen pen_ballpoint pen_fountain black_nib pencil pencil2 crayon paintbrush mag mag_right"},symbols:{icon:"heartpulse",title:"Symbols",emoji:"heart yellow_heart green_heart blue_heart purple_heart broken_heart heart_exclamation two_hearts revolving_hearts heartbeat heartpulse sparkling_heart cupid gift_heart heart_decoration peace cross star_and_crescent om_symbol wheel_of_dharma star_of_david six_pointed_star menorah yin_yang orthodox_cross place_of_worship ophiuchus aries taurus gemini cancer leo virgo libra scorpius sagittarius capricorn aquarius pisces id atom u7a7a u5272 radioactive biohazard mobile_phone_off vibration_mode u6709 u7121 u7533 u55b6 u6708 eight_pointed_black_star vs accept white_flower ideograph_advantage secret congratulations u5408 u6e80 u7981 a b ab cl o2 sos no_entry name_badge no_entry_sign x o anger hotsprings no_pedestrians do_not_litter no_bicycles non-potable_water underage no_mobile_phones exclamation grey_exclamation question grey_question bangbang interrobang 100 low_brightness high_brightness trident fleur-de-lis part_alternation_mark warning children_crossing beginner recycle u6307 chart sparkle eight_spoked_asterisk negative_squared_cross_mark white_check_mark diamond_shape_with_a_dot_inside cyclone loop globe_with_meridians m atm sa passport_control customs baggage_claim left_luggage wheelchair no_smoking wc parking potable_water mens womens baby_symbol restroom put_litter_in_its_place cinema signal_strength koko ng ok up cool new free zero one two three four five six seven eight nine ten 1234 arrow_forward pause_button play_pause stop_button record_button track_next track_previous fast_forward rewind twisted_rightwards_arrows repeat repeat_one arrow_backward arrow_up_small arrow_down_small arrow_double_up arrow_double_down arrow_right arrow_left arrow_up arrow_down arrow_upper_right arrow_lower_right arrow_lower_left arrow_upper_left arrow_up_down left_right_arrow arrows_counterclockwise arrow_right_hook leftwards_arrow_with_hook arrow_heading_up arrow_heading_down hash asterisk information_source abc abcd capital_abcd symbols musical_note notes wavy_dash curly_loop heavy_check_mark arrows_clockwise heavy_plus_sign heavy_minus_sign heavy_division_sign heavy_multiplication_x heavy_dollar_sign currency_exchange copyright registered tm end back on top soon ballot_box_with_check radio_button white_circle black_circle red_circle large_blue_circle small_orange_diamond small_blue_diamond large_orange_diamond large_blue_diamond small_red_triangle black_small_square white_small_square black_large_square white_large_square small_red_triangle_down black_medium_square white_medium_square black_medium_small_square white_medium_small_square black_square_button white_square_button speaker sound loud_sound mute mega loudspeaker bell no_bell black_joker mahjong spades clubs hearts diamonds flower_playing_cards thought_balloon anger_right speech_balloon clock1 clock2 clock3 clock4 clock5 clock6 clock7 clock8 clock9 clock10 clock11 clock12 clock130 clock230 clock330 clock430 clock530 clock630 clock730 clock830 clock930 clock1030 clock1130 clock1230 eye_in_speech_bubble"},flags:{icon:"flag_gb",title:"Flags",emoji:"ac af al dz ad ao ai ag ar am aw au at az bs bh bd bb by be bz bj bm bt bo ba bw br bn bg bf bi cv kh cm ca ky cf td flag_cl cn co km cg flag_cd cr hr cu cy cz dk dj dm do ec eg sv gq er ee et fk fo fj fi fr pf ga gm ge de gh gi gr gl gd gu gt gn gw gy ht hn hk hu is in flag_id ir iq ie il it ci jm jp je jo kz ke ki xk kw kg la lv lb ls lr ly li lt lu mo mk mg mw my mv ml mt mh mr mu mx fm md mc mn me ms ma mz mm na nr np nl nc nz ni ne flag_ng nu kp no om pk pw ps pa pg py pe ph pl pt pr qa ro ru rw sh kn lc vc ws sm st flag_sa sn rs sc sl sg sk si sb so za kr es lk sd sr sz se ch sy tw tj tz th tl tg to tt tn tr flag_tm flag_tm ug ua ae gb us vi uy uz vu va ve vn wf eh ye zm zw re ax ta io bq cx cc gg im yt nf pn bl pm gs tk bv hm sj um ic ea cp dg as aq vg ck cw eu gf tf gp mq mp sx ss tc "}}};t.getSelection&&e.createRange?(k=function(e){var n=t.getSelection().getRangeAt(0),a=n.cloneRange();return a.selectNodeContents(e),a.setEnd(n.startContainer,n.startOffset),a.toString().length},T=function(n,a){var r=0,s=e.createRange();s.setStart(n,0),s.collapse(!0);for(var i,o=[n],l=!1;!l&&(i=o.pop());)if(3==i.nodeType){var u=r+i.length;a>=r&&a<=u&&(s.setStart(i,a-r),s.setEnd(i,a-r),l=!0),r=u}else for(var c=i.childNodes.length;c--;)o.push(i.childNodes[c]);a=t.getSelection(),a.removeAllRanges(),a.addRange(s)}):e.selection&&e.body.createTextRange&&(k=function(t){var n=e.selection.createRange(),a=e.body.createTextRange();return a.moveToElementText(t),a.setEndPoint("EndToStart",n),a.text.length+n.text.length},T=function(t,n){var a=e.body.createTextRange();a.moveToElementText(t),a.collapse(!0),a.moveEnd("character",n),a.moveStart("character",n),a.select()});var M,I=t.emojioneVersion||"2.1.4",R="https://cdnjs.cloudflare.com/ajax/libs/emojione/";!O||p(d())<2?n.getScript(R+I+"/lib/js/emojione.min.js",function(){O=t.emojione,I=d(),E=p(I),R+=I+"/assets";var a=R+"/sprites/emojione.sprites.css";for(e.createStyleSheet?e.createStyleSheet(a):n("<link/>",{rel:"stylesheet",href:a}).appendTo("head");x.length;)x.shift().call()}):(I=d(),E=p(I),R+=I+"/assets"),a(function(){O.imagePathPNG=R+"/png/",M=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|("+O.unicodeRegexp+")","gi")});var D=function(e,t){var n=this;$[n.id=++C]={},S[n.id]={},a(function(){y(n,e,t)})};D.prototype.on=function(e,t){if(e&&n.isFunction(t)){var a=this;n.each(e.toLowerCase().split(" "),function(e,n){w(a,n),($[a.id][n]||($[a.id][n]=[])).push(t)})}return this},D.prototype.off=function(e,t){if(e){var a=this.id;n.each(e.toLowerCase().replace(/_/g,".").split(" "),function(e,r){$[a][r]&&!/^@/.test(r)&&(t?n.each($[a][r],function(e,n){n===t&&($[a][r]=$[a][r].splice(e,1))}):$[a][r]=[])})}return this},D.prototype.setText=function(e){var t=this;return a(function(){t.editor.html(m(e,t)),t.content=t.editor.html(),r(t,"change",[t.editor]),h.apply(t)}),t},D.prototype.getText=function(){return g(this.editor.html(),this)},D.prototype.showPicker=function(){var e=this;return e._sh_timer&&t.clearTimeout(e._sh_timer),e.picker.removeClass("hidden"),e._sh_timer=t.setTimeout(function(){e.button.addClass("active")},50),r(e,"picker.show",[e.picker]),e},D.prototype.hidePicker=function(){var e=this;return e._sh_timer&&t.clearTimeout(e._sh_timer),e.button.removeClass("active"),e._sh_timer=t.setTimeout(function(){e.picker.addClass("hidden")},500),r(e,"picker.hide",[e.picker]),e},n.fn.emojioneArea=function(e){return this.each(function(){return this.emojioneArea?this.emojioneArea:(n.data(this,"emojioneArea",this.emojioneArea=new D(n(this),e)),this.emojioneArea)})}}(document,window,jQuery)},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e){window.PubSub=e}function i(){$('[data-toggle="tooltip"]').tooltip()}n(53),n(55);var o=n(11),l=r(o),u=n(40),c=n(44),d=r(c),p=n(50),f=n(35),m=n(38),g=a(m),h=n(45),v=a(h),b=n(37),_=a(b),y=n(20),w=a(y),k=n(41),T=a(k),C=n(36),S=a(C),O=n(48),x=a(O),P=n(31),A=a(P),j=n(33),E=a(j),N=n(28),M=a(N),I=n(25),R=a(I),D=n(46),B=a(D),L=function(){s(l.default),i(),(new d.default).init(),(0,u.LoginForm)({_loginBox:"main .login-box",_formId:"#js_instagram-add-account",_buttonSubmitId:"#js_instagram-add-account--btn",_showLoginBoxBtnId:"#js_show-login-box",isLoginInstagram:!0}).init(),(0,p.LoginPage)({_loginBox:".auth.login .card-signin",_formId:".form-signin",_buttonSubmitId:'.form-signin [type="submit"]'}).init(),(0,f.confirmationWithRedirect)().init(),g.initHeader(),v.initMenu(),_.init(),S.init(),x.init(),w.init(),T.init(),A.init(),M.init(),R.init(),E.init(),B.init()};!function(){L()}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tplTextField=function(e){return $('<div class="'+e+' mt-2">\n    <div class="row">\n        <div class="col">            \n            <input type="text" placeholder="Введите ключевые слова" value="" data-role="tagsinput" class="form-control answer-words mb-2" />\n        </div>\n        <div class="col">\n            <textarea class="form-control answer-messages" rows="4"\n                data-emoji-picker="true" style="padding: 0.25rem 1.75rem 0.25rem 0.25rem; width: 100%;min-height: 42px;"\n                placeholder="Введите сообщение"\n            ></textarea>\n            \n        </div>\n    </div>\n</div>')}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function s(){(0,N.emoji)({page:F.currentPageCls,styles:{old:"bottom: 30px;",new:"top: -210px;"}})}function i(e,t){e.each(function(){if(""===$(this).val())return t.preventDefault(),void $(this).addClass("input-error");$(this).removeClass("input-error")})}function o(e){function t(e){var t=e.status.message;$(".form-submit-finish--error").addClass("d-block").find(".alert").append("<p>"+t+"</p>")}var n=$(q.fields),a=[],r=!0,s=n.find(q.keyWord),o=n.find(q.answer);if(i(s,e),i(o,e),n.each(function(e,t){var n=D($(t).find(q.keyWord)),s=$(t).find(q.answer).val(),i=$(t).find(q.fileUploadBox).attr("attached-img-id"),o=$(t).find(".js_uploaded-img-from-posts"),l=o.data("postId"),u=o.data("postType");if(!n.length||!s.length)return $(t).append('\n                <p class="msg-empty-field text-danger">Пустое поле не валидно</p>\n            '),setTimeout(function(){$(".msg-empty-field").addClass("d-none")},5e3),void(r=!1);var c={key_words:n,answer:s,attachment:i?{image_id:i}:void 0};l&&(c.attachment=h({},c.attachment,{post:{id:l,type:u||"type-error"}})),a.push(c)}),r){var l={username:B,type:F.pathType,subtype:F.pathSubType,user_default_config:{},user_custom_config:{forms:a}};T.default.postStartTask(l,t).then(function(e){"ok"===e.status.state&&($(".form-submit-finish").find(".alert p").remove(),$(".form-submit-finish").addClass("d-block").find(".alert").append("<p>task_id: "+e.data.task_id+"</p>"))})}}function l(){function e(){var e=U.selectCls;$("."+e).on("change",function(){B=$("."+e+" option:selected").val(),A.init(e,F)})}S.init(e,U)}function u(e){$(q.fields+":not(:first-child)").removeClass("d-block"),e.stopPropagation()}function c(e){var t=this;$("#load-more").off().on("click",function(n){var a=$(n.target),r=a.attr("cursor");e(null,{userName:B,cursor:r},{loadMoreHandler:t,targetButton:V})})}function d(){$(".js_open-posts-gridModal").on("click",function(e){V=$(this);var t=$("#postsGridModal");(0,M.getPosts)(t,{userName:B},{loadMoreHandler:c,targetButton:V}),t.find(".modal-title").text("Публикации")})}function p(){var e=$('.autocomments-text-fields input[data-role="tagsinput"]'),t=$('form button[type="submit"]');(0,R.nextBtnvalidateCompetitorsHandler)(e,t),$(".js_add-autocomments").on("click",function(e){var n=$(q.fields).last();(0,I.tplTextField)(q.fields.substr(1)).insertAfter(n),s(),E.init(),$('[data-toggle="tooltip"]').tooltip(),d();var a=$('input[data-role="tagsinput"]',n);(0,R.initTagsInput)(),(0,R.nextBtnvalidateCompetitorsHandler)(a,t)}),$(".form-submit-finish .close").on("click",function(e){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(v.CONST.events.tasks.NEW_TASK_CREATED)}),$(".form-submit-finish--error .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(v.CONST.events.tasks.NEW_TASK_CREATED),u()}),l()}function f(e){B=e.username}function m(e,t){switch(e){case 0:f(t)}}function g(){if($(F.currentPageCls).length){var e={stepReducer:m,onSubmitHandler:o};_.init(e),p(),x.init(),s(),(0,R.initTagsInput)(),window.PubSub.subscribe(v.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_RENDERED_LAZY,function(e,t){A.init(L,F)})}}Object.defineProperty(t,"__esModule",{value:!0});var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.init=g;var v=n(0),b=n(6),_=r(b),y=n(1),w=a(y),k=n(2),T=a(k),C=n(9),S=r(C),O=n(26),x=r(O),P=n(8),A=r(P),j=n(7),E=r(j),N=n(15),M=n(12),I=n(24),R=n(10),D=w.default.getValByCommaSeparator,B="",L="js_logs-accounts",F={currentPageCls:".autocomments-page",tasksList:".log-tasks",logsTabBtn:"#v-pills-logs-tab",pagination:".logs-pagination",paginationPgNumber:".page-number",pathType:v.CONST.url.tmTypes.autocommentsT,pathSubType:v.CONST.url.tmTypes.autocommentsSubT[0]},q={fields:".autocomments-text-fields",keyWord:"textarea.answer-words",answer:"textarea.answer-messages",fileUploadBox:".file-upload",addPostBtns:".js_autocomments-add-post"},U={selectCls:"js_logs-accounts",selectClsLogsTaskType:"js_logs-subtypes",wrapperSubtype:".log-subype"},V={}},function(e,t,n){"use strict";function a(){if($(".autocomments-page").length){var e={type:r.CONST.url.tmTypes.autocommentsT,subtype:r.CONST.url.tmTypes.autocommentsSubT[0]},t={$runs:$(".tasks-runs"),$stopped:$(".tasks-stopped"),$all:$(".tasks-all")};(0,s.getTasksData)(t,e),window.PubSub.subscribe(r.CONST.events.tasks.NEW_TASK_CREATED,function(n,a){(0,s.getTasksData)(t,e)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.init=a;var r=n(0),s=n(5)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tplTextFieldGreet=function(e){return $('<div class="'+e+'">\n        <div class="row">\n            <div class="col">\n                <div>                \n                    <textarea class="form-control answer-words" rows="4" \n                        data-emoji-picker="true" placeholder="Введите сообщение"></textarea>    \n                </div>\n\n                \x3c!-- file-upload --\x3e\n                <div class="file-upload-btn-box" data-toggle="tooltip" data-placement="top" title="Добавить изображение">\n                    <button class="file-upload-btn btn btn-success" type="button">\n                        <i class="far fa-image fa-lg"></i>\n                    </button>\n                </div>\n\n                <button type="button" class="btn btn-success post-upload-btn js_automessages-add-post"\n                    title="Добавить публикацию"\n                    data-toggle="tooltip"\n                    data-placement="top"\n                    data-post-info="todo: get req to user: ">\n                    <span class="js_open-posts-gridModal"\n                        data-container="body" data-toggle="popover" data-placement="bottom" data-content="У текущего аккаунта нет ни одного поста">\n                    <i class="far fa-images fa-lg"></i>\n                    </span>\n                </button>\n                \n                <div class="mt-2">\n                    <div class="file-upload">\n                    \n                      <div class="image-upload-wrap">\n                        <input class="file-upload-input" type="file" accept=".jpg, .jpeg">\n                      </div>\n                      <div class="file-upload-content">\n                        <img class="file-upload-image" src="#" alt="your image">\n                        <div class="image-title-wrap">\n                          <button type="button" class="remove-image btn btn-warning">Удалить <span class="image-title">Загрузить</span></button>\n                        </div>\n                      </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>')}},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){function t(e){var t=e.status.message;$(".form-submit-finish--error").addClass("d-block").find(".alert").append("<p>"+t+"</p>")}var n=$(R.fields),a=[],r=function(e){var t=$(e).find(R.fileUploadBox).attr("attached-img-id"),n=$(e).find(".js_uploaded-img-from-posts"),a=n.data("postId"),r=n.data("postType"),s={id:a,type:r||"type-error"},i=null;return a?i={post:s}:t&&(i={image_id:t}),i};n.each(function(e,t){var n=$(t).find("textarea.answer-words").val(),s=r(t);a.push({answer:n,attachment:s||void 0})});var s={username:E||"the_rostyslav",type:g.CONST.url.tmTypes.autogreetT,subtype:g.CONST.url.tmTypes.autogreetSubT[0],user_default_config:{task_mode:D.user_default_config.task_mode},user_custom_config:{forms:a}};_.default.postStartTask(s,t).then(function(e){"ok"===e.status.state&&($(".form-submit-finish").find(".alert p").remove(),$(".form-submit-finish").addClass("d-block").find(".alert").append("<p>task_id: "+e.data.task_id+"</p>"))})}function s(){function e(){var e=B.selectCls;$("."+e).on("change",function(){E=$("."+e+" option:selected").val(),S.init(e,I)})}w.init(e,B)}function i(){(0,O.emoji)({page:I.currentPageCls,styles:{old:"bottom: 30px;",new:"top: -210px;"}})}function o(){$(R.fields+":not(:first-child)").remove()}function l(e){var t=this;$("#load-more").on("click",function(n){var a=$(n.target),r=a.attr("cursor");e(null,{userName:E,cursor:r},{loadMoreHandler:t,targetButton:L})})}function u(){$(".js_open-posts-gridModal").on("click",function(e){L=$(this);var t=$("#postsGridModal");(0,A.getPosts)(t,{userName:E},{loadMoreHandler:l,targetButton:L}),t.find(".modal-title").text("Публикации")})}function c(){$(".js_add-automessages").on("click",function(e){var t=$(R.fields).last();(0,j.tplTextFieldGreet)(R.fields.substr(1)).insertAfter(t),i(),P.init(),$('[data-toggle="tooltip"]').tooltip(),u()}),$(".form-submit-finish .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(g.CONST.events.tasks.NEW_TASK_CREATED),o()}),$(".form-submit-finish--error .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(g.CONST.events.tasks.NEW_TASK_CREATED),o()}),s()}function d(e){E=e.username}function p(){var e=function(e,t){var n=t.cfg&&t.cfg.task_modes;e.empty();for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&$('<div class="custom-control custom-radio">\n                '+function(e,t){switch(e){case"AGGRESSIVE":return'<input type="radio" id="'+e+'" name="customRadio" value="'+e+'" class="custom-control-input">\n                    <label class="custom-control-label" for="'+e+'"><strong>Агрессивный:</strong> '+t+" сообщений в час</label>";case"MIDDLE":return'<input type="radio" id="'+e+'" name="customRadio" value="'+e+'" class="custom-control-input">\n                    <label class="custom-control-label" for="'+e+'"><strong>Средний:</strong> '+t+" сообщений в час</label>";case"SAFE":return'<input type="radio" id="'+e+'" name="customRadio" value="'+e+'" class="custom-control-input" checked>\n                    <label class="custom-control-label" for="'+e+'"><strong>Безопасный:</strong> '+t+" сообщений в час</label>"}}(a,n[a])+"\n            </div>").appendTo(e)},t={type:I.pathType,subtype:I.pathSubType};_.default.getDefaultConfigs(t).then(function(t){"ok"===t.status.state&&(e($(M),t.data.found),$(M+" input[type=radio]").on("click",function(e){var t=$(e.target).attr("value");D.user_default_config.task_mode=t.toUpperCase()}))})}function f(e,t){switch(e){case 0:d(t),p()}}function m(){if($(I.currentPageCls).length){var e={stepReducer:f,onSubmitHandler:r};v.init(e),c(),T.init(I),window.PubSub.subscribe(g.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_RENDERED_LAZY,function(e,t){S.init(N,I)}),u(),i(),P.init(),window.PubSub.subscribe(g.CONST.events.autoarnswer.IMAGE_UPLOADED,function(e,t){var n=t.response,a=n.length?JSON.parse(n):"",r=a&&a.data&&a.data.image_id;$(t.el).closest(".file-upload").attr("attached-img-id",r);var s=$(t.el).closest(".col").find(".js_uploaded-img-from-posts");s.length&&s.remove()}),window.PubSub.subscribe(g.CONST.events.modal.IMAGE_POST_SELECTED,function(e,t){var n=$(t.closestCol).find(".file-upload-content");n.length&&n.hide()})}}Object.defineProperty(t,"__esModule",{value:!0}),t.init=m;var g=n(0),h=n(6),v=a(h),b=n(2),_=function(e){return e&&e.__esModule?e:{default:e}}(b),y=n(9),w=a(y),k=n(29),T=a(k),C=n(8),S=a(C),O=n(15),x=n(7),P=a(x),A=n(12),j=n(27),E="",N="js_logs-accounts",M=".js_autogreeting-speed",I={currentPageCls:".autogreeting-page",tasksList:".log-tasks",logsTabBtn:"#v-pills-logs-tab",pagination:".logs-pagination",paginationPgNumber:".page-number",pathType:g.CONST.url.tmTypes.autogreetT,pathSubType:g.CONST.url.tmTypes.autogreetSubT[0]},R={fields:".autogreeting-text-fields",fileUploadBox:".file-upload"},D={user_default_config:{task_mode:"SAFE"}},B=g.CONST.logsState,L={}},function(e,t,n){"use strict";function a(e){if($(e.currentPageCls).length){var t=e.pathType,n=e.pathSubType,a={type:t,subtype:n},i={$runs:$(".tasks-runs"),$all:$(".tasks-all")};(0,s.getTasksData)(i,a),window.PubSub.subscribe(r.CONST.events.tasks.NEW_TASK_CREATED,function(e,t){(0,s.getTasksData)(i,a)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.init=a;var r=n(0),s=n(5)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tplTextField=function(e){return $('<div class="'+e+' mt-2">\n    <div class="row">\n        <div class="col">\n            <input type="text" value="" placeholder="Введите ключевые слова" data-role="tagsinput" class="form-control answer-words mb-2" />\n        </div>\n        <div class="col">\n            <textarea class="form-control answer-messages" rows="4"\n                data-emoji-picker="true" style="padding: 0.25rem 1.75rem 0.25rem 0.25rem; width: 100%;min-height: 42px;"\n                placeholder="Введите сообщение"\n            ></textarea>\n            \x3c!-- file-upload --\x3e\n            <div class="file-upload-btn-box" data-toggle="tooltip" data-placement="top" title="Добавить изображение">\n                <button class="file-upload-btn btn btn-success" type="button">\n                    <i class="far fa-image fa-lg"></i>\n                </button>\n            </div>\n            \x3c!-- Button trigger modal --\x3e\n            <button type="button" class="btn btn-success post-upload-btn js_automessages-add-post"\n                title="Добавить публикацию"\n                data-toggle="tooltip"\n                data-placement="top"\n                data-post-info="todo: get req to user: ">\n                <span class="js_open-posts-gridModal"\n                    data-container="body" data-toggle="popover" data-placement="bottom" data-content="У текущего аккаунта нет ни одного поста">\n                <i class="far fa-images fa-lg"></i>\n                </span>\n            </button>\n\n            <div class="mt-2">\n                <div class="file-upload">\n                    <div class="image-upload-wrap">\n                        <input class="file-upload-input" type=\'file\' accept=".jpg, .jpeg" />\n                    </div>\n                    <div class="file-upload-content">\n                        <img class="file-upload-image" src="#" alt="your image" />\n                        <div class="image-title-wrap">\n                        <button type="button" class="remove-image btn btn-warning">Удалить <span class="image-title">Загрузить</span></button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function s(){(0,N.emoji)({page:F.currentPageCls,styles:{old:"bottom: 30px;",new:"top: -210px;"}})}function i(e,t){e.each(function(){if(""===$(this).val())return t.preventDefault(),void $(this).addClass("input-error");$(this).removeClass("input-error")})}function o(e){function t(e){var t=e.status.message;$(".form-submit-finish--error").addClass("d-block").find(".alert").append("<p>"+t+"</p>")}var n=$(q.fields),a=[],r=!0,s=n.find(q.keyWord),o=n.find(q.answer);if(i(s,e),i(o,e),n.each(function(e,t){var n=D($(t).find(q.keyWord)),s=$(t).find(q.answer).val(),i=$(t).find(q.fileUploadBox).attr("attached-img-id"),o=$(t).find(".js_uploaded-img-from-posts"),l=o.data("postId"),u=o.data("postType");if(!n.length||!s.length)return $(t).append('\n                <p class="msg-empty-field text-danger">Пустое поле не валидно</p>\n            '),setTimeout(function(){$(".msg-empty-field").addClass("d-none")},5e3),void(r=!1);var c={key_words:n,answer:s,attachment:i?{image_id:i}:void 0};l&&(c.attachment=h({},c.attachment,{post:{id:l,type:u||"type-error"}})),a.push(c)}),r){var l={username:B,type:F.pathType,subtype:F.pathSubType,user_default_config:{},user_custom_config:{forms:a}};T.default.postStartTask(l,t).then(function(e){"ok"===e.status.state&&($(".form-submit-finish").find(".alert p").remove(),$(".form-submit-finish").addClass("d-block").find(".alert").append("<p>task_id: "+e.data.task_id+"</p>"))})}}function l(){function e(){var e=U.selectCls;$("."+e).on("change",function(){B=$("."+e+" option:selected").val(),A.init(e,F)})}S.init(e,U)}function u(e){$(q.fields+":not(:first-child)").removeClass("d-block"),e.stopPropagation()}function c(e){var t=this;$("#load-more").off().on("click",function(n){var a=$(n.target),r=a.attr("cursor");e(null,{userName:B,cursor:r},{loadMoreHandler:t,targetButton:V})})}function d(){$(".js_open-posts-gridModal").on("click",function(e){V=$(this);var t=$("#postsGridModal");(0,M.getPosts)(t,{userName:B},{loadMoreHandler:c,targetButton:V}),t.find(".modal-title").text("Публикации")})}function p(){var e=$('.automessages-text-fields input[data-role="tagsinput"]'),t=$('form button[type="submit"]');(0,R.nextBtnvalidateCompetitorsHandler)(e,t),$(".js_add-automessages").on("click",function(e){var n=$(q.fields).last();(0,I.tplTextField)(q.fields.substr(1)).insertAfter(n),s(),E.init(),$('[data-toggle="tooltip"]').tooltip(),d();var a=$('input[data-role="tagsinput"]',n);(0,R.initTagsInput)(),(0,R.nextBtnvalidateCompetitorsHandler)(a,t)}),$(".form-submit-finish .close").on("click",function(e){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(v.CONST.events.tasks.NEW_TASK_CREATED)}),$(".form-submit-finish--error .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(v.CONST.events.tasks.NEW_TASK_CREATED),u()}),l()}function f(e){B=e.username}function m(e,t){switch(e){case 0:f(t)}}function g(){if($(F.currentPageCls).length){var e={stepReducer:m,onSubmitHandler:o};_.init(e),p(),x.init(),d(),s(),E.init(),(0,R.initTagsInput)(),window.PubSub.subscribe(v.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_RENDERED_LAZY,function(e,t){A.init(L,F)}),window.PubSub.subscribe(v.CONST.events.autoarnswer.IMAGE_UPLOADED,function(e,t){var n=t.response,a=n.length?JSON.parse(n):"",r=a&&a.data&&a.data.image_id;$(t.el).closest(".file-upload").attr("attached-img-id",r);var s=$(t.el).closest(".col").find(".js_uploaded-img-from-posts");s.length&&s.remove()}),window.PubSub.subscribe(v.CONST.events.modal.IMAGE_POST_SELECTED,function(e,t){var n=$(t.closestCol).find(".file-upload-content");n.length&&n.hide()})}}Object.defineProperty(t,"__esModule",{value:!0});var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.init=g;var v=n(0),b=n(6),_=r(b),y=n(1),w=a(y),k=n(2),T=a(k),C=n(9),S=r(C),O=n(32),x=r(O),P=n(8),A=r(P),j=n(7),E=r(j),N=n(15),M=n(12),I=n(30),R=n(10),D=w.default.getValByCommaSeparator,B="",L="js_logs-accounts",F={currentPageCls:".automessages-page",tasksList:".log-tasks",logsTabBtn:"#v-pills-logs-tab",pagination:".logs-pagination",paginationPgNumber:".page-number",pathType:v.CONST.url.tmTypes.automessagesT,pathSubType:v.CONST.url.tmTypes.automessagesSubT[0]},q={fields:".automessages-text-fields",keyWord:'.answer-words input[data-role="tagsinput"]',answer:"textarea.answer-messages",fileUploadBox:".file-upload",addPostBtns:".js_automessages-add-post"},U={selectCls:"js_logs-accounts",selectClsLogsTaskType:"js_logs-subtypes",wrapperSubtype:".log-subype"},V={}},function(e,t,n){"use strict";function a(){if($(".automessages-page").length){var e={type:r.CONST.url.tmTypes.automessagesT,subtype:r.CONST.url.tmTypes.automessagesSubT[0]},t={$runs:$(".tasks-runs"),$stopped:$(".tasks-stopped"),$all:$(".tasks-all")};(0,s.getTasksData)(t,e),window.PubSub.subscribe(r.CONST.events.tasks.NEW_TASK_CREATED,function(n,a){(0,s.getTasksData)(t,e)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.init=a;var r=n(0),s=n(5)},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){function t(e){var t=e.status.message;$(".form-submit-finish--error").addClass("d-block").find(".alert").append("<p>"+t+"</p>")}var n=$(".bot-text-fields"),a=function(e){return e.val().trim().replace(/ /g,"").split(",").filter(function(e){return e.length>0})},r=[];n.each(function(e,t){var n=a($(t).find("textarea.answer-words")),s=$(t).find("textarea.answer-messages").val();r.push({key_words:n,answer:s})});var s={username:w,type:T.pathType,subtype:T.pathSubType,user_default_config:{},user_custom_config:{forms:r}};m.default.postStartTask(s,t).then(function(e){"ok"===e.status.state&&($(".form-submit-finish").find(".alert p").remove(),$(".form-submit-finish").addClass("d-block").find(".alert").append("<p>task_id: "+e.data.task_id+"</p>"))})}function s(e,t){e.empty().addClass("border-light-color"),$('<div class="">Доступные аккаунты</div><select name="task-type" class="'+k+'"></select>').appendTo(e),t.forEach(function(e){$('<option class="list-group-item py-2" value="'+e+'">\n            '+e+"\n        </option>").appendTo($("."+k))}),$("."+k).on("change",function(){w=$("."+k+" option:selected").val(),y.init(k,T)})}function i(){var e=function(){return $('<div class="bot-text-fields mt-2">\n        <div class="row">\n            <div class="col">\n                <textarea class="form-control answer-words" rows="4" placeholder="Введите ключевые слова или фразы через запятую, при которых будет срабатывать чат-бот"></textarea>\n            </div>\n            <div class="col">\n                <textarea class="form-control answer-messages" rows="4" placeholder="Введите сообщение, которое будет отправляться, если присутствовали ключ.слова или фразы из столбца слева"></textarea>\n            </div>\n        </div>\n    </div>')};$(".js_add-bot").on("click",function(t){var n=$(".bot-text-fields").last();e().insertAfter(n)}),$(".form-submit-finish .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(c.CONST.events.tasks.NEW_TASK_CREATED)}),$(".form-submit-finish--error .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(c.CONST.events.tasks.NEW_TASK_CREATED)}),h.init(s)}function o(e){w=e.username}function l(e,t){switch(e){case 0:o(t)}}function u(){if($(".bot-page").length){var e={stepReducer:l,onSubmitHandler:r};p.init(e),i(),b.init(),window.PubSub.subscribe(c.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_RENDERED_LAZY,function(e,t){y.init(k,T)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.init=u;var c=n(0),d=n(6),p=a(d),f=n(2),m=function(e){return e&&e.__esModule?e:{default:e}}(f),g=n(9),h=a(g),v=n(34),b=a(v),_=n(8),y=a(_),w="",k="js_logs-accounts",T={currentPageCls:".bot-page",tasksList:".log-tasks",logsTabBtn:"#v-pills-logs-tab",pagination:".logs-pagination",paginationPgNumber:".page-number",pathType:c.CONST.url.tmTypes.chatBotT,pathSubType:c.CONST.url.tmTypes.chatBotSubT[0]}},function(e,t,n){"use strict";function a(){if($(".bot-page").length){var e={type:r.CONST.url.tmTypes.chatBotT,subtype:r.CONST.url.tmTypes.chatBotSubT[0]},t={$runs:$(".tasks-runs"),$stopped:$(".tasks-stopped")};(0,s.getTasksData)(t,e),window.PubSub.subscribe(r.CONST.events.tasks.NEW_TASK_CREATED,function(n,a){(0,s.getTasksData)(t,e)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.init=a;var r=n(0),s=n(5)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){function e(){r()}var t=i.default,n=c(),a=function(e){t.confirm(e).then(function(e){if(e.status&&"ok"===e.status.state){u.default.set(o.CONST.cookieStorage.emailConfirmed,"confirmed"),u.default.set(o.CONST.cookieStorage.token,e.data.token);sessionStorage.getItem("customersData");$(".confirm-registration").append("<p>confirmation status: "+e.status.state+"</p>"),setTimeout(function(){window.location="./profile.html"},1e3)}else e.status})},r=function(){var e=n.token;location.pathname.indexOf("confirm-registration")&&e&&a(e)};return{init:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.confirmationWithRedirect=r;var s=n(3),i=a(s),o=n(0),l=n(4),u=a(l),c=function(){var e=window.location.search,t={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,n,a){t[n]=a}),t}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=t;e.empty().addClass("border-light-color"),$('<li class="list-group-item py-2"><h3>UserTaskManager</h3></li>').appendTo(e),n.forEach(function(t){$('<li class="list-group-item py-2" data-username="'+t.type+'">\n                <div class="media-body d-flex">\n                    <div class="col task-type">\n                        '+(t.task_id?'<p class="mt-0 mb-1 name">'+t.task_id+"</p>":"")+'\n                    </div>\n                    <div class="col task-subtype">\n                        '+(t.subtype?'<p class="mt-0 mb-1 name">'+t.subtype+"</p>":"")+'\n                    </div>\n                    <div class="col task-progress">\n                        '+("STOPPED"===t.status.state?'<p class="mt-0 mb-1 name">Остановлено - '+t.status.reason+"</p>":"")+'\n                    </div>\n                    \x3c!--<div class="col task-progress">\n                        '+(t.progress?'<p class="mt-0 mb-1 name">Количество - '+t.progress.count+'</p>\n                                <p class="mt-0 mb-1 name">Процент - '+t.progress.percent+"</p>":"")+"\n                    </div>--\x3e\n                </div>\n            </li>").appendTo(e)})}function s(e){y.default.getMetadata(e).then(function(e){"ok"===e.status.state&&r($(".follow-tasks-list"),e.data.meta)})}function i(){s({type:b.CONST.url.tmTypes.followingT,subtype:O.subtype||b.CONST.url.tmTypes.followingSubT[0]})}function o(e){var t=k.default.fillRadioGroupList,n={type:b.CONST.url.tmTypes.followingT,subtype:O.subtype||b.CONST.url.tmTypes.followingSubT[0]};!function(t){if("FOLLOWING_BY_LIST"===n.subtype){$(".add-file").addClass("d-block"),$(".add-competitors").addClass("d-none").removeClass("d-block");var a=$(".js_add-new-task fieldset").get(e+1);$(a).find(".btn-next").attr("disabled","disabled")}else{$(".add-competitors").addClass("d-block"),$(".add-file").addClass("d-none").removeClass("d-block");var r=$(".js_add-new-task fieldset").get(e+1);$(r).find(".btn-next").removeAttr("disabled")}}(n.subtype),y.default.getDefaultConfigs(n).then(function(e){if("ok"===e.status.state){var n=e.data.found.cfg.task_modes;t($(".js_follow-speed"),n)}})}function l(){var e=k.default.getValByCommaSeparator($(".follow-form").find("#followers"));O.user_custom_config={competitors:e}}function u(e){var t=$(".js_follow-competitors"),n=t.closest(".add-competitors").find(".btn-next");switch(e){case 0:i(O.username);break;case 1:o(e),(0,S.nextBtnvalidateCompetitorsHandler)(t,n);break;case 2:l()}}function c(e){var t=e.status.message;$(".form-submit-finish--error").addClass("d-block").find(".alert").append("<p>"+t+"</p>")}function d(e){var t=$(e);$(".js_profile-user-follow>.container").removeClass("container"),(0,T.attachTxtFileHandler)(".file-upload-container"),t.find("fieldset:first-child").fadeIn("slow"),t.find('input[type="text"]').on("focus",function(){$(this).removeClass("input-error")}),t.find(".btn-next").on("click",function(){var e=$(this).parents("fieldset"),t=!0,n=e.find('input[name="userAccountRadio"]:checked');n.length>0&&(O.username=n.parents("li").data("username")),u(e.index(),O),e.find('input[type="text"],input[type="email"]').each(function(){""===$(this).val()?($(this).addClass("input-error"),t=!1):$(this).removeClass("input-error")}),t&&e.fadeOut(400,function(){$(this).next().fadeIn()})}),t.find(".btn-previous").on("click",function(){$(this).parents("fieldset").fadeOut(400,function(){$(this).prev().fadeIn()})}),$(".js_follow-speed input[type=radio]").on("click",function(){var e=$(this).attr("value");O.user_default_config={task_mode:e.toUpperCase()}}),$(".js_get-follow-type input[type=radio]").on("click",function(e){var t=$(e.target).attr("value");O.subtype=t.toUpperCase()}),t.on("submit",function(e){O.user_default_config=g({},O.user_default_config,{criteria:{}});var t=document.forms["follow-form"].limit,n={from:document.forms["follow-form"].have_posts_from.value,to:document.forms["follow-form"].have_posts_to.value},a={from:document.forms["follow-form"].have_followers_from.value,to:document.forms["follow-form"].have_followers_to.value},r={from:document.forms["follow-form"].have_followings_from.value,to:document.forms["follow-form"].have_followings_to.value};if(""===t.value)return t.focus(),!1;O.user_default_config.criteria={limit:t.value,unfollow_then:!!$("#unfollow_then:checked").length,follow_on_closed_profiles:!!$("#follow_on_closed_profiles:checked").length,have_posts:n,have_followers:a,have_followings:r},$(this).find('input[type="text"],input[type="number"],input[type="email"]').each(function(){""===$(this).val()?(e.preventDefault(),$(this).addClass("input-error")):$(this).removeClass("input-error")}),O.type=b.CONST.url.tmTypes.followingT,"FOLLOWING_BY_LIST"===O.subtype&&(O.user_custom_config.attachment={list_id:$(".add-file .file-upload-container").attr("attached-txt-id")}),O.subtype,b.CONST.url.tmTypes.followingSubT[1],y.default.postStartFollowingList(O,c).then(function(e){"ok"===e.status.state&&($(".form-submit-finish").find(".alert p").remove(),$(".form-submit-finish").addClass("d-block").find(".alert").append("<p>task_id: "+e.data.task_id+"</p>"))})}),$(".form-submit-finish .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(b.CONST.events.tasks.NEW_TASK_CREATED)}),$(".form-submit-finish--error .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(b.CONST.events.tasks.NEW_TASK_CREATED)}),$(".js_follow-clear-competitors").on("click",function(){$(".js_follow-competitors").val("")})}function p(e){x=e}function f(){var e=$(".accounts-list"),t=e.find("li.media");t.addClass("js_user-radio").removeClass("py-3 media");for(var n=0;n<t.length;n++)$(t[n]).wrapInner(function(e){return'<label class="accounts-list--label-wrapper col mb-0 media py-3" for="customRadio-'+e+'"></label>'}(n)).append(function(e){return'<div class="">\n            <input type="radio" name="userAccountRadio" id="customRadio-'+e+'" class="custom-control-input d-none" value="">\n        </div>'}(n));$(".js_user-radio").on("click","input[type=radio]",function(e){var t=$(this).parents("fieldset");$("li.active",t).removeClass("active"),$(this).closest("li").addClass("active"),$(".btn-next",t).prop("disabled",!1)})}function m(){var e=$(".follow").length;if(e){var t={type:b.CONST.url.tmTypes.followingT,subtype:b.CONST.url.tmTypes.followingSubT[0],subtypes:b.CONST.url.tmTypes.followingSubT};v.init({isInCorrectPage:e,initialPath:t}),d(".follow-form");var n=["По списку","По активной аудитории конкурентов"];(0,C.initLogsTab)({logsState:b.CONST.logsState,logsSubtypes:t.subtypes,clsConst:P,setUserNameCb:p,textRusArray:n}),(0,S.initTagsInput)(),window.PubSub.subscribe(b.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_RENDERED,function(e,t){f()})}}Object.defineProperty(t,"__esModule",{value:!0});var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.modifyAccList=f,t.init=m;var h=n(19),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(h),b=n(0),_=n(2),y=a(_),w=n(1),k=a(w),T=n(14);n(52);var C=n(13),S=n(10),O={username:"",subtype:b.CONST.url.tmTypes.followingSubT[0],user_default_config:{task_mode:"SAFE"}},x="",P={currentPageCls:".follow",tasksList:".log-tasks",logsTabBtn:"#v-pills-logs-tab",pagination:".logs-pagination",paginationPgNumber:".page-number",pathType:b.CONST.url.tmTypes.followingT,pathSubType:b.CONST.url.tmTypes.followingSubT[0]}},function(e,t,n){"use strict";function a(e){var t=s[e],n=t.hamburgerMenuCls,a=t.hamburgerButtonCls,r=t.hamburgerButtonCloseClass,i=t.hamburgerMenuOpenedClass;$(a).toggleClass(r),$(n).toggleClass(i)}function r(){$(s.leftMenu.hamburgerButtonCls).on("click",a.bind(this,"leftMenu")),$(s.rightMenu.hamburgerButtonCls).on("click",a.bind(this,"rightMenu")),$(s.subHeader.hamburgerButtonCls).on("click",a.bind(this,"subHeader"))}Object.defineProperty(t,"__esModule",{value:!0}),t.init=r;var s={leftMenu:{hamburgerButtonCls:"#aside_mobile__button",hamburgerMenuCls:".aside-burger-menu",hamburgerMenuOpenedClass:"burger-menu--closed",hamburgerButtonCloseClass:"burger-menu__button--close"},rightMenu:{hamburgerButtonCls:"#header_mobile_toggler",hamburgerMenuCls:".r-side-burger-menu",hamburgerMenuOpenedClass:"r-side-burger-menu--open",hamburgerButtonCloseClass:"burger-menu-right__button--close"},subHeader:{hamburgerButtonCls:"#header_mobile_topbar_toggler",hamburgerMenuCls:".sub-header",hamburgerMenuOpenedClass:"sub-header--open",hamburgerButtonCloseClass:"sub-header-button--close"}}},function(e,t,n){"use strict";function a(){$(d).text("**emailNotConfirmed** Email не подтвержден.").css("color","lightcoral")}function r(e,t){$(u.CONST.uiSelectors.headerNavLoginBtn).addClass(p).removeClass(f),$(u.CONST.uiSelectors.headerRegBtn).addClass(p).removeClass(f),$(u.CONST.uiSelectors.headerLoginBox).addClass(p).removeClass(f),$(".nav-link.js_logOut").addClass(f).removeClass(p),$(c).text("**onLoginSubscribe** вы залогинились в Luxgram успешно").css("color","lightblue"),l.default.isEmailConfirmed()||a()}function s(){var e=l.default.isLoggedIn();(l.default.isEmailConfirmed()||a(),e)?($(".nav-link.js_logOut").parent().show(),$(".js_email-confirm--text").text("вы залогинились успешно"),document.referrer.includes("confirm-registration")&&$(".js_message_logged--text").text("вы подтвердили регистрацию"),r()):($(c).text("Привет анонимный пользователь"),$(d).empty())}function i(){s()}Object.defineProperty(t,"__esModule",{value:!0}),t.initHeader=i;var o=n(3),l=function(e){return e&&e.__esModule?e:{default:e}}(o),u=n(0),c=".js_message_logged--text",d=".js_email-confirm--text",p="d-none",f="d-block"},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){var t={deleteBtnCls:".js_acc-delete",updateBtnCls:".js_acc-refresh",editBtnCls:".js_acc-edit"};$(t.updateBtnCls).off(),e(t)}function s(e){var t=e.deleteBtnCls,n=e.updateBtnCls,a=e.editBtnCls,o=$("#delete-user-promt"),d="",f={},g={replaceWith:!0,holderCls:".modal-image-holder",uploadBtnCls:".js_edit-profile-img-upd",imageCls:"img.user-avatar"};m.init(g),window.PubSub.subscribe(u.CONST.events.autoarnswer.IMAGE_UPLOADED_AVATAR,function(e,t){var n=JSON.parse(t.response),a=n.data.profile.profile_pic_url;f.$li.find("img").attr("src",a)}),$(t).on("click",function(e){d=$(e.target).closest(t).data("username"),o.modal("show")}),$(".js_acc-delete-confirm").on("click",function(e){l.default.delInstagramAccount(d).then(function(e){"ok"===e.status.state&&(o.hide(),window.PubSub.publish(u.CONST.events.instagramAccouns.INSTAGRAM_ACCOUNS_NEED_REFRESH))})}),$(n).on("click",function(e){var t=$(e.target).closest("li"),a=$(e.target).closest(n).data("username"),i=u.CONST.user.defaulAvatar;p.default.add(t,""),l.default.updateInstagramAccount(a).then(function(e){var n=e.data.account;t.replaceWith((0,c.renderItem)(n,t,i)),r(s),p.default.remove()})});var h=$("#edit-user-promt");$(a).on("click",function(e){var t=$(e.target).closest("li"),n=t.find(a),r=n.data("username"),s=n.data("name"),i=n.data("url"),o=n.data("biography"),l=n.data("img"),u=n.data("is_business"),c=n.data("is_private"),d=h.find("form").get(0),p={login:d.login,username:d.username,site:d.site,about:d.biography,userAvatarImg:d.userAvatar};f={login:s,username:r,site:i,about:o,$li:t,followerC:n.data("follower_count"),followingC:n.data("following_count"),mediaC:n.data("media_count")},g.username=r,p.login.value=s,p.username.value=r,p.site.value=i,p.about.value=o,p.userAvatarImg.src=l;var m=h.find(".bussines-profile");u?m.addClass("d-none").removeClass("d-block"):(m.addClass("d-block"),c?(m.find(".js_btn-prof-type-switcher #closed-profile-on").closest("label").addClass("active").find("#closed-profile-on").attr("checked","checked"),m.find(".js_btn-prof-type-switcher #closed-profile-off").closest("label").removeClass("active").find("#closed-profile-off").attr("checked",!1)):(m.find(".js_btn-prof-type-switcher #closed-profile-off").closest("label").addClass("active").find("#closed-profile-off").attr("checked","checked"),m.find(".js_btn-prof-type-switcher #closed-profile-on").closest("label").removeClass("active").find("#closed-profile-on").attr("checked",!1))),window.PubSub.subscribe("update_data_private_on_acc_list",function(e,t){n.data("is_private","closed-profile-off"!==t)}),h.modal("show")}),$(".js_edit-profile-modify").on("click",function(e){var t=h.find("form").get(0),n={login:t.login,username:t.username,site:t.site,about:t.biography,userAvatarImg:t.userAvatar},u={},d=!1;f.username!==n.username.value&&(u.username=n.username.value,d=!0),f.login!==n.login.value&&(u.name=n.login.value),f.about!==n.about.value&&(u.biography=n.about.value),f.site!==n.site.value&&(u.url=n.site.value),n.about.value,l.default.editInstagramAccount(f.username||"",JSON.stringify(u)).then(function(e){if("ok"===e.status.state){var t=e.data.profile;if(t.info=e.data.profile,t.info=i({},t.info,{follower_count:f.followerC,following_count:f.followingC,media_count:f.mediaC}),f.$li.replaceWith((0,c.renderItem)(t,f.$li,!1)),r(s),d){f.$li.find(a).data("username",t.info.username),d=!1}o.hide()}})}),$(".js_btn-prof-type-switcher label").on("click",function(e){var t=$(e.target).find("input[type=radio]").attr("value"),n="closed-profile-off"===t,a={open:n};l.default.editInstagramAccount(f.username||"",JSON.stringify(a)).then(function(e){"ok"===e.status.state&&window.PubSub.publish("update_data_private_on_acc_list",t)})})}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.settingButtonsHandler=s;var o=n(3),l=a(o),u=n(0),c=n(20),d=n(17),p=a(d),f=n(7),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(f)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){function t(){_()}var n=this,a=e._formId,r=e._buttonSubmitId,s=e._showLoginBoxBtnId,o=e._loginBox,u=i.default,d=$(a),m=d.find('input[name="mail"]'),g=$("#description"),h=function(e){var t=function(e){$(o).append("<p>result.status.message</p>")};return u.login(e,t).then(function(e){e&&e.data&&e.data.token?(c.default.set(f.CONST.cookieStorage.token,e.data.token),$(".nav-link.js_logOut").parent().show(),p.default.showInfoMessage(g,e.status.state,e.status.message||"Login succsess")):e.status&&p.default.showInfoMessage(n.$textAreaDescription,"<p>status: "+e.status.state+"</p><p> message: "+e.status.message+"</p>")}).then(function(e){e&&e.status&&p.default.showInfoMessage(g,e.status.state,e.status.message||"Login error")})},v=function(t){var n=m.val(),a=d.find('input[name="pass"]').val(),r=t||{email:n,password:a};e.isLoginInstagram||(m.val(m.val().toLocaleLowerCase()),h(r).then(function(){l.default.publish(f.CONST.events.USER_LOGGED,"login")}))},b=function(){c.default.remove(f.CONST.cookieStorage.token),l.default.publish(f.CONST.events.USER_LOGOUT)},_=function(){var t=$(s),n=$(o);t.on("click",function(){e.isLoginInstagram||n.css({top:0,right:0}).addClass("bg-light border mt-5 mx-auto position-absolute"),n.addClass("d-block").removeClass("d-none")});$(r).on("click",function(e){e.preventDefault();var t=d.get(0);t.checkValidity()&&p.default.isEmail(m.val())?v():(t.reportValidity&&t.reportValidity(),d.addClass("form-validation"))}),$(".nav-link.js_logOut").on("click",function(e){e.preventDefault(),b(),$(e.target).parent().hide(),p.default.showInfoMessage(g,"Logged out")}),l.default.subscribe(f.CONST.events.USER_LOGOUT,function(e){$(f.CONST.uiSelectors.headerNavLoginBtn).addClass("d-block").removeClass("d-none"),$(f.CONST.uiSelectors.headerRegBtn).addClass("d-block").removeClass("d-none"),$(".nav-link.js_logOut").addClass("d-none").removeClass("d-block"),$(".js_message_logged--text").text("Вы вышли из аккаунта")}),$(document).on("click",function(e){var t=$(e.target).closest("nav.navbar").find(n).length,a=$(e.target).attr("id")===f.CONST.uiSelectors.instagram.addAccountBtnId;t||!n.hasClass("d-block")||a||n.addClass("d-none").removeClass("d-block")})};return{init:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.LoginForm=r;var s=n(3),i=a(s),o=n(11),l=a(o),u=n(4),c=a(u),d=n(1),p=a(d),f=n(0)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){var e=$(".messages-list"),t=$(".messages-user-list");return!!e.length&&!!t.length}function s(e,t,n){var a=$(".messages-user-list");e&&h.default.getMetadataDetailUsers({cursor:e,username:n}).then(function(r){if(r.data){var s=r.data;(0,v.appendUserList)(a,s.meta,{cursor:e,section:t,username:n});var i=s.pagination;if(i&&i.prev_cursor);else{$("#collapse-"+t).closest("li").find(".js_load-more-box").addClass("d-none"),clearInterval(j)}}})}function i(e,t){var n=t||$(".messages-user-list"),a="";e||(a=n.find("li .collapse.show").attr("id")),h.default.getMetadata(C).then(function(t){if(t.data){var r=t.data;r.meta.sort(function(e,t){return e.username.localeCompare(t.username)}),(0,v.fillUserList)(n,r.meta,s),r.settings&&r.settings.invoke_in_millis&&(x=r.settings.invoke_in_millis,x=x>6e3?x:1e4),e?n.find("li:first-child .collapse").addClass("show"):$("#"+a).addClass("show"),D||(j=setInterval(function(){i()},x),D=!0)}})}function o(e,t){if(!I.allMsgLoaded){I.firstLoad&&(I.cursor=e.prev_cursor,I.firstLoad=!1);var n=S.data("conversation"),a=n.username,r=n.conversationId;_.default.add($("#mainChatPart"),"my-5 py-5"),h.default.getMetadataDetailConversation(C,{username:a,conversationId:r,cursor:I.cursor}).then(function(e){var n=e.data.meta.pagination&&e.data.meta.pagination.prev_cursor;_.default.remove(),R({$list:S,dataArray:e.data.meta.messages,isAppendPrevMsg:"appentPrevMsg",stateCfg:O,currentUserData:M}),n?(I.cursor=n,S.scrollTop(S.scrollTop()+30)):I.allMsgLoaded=!0,P&&(clearInterval(P),t(n))})}}function l(e,t){function n(e){e!==A&&(A=e,r=!0)}var a=!1,r=!0;A=t&&t.prev_cursor?t.prev_cursor:null,setTimeout(function(){S.on("scroll",function(){var e=$(this).scrollTop();a||(e+$(this).innerHeight()>=this.scrollHeight||e<=45&&(t&&r?(r=!1,o(t,n)):$(".messages-list-box").find(".load-more").remove()),a=!0,window.setTimeout(function(){a=!1},50))})},e+200)}function u(e,t,n){var a=e.username,r=e.conversationId,s=e.useravatar;h.default.getMetadataDetailConversation(C,{username:a,conversationId:r}).then(function(e){M.useravatar=s,M.username=a,(0,v.fillMassagesList)({$list:S,dataArray:e.data.meta.messages,stateCfg:O,currentUserData:M}),$("#mainChatPart").removeClass("d-none"),_.default.remove(),n?$(".js_send-message-box").addClass("d-none"):$(".js_send-message-box").removeClass("d-none"),$(".messages-list").attr("data-conversation",JSON.stringify({username:a,conversationId:r})),t&&(setTimeout(function(){S.animate({scrollTop:S[0].scrollHeight-S[0].clientHeight},10)},20),N&&(E=e.data.meta.messages[e.data.meta.messages.length-1],N=!1)),l(10,e.data.meta.pagination)})}function c(e,t){var n=S.data("conversation"),a=n.username,r=n.conversationId,s=y.CONST.getPath("instagramDirect_Basic")+"/"+a+"/"+r+"/photo",i=e.files[0],o=new FormData,l=new XMLHttpRequest;_.default.startButtonSpinner($(".file-upload-btn"),"spinner-box--sendMsg"),o.append("photo",i,i.name),l.open("POST",s),l.setRequestHeader("token",t),l.setRequestHeader("Accept","application/json"),l.setRequestHeader("cache-control","no-cache"),l.send(o),l.addEventListener("readystatechange",function(){4===this.readyState&&(e.value="",window.PubSub.publish(y.CONST.events.autoarnswer.IMAGE_UPLOADED,{response:this.responseText,el:e}))})}function d(){function e(e,n){var a=n,r="";a?$(".js_send-message-box").addClass("d-none"):(r=$(e.target).closest(".list-group-item").data(),$(".confirm-buttons-box").addClass("d-none"),$(".js_send-message-box").removeClass("d-none"));var s=n||r,i=s.username,o=s.useravatar;e.stopPropagation();var l=$(e.target).closest(".media"),c=l.find(".title");t=l.data("conversation-id"),c.hasClass("font-weight-bold")&&(c.removeClass("font-weight-bold"),l.find(".summary-dot").addClass("d-none")),_.default.remove(),_.default.add($("#mainChatPart"),"my-5 py-5"),u({username:i,conversationId:t,useravatar:o},"isScrollDown",a),N=!0,P&&clearInterval(P),P=setInterval(function(){t=$(e.target).closest(".media").data("conversation-id"),u({username:i,conversationId:t,useravatar:o},!1,a)},x)}var t="",n=$("#sendMessageTextArea");n.val(""),$("#sendMessageButton").on("click",function(e){var t=n.val(),a=S.data("conversation"),r=a.username,s=a.conversationId,i=a.useravatar;_.default.startButtonSpinner($(e.target),"spinner-box--sendMsg"),h.default.postMetadataDetailConversation(C,{username:r,conversationId:s,value:t}).then(function(e){e&&e.status&&"ok"===e.status.state&&(u({username:r,conversationId:s,useravatar:i}),n.val(""),_.default.remove())})}),(0,v.messageAreaHendler)(n,$("#sendMessageButton")),$(document).on("click",".list-group-item .collapse",e),$(document).on("click",".js_messages-request",function(n){var a=$(n.target).closest(".list-group-item").data();e(n,a),(0,T.addConfirgButtons)(t,a.username)}),window.PubSub.subscribe(y.CONST.events.messages.RECIEVE_NEW_MESSAGE,function(e,t){var n=t.username,a=t.conversationId,r=t.value;t.resultFromServer;$('.messages-user-list .list-group-item[data-username="'+n+'"] div[data-conversation-id="'+a+'"]').find(".summary").text(r)}),k.init(!1,c)}function p(){if(r()){i("setActiveFirst"),d();var e={username:"your_dieta",fillUserListFn:v.fillUserList};(0,T.initRequests)(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.init=p,n(22);var f=n(3),m=a(f),g=n(21),h=a(g),v=n(43),b=n(17),_=a(b),y=n(0),w=n(7),k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(w),T=n(42),C=m.default.getToken(),S=$(".messages-list"),O={pageIncrement:0,loadingFlag:!1,setSingleVal:!1},x="",P=!1,A="",j=!1,E="",N=!0,M={useravatar:"link",username:"name"},I={cursor:"pagination.prev_cursor",firstLoad:!0,allMsgLoaded:!1},R=function(e){function t(e,t,n){n&&$("li",e).remove(),e.css({overflow:"auto"}),$("<li/>").addClass("list-group-item text-center").text(t).appendTo(a)}var n=e.dataArray,a=e.$list,r=e.stateCfg;return"FINAL_PAGE"!==r.loadingFlag&&("FAIL"===n?(t(a,"Failure, possible key not correct.",!0),!1):"STOP_LOAD"===r.loadingFlag&&0!==n.length?(r.loadingFlag="FINAL_PAGE",t(a,"No more results.",!1),!1):null!==n&&n.length?void(0,v.fillMassagesList)(e):(t(a,"No results found.",!0),!1))};$(document).ready(function(){r()&&$('textarea[data-emoji-picker="true"]').emojioneArea({pickerPosition:"top",tonesStyle:"square",filtersPosition:"bottom",autocomplete:!0})});var D=!1},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){var a=t,r=e,s="";r.empty().addClass("border-light-color"),a.forEach(function(e,t){var n="collapse-req-"+t;e.pending_requests&&(g(e.username,n),s+='<li class="list-group-item" data-toggle="collapse" data-target="#'+n+'" \n                data-username="'+e.username+'"\n                data-userAvatar="'+e.profile_pic_url+'"\n                aria-expanded="true" aria-controls="collapse-'+t+'">\n            <div class="conversation-head mb-1 media pb-2" id="heading-'+t+'">\n                <span class="mr-3">\n                    <img src="'+e.profile_pic_url+'" alt="avatar"\n                    class="media-photo rounded-circle">\n                </span>\n                <div class="media-body">\n                    <h4 class="title">\n                        '+e.username+'\n                    </h4>\n                </div>\n            </div>\n            <div id="'+n+'" class="collapse" aria-labelledby="heading-'+t+"\" data-parent=\"#accordion-requests\">\n                \x3c!-- getRequestPending(item.username, elId) --\x3e\n            </div>\n            \x3c!-- {(pagination && pagination.prev_cursor) ? 'loadMoreBox(idx, pagination.prev_cursor)' : ''} --\x3e\n        </li>")}),$(s).appendTo(r)}function s(e,t){var n=t||$(".messages-user-list"),a="";e||(a=n.find("li .collapse.show").attr("id")),u.default.getMetadata(h).then(function(t){if(t.data){var s=t.data;s.meta.sort(function(e,t){return e.username.localeCompare(t.username)}),r(n,s.meta),e?n.find("li:first-child .collapse").addClass("show"):$("#"+a).addClass("show")}})}function i(){var e=$(".js_request-confirm-box"),t=$(".js_request-confirm",e),n=$(".js_request-reject",e);t.on("click",function(t){u.default.putRequestPending(p).then(function(t){"ok"===t.status.state&&(e.addClass("d-none"),$(".js_show-messages-user-list").trigger("click"))})}),n.on("click",function(t){u.default.delRequestPending(p).then(function(t){"ok"===t.status.state&&(e.addClass("d-none"),$(".js_show-messages-user-list").trigger("click"))})}),$(".js_show-messages-user-list").on("click",function(e){$(e.target).closest(".user-requests-box").removeClass("user-requests-box--show"),$(".user-list-box").removeClass("user-list-box--hide"),$("#mainChatPart").addClass("d-none")})}function o(e){s("setActiveFirst",$(".messages-requests-list")),i()}Object.defineProperty(t,"__esModule",{value:!0}),t.addConfirgButtons=void 0,t.initRequests=o;var l=n(21),u=a(l),c=n(3),d=a(c),p={},f=(t.addConfirgButtons=function(e,t){$(".js_request-confirm-box").removeClass("d-none"),p.username=t,p.conversationId=e},function(e){var t="";return e.forEach(function(n){var a=n.profilePicUrl;e.length>1?t+='<img src="'+a+'" alt=\'image\' class="media-photo mr-1 media-photo--group" style="width: 24px;">':t+='<img src="'+a+'" alt=\'image\' class="media-photo mr-1" style="width: 24px;">'}),t}),m=function(e){var t="";return e.forEach(function(e){var n=e.users,a=e.id,r=e.title;t+='\n                <div class="media p-1 js_messages-request messages-request" data-conversation-id="'+a+'">\n                    '+f(n)+'\n                    <div class="media-body">\n                        <h5 class="title">'+r+"</h5>\n                    </div>\n                </div>\n            "}),t},g=function(e,t){u.default.getRequestPending(e).then(function(e){var n=e.data.requests,a=m(n);$(a).appendTo($("#"+t))})},h=d.default.getToken()},function(e,t,n){"use strict";function a(e,t){t.pageIncrement=0,e.empty()}function r(e){var t=e.$list,n=e.dataArray,r=e.isAppendPrevMsg,s=e.stateCfg,i=(e.currentUserData,n),o=t,u=function(e,t,n){var a="",r="",s=t.type,i=t.caption;if("TEXT"===s){var o=/[(http(s)?):\/\/(www\.)?a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/gm;r=e.replace(o,'<a href=$& target="_blank">$&</a>')}switch(s.toLowerCase()){case"photo":a='<div class="chat-img">\n                    <img src="'+e+'" alt="Content Image" class="content-image">\n                </div>';break;case"video":a='<div class="chat-video">\n                    <a target="_blank" href="'+e+'" class="position-relative">\n                        <i class="fa-3x fa-play-circle far position-absolute text-white chat-video--icon"></i>\n                        <img src="'+t.preview_value+'" alt="Content Image" class="chat-video--image">\n                    </a>\n                </div>';break;case"gif":a='<div class="chat-img">\n                    <img src="'+e+'" alt="Content Image" class="content-image">\n                </div>';break;case"like":a='<div class="chat-text '+n+'" >'+e+"</div>";break;case"post":a='<div class="chat-post-message">\n                    <a target="_blank" href="'+e+'" class="text-body text-decoration-none">\n                        <div class="chat-post-message--header">\n                            <img src="'+t.profile_pic_url+'" alt="Content Image" class="user-avatar mr-3">\n                            '+t.username+'\n                            <i class="fas fa-chevron-right"></i>\n                        </div>\n                        <img src="'+t.preview_value+'" alt="Content Image" class="content-image">\n                        '+(i?'<p class="chat-post-caption m-3">'+i+"<p>":"")+"\n                    </a>\n                </div>";break;case"text":a='<div class="chat-text '+n+'" >'+r+"</div>";break;default:a='<div class="chat-text '+n+'" >'+e+"</div>"}return a},c=function(e,t,n){e?t.insertBefore(n.find("li:first-child")):t.appendTo(n)};r||(o.empty().addClass("border-light-color"),a(o,s),$('<li class="mt-auto"></li>').appendTo(o)),i.forEach(function(e){var t=e,n=t.value.replace(/(?:\r\n|\r|\n)/g,"<br />");if("left"===t.side.toLowerCase()){var a=$('<li class="chat-item chat-item-left col flex-column-reverse" value="'+t.value+'">\n                <div class="d-flex">\n                '+(t.profile_pic_url?'<div class="chat-img-box"> \n                            <img src="'+t.profile_pic_url+'" alt="User Avatar" class="">\n                        </div>':"")+'\n                <div>\n                    <p class="chat-username text-muted">'+t.username+"</p>\n                    "+u(n,t,"text-left")+'\n                </div>\n                    <small class="chat-time-text">'+l.default.getFormattedDateUtil(t.timestamp)+"</small>\n                </div>\n                </div>\n            </li>");c(r,a,o)}else{var s=$('<li class="chat-item chat-item-right col flex-column-reverse" value="'+t.value+'">\n                <div class="d-flex justify-content-end">\n                    '+u(n,t,"text-right")+'\n                    <small class="pull-right chat-time-text">'+l.default.getFormattedDateUtil(t.timestamp)+"</small>\n                    </div>\n            </li>");c(r,s,o)}})}function s(e,t,n){var a=(n.cursor,n.section);n.username;$("#collapse-"+a).append(c(t.conversations))}function i(e,t,n){var a=t,r=e,s="",i=function(e,t){return'<div class="list-footer text-center js_load-more-box" data-idx="'+e+'" data-cursor="'+t+'">\n        <button type="button" class="btn btn-outline-secondary btn-sm btn-submit">Загрузить еще</button>\n    </div>'};r.empty().addClass("border-light-color"),a.forEach(function(e,t){var n=e.pagination;s+='<li class="list-group-item" data-toggle="collapse" data-target="#collapse-'+t+'" \n                data-username="'+e.username+'"\n                data-userAvatar="'+e.profile_pic_url+'"\n                aria-expanded="true" aria-controls="collapse-'+t+'">\n            <div class="conversation-head mb-1 media pb-2" id="heading-'+t+'">\n                <span class="mr-3">\n                    <img src="'+e.profile_pic_url+'" alt="avatar"\n                    class="media-photo rounded-circle">\n                </span>\n                '+(e.unread_conversations>0?'<span class="badge badge-secondary position-absolute p-2">'+e.unread_conversations+"</span>":"")+'\n                <div class="media-body">\n                    <h4 class="title">\n                        '+e.username+"\n                    </h4>\n                    "+(e.pending_requests?'<p class="js_show-request-box btn btn-outline-dark btn-sm">'+e.pending_requests+" запрос"+(e.pending_requests>1?"a":"")+"</p>":"")+'\n                </div>\n            </div>\n            <div id="collapse-'+t+'" class="collapse" aria-labelledby="heading-'+t+'" data-parent="#accordion">\n                '+c(e.conversations)+"\n            </div>\n            "+(n&&n.prev_cursor?i(t,n.prev_cursor):"")+"\n        </li>"}),$(s).appendTo(r),$(".js_load-more-box button").on("click",function(e){var t=$(e.target),a=t.closest(".js_load-more-box"),r=a.data("idx"),s=a.data("cursor"),i=a.closest("li").data("username");n(s,r,i),e.stopPropagation()}),$(".js_show-request-box").on("click",function(e){$(e.target).closest(".user-list-box").addClass("user-list-box--hide"),$(".user-requests-box").addClass("user-requests-box--show"),e.stopPropagation()})}Object.defineProperty(t,"__esModule",{value:!0}),t.messageAreaHendler=t.addConversations=void 0,t.clearMassagesList=a,t.fillMassagesList=r,t.appendUserList=s,t.fillUserList=i;var o=n(1),l=function(e){return e&&e.__esModule?e:{default:e}}(o),u=function(e){var t="";return e.forEach(function(n){e.length>1?t+='<img src="'+n.profile_pic_url+'" alt=\'image\' class="media-photo mr-1 media-photo--group" style="width: 24px;">':t+='<img src="'+n.profile_pic_url+'" alt=\'image\' class="media-photo mr-1" style="width: 24px;">'}),t},c=t.addConversations=function(e){var t="";return e.forEach(function(e){var n=e.is_unread,a=e.last_message,r=a&&parseInt(a.length,10),s=r>0&&e.to.length>1&&n;t+='\n                <div class="media p-1" data-conversation-id="'+e.id+'">\n                    '+u(e.to)+'\n                    <div class="media-body">\n                        '+(s||n?'<span class="summary-dot"></span>':"")+"\n                        \x3c!-- {isUnread ? '<span class=\"summary-dot\"></span>' : ''} --\x3e\n                        <h5 class=\"title "+(n?"font-weight-bold":"")+" "+(s?"mr-2":"")+'">'+e.title+"</h5>\n                        "+(r>0&&1===e.to.length?'<p class="summary text-muted">'+a+"</p>":"")+"\n                    </div>\n                </div>\n            "}),t};t.messageAreaHendler=function(e,t){e.on("keydown",function(e){13===e.keyCode&&(e.ctrlKey?(e.preventDefault(),e.target.value+="\n"):(e.target.value.trim().length&&t.trigger("click"),e.preventDefault()))})}},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(11),o=a(i),l=n(3),u=a(l),c=n(4),d=a(c),p=n(0),f=n(1),m=a(f),g={form:".auth.register .form-signin",submitBtn:'[type="submit"]'},h=function(){function e(){r(this,e),this.user=u.default,this.$form=$(g.form),this.$email=this.$form.find('input[name="mail"]'),this.$textAreaDescription=$(".register--confirm"),this.formData={email:"test1_email@m.ru",password:"password"}}return s(e,[{key:"init",value:function(){$(".auth.register").length&&this.bindEvents()}},{key:"submitForm",value:function(e){var t=this,n=this.$email.val(),a=this.$form.find('input[name="pass"]'),r=this.$form.find('input[name="pass-confirm"]'),s=this.$form.find('input[name="pass"]').val();if(this.$form.find('input[name="pass-confirm"]').val()!==s)return a.addClass("border-danger"),void r.addClass("border-danger");a.removeClass("border-danger"),r.removeClass("border-danger"),this.$email.val(this.$email.val().toLocaleLowerCase()),this.formData=e||{email:n,password:s},this.user.register(this.formData).then(function(e){e.data&&e.data.token?(d.default.set(p.CONST.cookieStorage.emailConfirmed,"false"),d.default.set(p.CONST.cookieStorage.token,e.data.token),o.default.publish(p.CONST.events.USER_LOGGED)):m.default.showInfoMessage(t.$textAreaDescription,e.status.state,e.status.message||"no result.data found")}).then(function(e){e&&e.status&&(m.default.showInfoMessage(t.$textAreaDescription,e.status.state),$(".login-box").show())}).catch(function(e){$("#register-error-modal").modal("show")})}},{key:"bindEvents",value:function(){var e=this,t=p.CONST.uiSelectors.headerRegBox,n=$(g.submitBtn);n.on("click",function(t){var a=e.$form.get(0);t.preventDefault(),n.is(":disabled")||(a.checkValidity()?e.submitForm():(a.reportValidity&&a.reportValidity(),e.$form.addClass("form-validation")))}),o.default.subscribe(p.CONST.events.USER_LOGGED,function(){window.location.href="/instagram-integration/registration-success.html"}),$(document).on("click",function(e){!$(e.target).closest("nav.navbar").find(".register-box").length&&$(t).hasClass("d-block")&&$(t).addClass("d-none").removeClass("d-block")})}}]),e}();t.default=h},function(e,t,n){"use strict";function a(){var e=["instagram-accounts","automessages","stories","autogreeting","autocomments","follow","unfollow","messages","chat-bot"],t=window.location.pathname;e.forEach(function(e){(t==="/instagram-integration/"+e+".html"||t==="/"+e+".html")&&$('nav.aside-burger-menu a[href*="/'+e+'"]').addClass("text-info").removeClass("text-light")})}Object.defineProperty(t,"__esModule",{value:!0}),t.initMenu=a},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=M.wizardFormName,n=document.forms[t],a=n.limit;if(""===a.value)return a.focus(),!1;var r=g({},I,{user_default_config:g({},I.user_default_config,{criteria:{max_views:a.value}}),user_custom_config:{},type:N.pathType,username:j});if(r.subtype===h.CONST.url.tmTypes.storiesSubT[2]){var s=P($(n).find(M.competitors));r.user_custom_config={competitors:s}}r.subtype===h.CONST.url.tmTypes.storiesSubT[0]&&(r.user_custom_config.attachment={list_id:$(".stories__file-upload-box .file-upload-container").attr("attached-txt-id")},delete r.user_default_config.criteria.max_views),$(n).find('input[type="text"],input[type="number"],input[type="email"]').each(function(){""===$(this).val()?(e.preventDefault(),$(this).addClass("input-error")):$(this).removeClass("input-error")}),b.default.postStartFollowingList(r).then(function(e){"ok"===e.status.state&&($(".form-submit-finish").find(".alert p").remove(),$(".form-submit-finish").addClass("d-block").find(".alert").append("<p>task_id: "+e.data.task_id+"</p>"))})}function i(e){j=e}function o(e){j=e.username}function l(){(0,O.attachTxtFileHandler)(".file-upload-container"),(0,x.nextBtnvalidateCompetitorsHandler)(D,B),$(".js_get-stories-type input[type=radio]").on("click",function(e){var t=$(e.target).attr("value");I.subtype=t.toUpperCase(),I.subtype===h.CONST.url.tmTypes.storiesSubT[1]?B.removeAttr("disabled","disabled"):B.attr("disabled","disabled")}),$(".form-submit-finish .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(h.CONST.events.tasks.NEW_TASK_CREATED)}),$(".form-submit-finish--error .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(h.CONST.events.tasks.NEW_TASK_CREATED)})}function u(e){var t=e.cfg.task_modes,n=M.taskMode;A($(n),t,"просмотров"),$(n+" input[type=radio]").on("click",function(e){var t=$(e.target).attr("value");I.user_default_config.task_mode=t.toUpperCase()})}function c(){var e={type:N.pathType,subtype:I.subtype},t=function(e){var t=e.status.message;$(".form-submit-finish--error").addClass("d-block").find(".alert").append("<p>"+t+"</p>")};b.default.getStoriesConfig(e,t).then(function(e){if("ok"===e.status.state){var t=e.data.found,n=t.cfg.criteria.max_views;u(t),$("#limit").val(n)}})}function d(e){var t=M.wizardForm,n=$(t+" fieldset").get(e+1);I.subtype===h.CONST.url.tmTypes.storiesSubT[2]?((0,x.nextBtnvalidateCompetitorsHandler)(D,B),$(n).find(".js_stories-competitors").removeClass("d-none")):$(n).find(".js_stories-competitors").addClass("d-none")}function p(e){var t=M.wizardForm,n=$(t+" fieldset").get(e+1),a=$(n).find(".stories__file-upload-box"),r=$(n).find(".js_add-file-title"),s=$(n).find(".js_add-settings-step-4");I.subtype===h.CONST.url.tmTypes.storiesSubT[0]?(a.removeClass("d-none"),$(".js_validate-txt-file-is-uploaded").attr("disabled","disabled"),r.removeClass("d-none"),s.addClass("d-none")):(a.addClass("d-none"),r.addClass("d-none"),s.removeClass("d-none"))}function f(e,t){switch(e){case 0:o(t);break;case 1:c();break;case 2:d(e),p(e)}}function m(){var e=$(N.currentPageCls).length;if(e){var t={stepReducer:f,onSubmitHandler:s};k.init(t),l();var n=["По списку","По подписчикам","По активной аудитории конкурентов"];(0,S.initLogsTab)({logsState:E,logsSubtypes:h.CONST.url.tmTypes.storiesSubT,clsConst:N,setUserNameCb:i,textRusArray:n}),C.init({isInStoriesPage:e}),(0,x.initTagsInput)(),window.PubSub.subscribe(h.CONST.events.autoarnswer.TEXT_FILE_UPLOADED,function(e,t){$(".js_validate-txt-file-is-uploaded").removeAttr("disabled")})}}Object.defineProperty(t,"__esModule",{value:!0});var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.init=m;var h=n(0),v=n(2),b=r(v),_=n(1),y=r(_),w=n(6),k=a(w),T=n(47),C=a(T),S=n(13),O=n(14),x=n(10),P=y.default.getValByCommaSeparator,A=y.default.fillRadioGroupList,j="",E=h.CONST.logsState,N={currentPageCls:".stories-page",tasksList:".log-tasks",logsTabBtn:"#v-pills-logs-tab",pagination:".logs-pagination",paginationPgNumber:".page-number",pathType:h.CONST.url.tmTypes.storiesT,pathSubType:h.CONST.url.tmTypes.storiesSubT[0]},M={wizardForm:".wizard-form",wizardFormName:"wizard-form",fields:".automessages-text-fields",taskMode:".js_task-mode",competitors:'.js_stories-competitors input[data-role="tagsinput"]'},I={subtype:h.CONST.url.tmTypes.storiesSubT[0],user_default_config:{task_mode:"SAFE"}},R=$(".js_add-settings-step-4"),D=R.find('input[data-role="tagsinput"]'),B=R.find(".js_stories-competitors-btn")},function(e,t,n){"use strict";function a(e){var t=$(e.target).find("option:selected").val(),n=s({},c,{subtype:t});$(".js_logs-container").addClass("d-block"),$("option.js_empty-subtype").remove(),(0,o.getTasksData)(d,n)}function r(e){if(e.isInStoriesPage){var t=["По списку","По подписчикам","По активной аудитории конкурентов"];u.default.addDropdown(p.wrapperSubtype,i.CONST.url.tmTypes.storiesSubT,{logsState:p,dropdownOnSelectCb:a,textRusArray:t}),window.PubSub.subscribe(i.CONST.events.tasks.NEW_TASK_CREATED,function(e,t){(0,o.getTasksData)(d,c)})}}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.init=r;var i=n(0),o=n(5),l=n(18),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c={type:i.CONST.url.tmTypes.storiesT,subtype:i.CONST.url.tmTypes.storiesSubT[0]},d={$all:$(".tasks-all"),$stopped:$(".tasks-stopped")},p={wrapperSubtype:$(".subtype--box")}},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=M.wizardFormName,n=document.forms[t],a=v({},I,{user_custom_config:{},type:N.pathType,username:j});I.subtype===b.CONST.url.tmTypes.unfollowingSubT[0]&&(a.user_custom_config.attachment={list_id:$(".add-file .file-upload-container").attr("attached-txt-id")}),$(n).find('input[type="text"],input[type="number"],input[type="email"]').each(function(){""===$(this).val()?(e.preventDefault(),$(this).addClass("input-error")):$(this).removeClass("input-error")}),y.default.postStartFollowingList(a).then(function(e){"ok"===e.status.state&&($(".form-submit-finish").find(".alert p").remove(),$(".form-submit-finish").addClass("d-block").find(".alert").append("<p>task_id: "+e.data.task_id+"</p>"))})}function i(){$(M.typeRadioGroup+" input[type=radio]").on("click",function(e){var t=$(e.target).attr("value");I.subtype=t.toUpperCase()}),$(".form-submit-finish .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(b.CONST.events.tasks.NEW_TASK_CREATED)}),$(".form-submit-finish--error .close").on("click",function(){$("#v-pills-all-tab").trigger("click"),window.PubSub.publish(b.CONST.events.tasks.NEW_TASK_CREATED)})}function o(){var e=M.wizardForm;$(e).find('button[type="submit"]').attr("disabled",!1)}function l(e){!function(e){e===b.CONST.url.tmTypes.unfollowingSubT[0]?$(".add-file").addClass("d-block"):($(".add-file").addClass("d-none").removeClass("d-block"),o())}(e)}function u(e){var t=e.cfg.task_modes,n=M.taskMode;A($(n),t,"отписок"),l(e.id.subtype),$(n+" input[type=radio]").on("click",function(e){var t=$(e.target).attr("value");I.user_default_config.task_mode=t.toUpperCase()})}function c(){var e={type:N.pathType,subtype:I.subtype},t=function(e){var t=e.status.message;$(".form-submit-finish--error").addClass("d-block").find(".alert").append("<p>"+t+"</p>")};y.default.getStoriesConfig(e,t).then(function(e){if("ok"===e.status.state){u(e.data.found)}})}function d(e){j=e}function p(e){j=e.username}function f(e){var t=M.wizardForm,n=$(t+" h3").get(e+1);I.subtype===b.CONST.url.tmTypes.unfollowingSubT[0]?$(n).text("Выберите режим и добавьте файл с пользователями"):$(n).text("Выберите режим")}function m(e){var t=M.wizardForm;if(I.subtype===b.CONST.url.tmTypes.unfollowingSubT[1]){var n=$(t+" fieldset").get(e+1);$(n).find(".form-bottom>.row").after('<div class="row">\n            <label class="">Конкуренты</label>\n            <textarea class="form-control stories-competitors mb-2" rows="1"></textarea></div>')}}function g(e,t){switch(e){case 0:p(t);break;case 1:c(),f(e);break;case 2:m(e)}}function h(){var e=$(N.currentPageCls).length;if(e){var t={stepReducer:g,onSubmitHandler:s};S.init(t),i(),(0,T.attachTxtFileHandler)(".file-upload-container",o);var n=["По списку","От всех","От невзаимных"];(0,P.initLogsTab)({logsState:b.CONST.logsState,logsSubtypes:E,clsConst:N,setUserNameCb:d,textRusArray:n}),x.init({isInStoriesPage:e})}}Object.defineProperty(t,"__esModule",{value:!0});var v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.init=h;var b=n(0),_=n(2),y=r(_),w=n(1),k=r(w),T=n(14),C=n(6),S=a(C),O=n(49),x=a(O),P=n(13),A=k.default.fillRadioGroupList,j="",E=b.CONST.url.tmTypes.unfollowingSubT,N={currentPageCls:".unfollow-page",tasksList:".log-tasks",logsTabBtn:"#v-pills-logs-tab",pagination:".logs-pagination",paginationPgNumber:".page-number",pathType:b.CONST.url.tmTypes.unfollowingT,pathSubType:b.CONST.url.tmTypes.unfollowingSubT[0]},M={wizardForm:".wizard-form",wizardFormName:"wizard-form",fields:".automessages-text-fields",taskMode:".js_task-mode",typeRadioGroup:".js_get-unfollow-type",competitors:"textarea.stories-competitors"},I={subtype:b.CONST.url.tmTypes.unfollowingSubT[0],user_default_config:{task_mode:"SAFE"}}},function(e,t,n){"use strict";function a(e){var t=e.isInStoriesPage;if(t){var n={type:r.CONST.url.tmTypes.unfollowingT,subtype:r.CONST.url.tmTypes.unfollowingSubT[0],subtypes:r.CONST.url.tmTypes.unfollowingSubT},a=["По списку","От всех","От невзаимных"];i.init({isInCorrectPage:t,initialPath:n,textRusArray:a})}}Object.defineProperty(t,"__esModule",{value:!0}),t.init=a;var r=n(0),s=n(19),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){function t(){$(".auth.login").length&&b()}var n=this,a=e._formId,r=e._buttonSubmitId,s=e._loginBox,o=i.default,u=$(a),d=u.find('input[name="mail"]'),m=$("#description"),g=function(e){var t=function(e){$("#error-modal").modal("show")};return o.login(e,t).then(function(e){e&&e.data&&e.data.token?(c.default.set(f.CONST.cookieStorage.token,e.data.token),$(".nav-link.js_logOut").parent().show(),p.default.showInfoMessage(m,e.status.state,e.status.message||"Login succsess")):e.status&&p.default.showInfoMessage(n.$textAreaDescription,"<p>status: "+e.status.state+"</p><p> message: "+e.status.message+"</p>")}).then(function(e){e&&e.status&&p.default.showInfoMessage(m,e.status.state,e.status.message||"Login error")})},h=function(t){var n=d.val(),a=u.find('input[name="pass"]').val(),r=t||{email:n,password:a};e.isLoginInstagram||(d.val(d.val().toLocaleLowerCase()),g(r).then(function(){window.location.href="/instagram-integration/instagram-accounts.html"}))},v=function(){c.default.remove(f.CONST.cookieStorage.token),l.default.publish(f.CONST.events.USER_LOGOUT)},b=function(){var e=$(s);$(r).on("click",function(e){e.preventDefault();var t=u.get(0);t.checkValidity()&&p.default.isEmail(d.val())?h():(t.reportValidity&&t.reportValidity(),u.addClass("form-validation"))}),$(".nav-link.js_logOut").on("click",function(e){e.preventDefault(),v(),$(e.target).parent().hide(),p.default.showInfoMessage(m,"Logged out")}),l.default.subscribe(f.CONST.events.USER_LOGOUT,function(e){$(f.CONST.uiSelectors.headerNavLoginBtn).addClass("d-block").removeClass("d-none"),$(f.CONST.uiSelectors.headerRegBtn).addClass("d-block").removeClass("d-none"),$(".nav-link.js_logOut").addClass("d-none").removeClass("d-block"),$(".js_message_logged--text").text("Вы вышли из аккаунта")}),$(document).on("click",function(t){var n=$(t.target).closest("nav.navbar").find(e).length,a=$(t.target).attr("id")===f.CONST.uiSelectors.instagram.addAccountBtnId;n||!e.hasClass("d-block")||a||e.addClass("d-none").removeClass("d-block")})};return{init:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.LoginPage=r;var s=n(3),i=a(s),o=n(11),l=a(o),u=n(4),c=a(u),d=n(1),p=a(d),f=n(0)},function(e,t){!function(e){"use strict";function t(t,n){this.isInit=!0,this.itemsArray=[],this.$element=e(t),this.$element.hide(),this.isSelect="SELECT"===t.tagName,this.multiple=this.isSelect&&t.hasAttribute("multiple"),this.objectItems=n&&n.itemValue,this.placeholderText=t.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=e('<div class="bootstrap-tagsinput"></div>'),this.$input=e('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.before(this.$container),this.build(n),this.isInit=!1}function n(e,t){if("function"!=typeof e[t]){var n=e[t];e[t]=function(e){return e[n]}}}function a(e,t){if("function"!=typeof e[t]){var n=e[t];e[t]=function(){return n}}}function r(e){return e?l.text(e).html():""}function s(e){var t=0;if(document.selection){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length),t=n.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t}function i(t,n){var a=!1;return e.each(n,function(e,n){if("number"==typeof n&&t.which===n)return a=!0,!1;if(t.which===n.which){var r=!n.hasOwnProperty("altKey")||t.altKey===n.altKey,s=!n.hasOwnProperty("shiftKey")||t.shiftKey===n.shiftKey,i=!n.hasOwnProperty("ctrlKey")||t.ctrlKey===n.ctrlKey;if(r&&s&&i)return a=!0,!1}}),a}var o={tagClass:function(e){return"label label-info"},itemValue:function(e){return e?e.toString():e},itemText:function(e){return this.itemValue(e)},itemTitle:function(e){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],delimiter:",",delimiterRegex:null,cancelConfirmKeysOnEmpty:!1,onTagExists:function(e,t){t.hide().fadeIn()},trimValue:!1,allowDuplicates:!1};t.prototype={constructor:t,add:function(t,n,a){var s=this;if(!(s.options.maxTags&&s.itemsArray.length>=s.options.maxTags)&&(!1===t||t)){if("string"==typeof t&&s.options.trimValue&&(t=e.trim(t)),"object"==typeof t&&!s.objectItems)throw"Can't add objects when itemValue option is not set";if(!t.toString().match(/^\s*$/)){if(s.isSelect&&!s.multiple&&s.itemsArray.length>0&&s.remove(s.itemsArray[0]),"string"==typeof t&&"INPUT"===this.$element[0].tagName){var i=s.options.delimiterRegex?s.options.delimiterRegex:s.options.delimiter,o=t.split(i);if(o.length>1){for(var l=0;l<o.length;l++)this.add(o[l],!0);return void(n||s.pushVal())}}var u=s.options.itemValue(t),c=s.options.itemText(t),d=s.options.tagClass(t),p=s.options.itemTitle(t),f=e.grep(s.itemsArray,function(e){return s.options.itemValue(e)===u})[0];if(!f||s.options.allowDuplicates){if(!(s.items().toString().length+t.length+1>s.options.maxInputLength)){var m=e.Event("beforeItemAdd",{item:t,cancel:!1,options:a});if(s.$element.trigger(m),!m.cancel){s.itemsArray.push(t);var g=e('<span class="tag '+r(d)+(null!==p?'" title="'+p:"")+'">'+r(c)+'<span data-role="remove"></span></span>');g.data("item",t),s.findInputWrapper().before(g),g.after(" ");var h=e('option[value="'+encodeURIComponent(u)+'"]',s.$element).length||e('option[value="'+r(u)+'"]',s.$element).length;if(s.isSelect&&!h){var v=e("<option selected>"+r(c)+"</option>");v.data("item",t),v.attr("value",u),s.$element.append(v)}n||s.pushVal(),s.options.maxTags!==s.itemsArray.length&&s.items().toString().length!==s.options.maxInputLength||s.$container.addClass("bootstrap-tagsinput-max"),e(".typeahead, .twitter-typeahead",s.$container).length&&s.$input.typeahead("val",""),this.isInit?s.$element.trigger(e.Event("itemAddedOnInit",{item:t,options:a})):s.$element.trigger(e.Event("itemAdded",{item:t,options:a}))}}}else if(s.options.onTagExists){var b=e(".tag",s.$container).filter(function(){return e(this).data("item")===f});s.options.onTagExists(t,b)}}}},remove:function(t,n,a){var r=this;if(r.objectItems&&(t="object"==typeof t?e.grep(r.itemsArray,function(e){return r.options.itemValue(e)==r.options.itemValue(t)}):e.grep(r.itemsArray,function(e){return r.options.itemValue(e)==t}),t=t[t.length-1]),t){var s=e.Event("beforeItemRemove",{item:t,cancel:!1,options:a});if(r.$element.trigger(s),s.cancel)return;e(".tag",r.$container).filter(function(){return e(this).data("item")===t}).remove(),e("option",r.$element).filter(function(){return e(this).data("item")===t}).remove(),-1!==e.inArray(t,r.itemsArray)&&r.itemsArray.splice(e.inArray(t,r.itemsArray),1)}n||r.pushVal(),r.options.maxTags>r.itemsArray.length&&r.$container.removeClass("bootstrap-tagsinput-max"),r.$element.trigger(e.Event("itemRemoved",{item:t,options:a}))},removeAll:function(){var t=this;for(e(".tag",t.$container).remove(),e("option",t.$element).remove();t.itemsArray.length>0;)t.itemsArray.pop();t.pushVal()},refresh:function(){var t=this;e(".tag",t.$container).each(function(){var n=e(this),a=n.data("item"),s=t.options.itemValue(a),i=t.options.itemText(a),o=t.options.tagClass(a);if(n.attr("class",null),n.addClass("tag "+r(o)),n.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=r(i),t.isSelect){e("option",t.$element).filter(function(){return e(this).data("item")===a}).attr("value",s)}})},items:function(){return this.itemsArray},pushVal:function(){var t=this,n=e.map(t.items(),function(e){return t.options.itemValue(e).toString()});t.$element.val(n,!0).trigger("change")},build:function(t){var r=this;if(r.options=e.extend({},o,t),r.objectItems&&(r.options.freeInput=!1),n(r.options,"itemValue"),n(r.options,"itemText"),a(r.options,"tagClass"),r.options.typeahead){var l=r.options.typeahead||{};a(l,"source"),r.$input.typeahead(e.extend({},l,{source:function(t,n){function a(e){for(var t=[],a=0;a<e.length;a++){var i=r.options.itemText(e[a]);s[i]=e[a],t.push(i)}n(t)}this.map={};var s=this.map,i=l.source(t);e.isFunction(i.success)?i.success(a):e.isFunction(i.then)?i.then(a):e.when(i).then(a)},updater:function(e){return r.add(this.map[e]),this.map[e]},matcher:function(e){return-1!==e.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(e){return e.sort()},highlighter:function(e){var t=new RegExp("("+this.query+")","gi");return e.replace(t,"<strong>$1</strong>")}}))}if(r.options.typeaheadjs){var u=null,c={},d=r.options.typeaheadjs;e.isArray(d)?(u=d[0],c=d[1]):c=d,r.$input.typeahead(u,c).on("typeahead:selected",e.proxy(function(e,t){c.valueKey?r.add(t[c.valueKey]):r.add(t),r.$input.typeahead("val","")},r))}r.$container.on("click",e.proxy(function(e){r.$element.attr("disabled")||r.$input.removeAttr("disabled"),r.$input.focus()},r)),r.options.addOnBlur&&r.options.freeInput&&r.$input.on("focusout",e.proxy(function(t){0===e(".typeahead, .twitter-typeahead",r.$container).length&&(r.add(r.$input.val()),r.$input.val(""))},r)),r.$container.on("keydown","input",e.proxy(function(t){var n=e(t.target),a=r.findInputWrapper();if(r.$element.attr("disabled"))return void r.$input.attr("disabled","disabled");switch(t.which){case 8:if(0===s(n[0])){var i=a.prev();i.length&&r.remove(i.data("item"))}break;case 46:if(0===s(n[0])){var o=a.next();o.length&&r.remove(o.data("item"))}break;case 37:var l=a.prev();0===n.val().length&&l[0]&&(l.before(a),n.focus());break;case 39:var u=a.next();0===n.val().length&&u[0]&&(u.after(a),n.focus())}var c=n.val().length;Math.ceil(c/5);n.attr("size",Math.max(this.inputSize,n.val().length))},r)),r.$container.on("keypress","input",e.proxy(function(t){var n=e(t.target);if(r.$element.attr("disabled"))return void r.$input.attr("disabled","disabled");var a=n.val(),s=r.options.maxChars&&a.length>=r.options.maxChars;r.options.freeInput&&(i(t,r.options.confirmKeys)||s)&&(0!==a.length&&(r.add(s?a.substr(0,r.options.maxChars):a),n.val("")),!1===r.options.cancelConfirmKeysOnEmpty&&t.preventDefault());var o=n.val().length;Math.ceil(o/5);n.attr("size",Math.max(this.inputSize,n.val().length))},r)),r.$container.on("click","[data-role=remove]",e.proxy(function(t){r.$element.attr("disabled")||r.remove(e(t.target).closest(".tag").data("item"))},r)),r.options.itemValue===o.itemValue&&("INPUT"===r.$element[0].tagName?r.add(r.$element.val()):e("option",r.$element).each(function(){r.add(e(this).attr("value"),!0)}))},destroy:function(){var e=this;e.$container.off("keypress","input"),e.$container.off("click","[role=remove]"),e.$container.remove(),e.$element.removeData("tagsinput"),e.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var t=this.$input[0],n=this.$container[0];t&&t.parentNode!==n;)t=t.parentNode;return e(t)}},e.fn.tagsinput=function(n,a,r){var s=[];return this.each(function(){var i=e(this).data("tagsinput");if(i)if(n||a){if(void 0!==i[n]){if(3===i[n].length&&void 0!==r)var o=i[n](a,null,r);else var o=i[n](a);void 0!==o&&s.push(o)}}else s.push(i);else i=new t(this,n),e(this).data("tagsinput",i),s.push(i),"SELECT"===this.tagName&&e("option",e(this)).attr("selected","selected"),e(this).val(e(this).val())}),"string"==typeof n?s.length>1?s:s[0]:s},e.fn.tagsinput.Constructor=t;var l=e("<div />");e(function(){e("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery)},function(module,exports){if("undefined"==typeof brutusin)window.brutusin=new Object;else if("object"!=typeof brutusin)throw"brutusin global variable already exists";!function(){String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();(void 0===t||t>n.length)&&(t=n.length),t-=e.length;var a=n.indexOf(e,t);return-1!==a&&a===t}),String.prototype.includes||(String.prototype.includes=function(){"use strict";return-1!==String.prototype.indexOf.apply(this,arguments)}),String.prototype.format||(String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var n=new RegExp("\\{"+t+"\\}","gi");e=e.replace(n,arguments[t])}return e});var BrutusinForms=new Object;BrutusinForms.messages={validationError:"Validation error",required:"This field is **required**",invalidValue:"Invalid field value",addpropNameExistent:"This property is already present in the object",addpropNameRequired:"A name is required",minItems:"At least `{0}` items are required",maxItems:"At most `{0}` items are allowed",pattern:"Value does not match pattern: `{0}`",minLength:"Value must be **at least** `{0}` characters long",maxLength:"Value must be **at most** `{0}` characters long",multipleOf:"Value must be **multiple of** `{0}`",minimum:"Value must be **greater or equal than** `{0}`",exclusiveMinimum:"Value must be **greater than** `{0}`",maximum:"Value must be **lower or equal than** `{0}`",exclusiveMaximum:"Value must be **lower than** `{0}`",minProperties:"At least `{0}` properties are required",maxProperties:"At most `{0}` properties are allowed",uniqueItems:"Array items must be unique",addItem:"Add item",true:"True",false:"False"},BrutusinForms.decorators=new Array,BrutusinForms.addDecorator=function(e){BrutusinForms.decorators[BrutusinForms.decorators.length]=e},BrutusinForms.onResolutionStarted=function(e){},BrutusinForms.onResolutionFinished=function(e){},BrutusinForms.onValidationError=function(e,t){e.focus(),e.className.includes(" error")||(e.className+=" error"),alert(t)},BrutusinForms.onValidationSuccess=function(e){e.className=e.className.replace(" error","")},BrutusinForms.postRender=null,BrutusinForms.instances=new Array,BrutusinForms.create=function(schema){function validateDepencyMapIsAcyclic(){function e(t,n,a){if(n.hasOwnProperty(a))return void(error="Schema dependency graph has cycles");if(n[a]=null,!t.hasOwnProperty(a)){t[a]=null;var r=dependencyMap[a];if(r)for(var s=0;s<r.length;s++)e(t,n,r[s]);delete n[a]}}var t=new Object;for(var n in dependencyMap)t.hasOwnProperty(n)||e(t,new Object,n)}function appendChild(e,t,n){e.appendChild(t);for(var a=0;a<BrutusinForms.decorators.length;a++)BrutusinForms.decorators[a](t,n)}function createPseudoSchema(e){var t=new Object;for(var n in e)"items"!==n&&"properties"!==n&&"additionalProperties"!==n&&(t[n]="pattern"===n?new RegExp(e[n]):e[n]);return t}function getDefinition(e){var t=e.split("/"),n=root;for(var a in t)"0"!==a&&(n=n[t[a]]);return n}function containsStr(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}function renameRequiredPropeties(e){if(e)if(e.hasOwnProperty("oneOf"))for(var t in e.oneOf)renameRequiredPropeties(e.oneOf[t]);else if(e.hasOwnProperty("$ref")){var n=getDefinition(e.$ref);renameRequiredPropeties(n)}else if("object"===e.type){if(e.properties){e.hasOwnProperty("required")&&Array.isArray(e.required)&&(e.requiredProperties=e.required,delete e.required);for(var a in e.properties)renameRequiredPropeties(e.properties[a])}if(e.patternProperties)for(var r in e.patternProperties){var s=e.patternProperties[r];(s.hasOwnProperty("type")||s.hasOwnProperty("$ref")||s.hasOwnProperty("oneOf"))&&renameRequiredPropeties(e.patternProperties[r])}e.additionalProperties&&(e.additionalProperties.hasOwnProperty("type")||e.additionalProperties.hasOwnProperty("oneOf"))&&renameRequiredPropeties(e.additionalProperties)}else"array"===e.type&&renameRequiredPropeties(e.items)}function populateSchemaMap(e,t){var n=createPseudoSchema(t);if(n.$id=e,schemaMap[e]=n,t){if(t.hasOwnProperty("oneOf")){n.oneOf=new Array,n.type="oneOf";for(var a in t.oneOf){var r=e+"."+a;n.oneOf[a]=r,populateSchemaMap(r,t.oneOf[a])}}else if(t.hasOwnProperty("$ref")){var s=getDefinition(t.$ref);if(s){if(t.hasOwnProperty("title")||t.hasOwnProperty("description")){var i={};for(var o in s)i[o]=s[o];t.hasOwnProperty("title")&&(i.title=t.title),t.hasOwnProperty("description")&&(i.description=t.description),s=i}populateSchemaMap(e,s)}}else if("object"===t.type){if(t.properties){n.properties=new Object;for(var o in t.properties){var r=e+"."+o;n.properties[o]=r;var l=t.properties[o];t.requiredProperties&&(containsStr(t.requiredProperties,o)?l.required=!0:l.required=!1),populateSchemaMap(r,l)}}if(t.patternProperties){n.patternProperties=new Object;for(var u in t.patternProperties){var c=e+"["+u+"]";n.patternProperties[u]=c;var d=t.patternProperties[u];d.hasOwnProperty("type")||d.hasOwnProperty("$ref")||d.hasOwnProperty("oneOf")?populateSchemaMap(c,t.patternProperties[u]):populateSchemaMap(c,SCHEMA_ANY)}}if(t.additionalProperties){var r=e+"[*]";n.additionalProperties=r,t.additionalProperties.hasOwnProperty("type")||t.additionalProperties.hasOwnProperty("oneOf")?populateSchemaMap(r,t.additionalProperties):populateSchemaMap(r,SCHEMA_ANY)}}else"array"===t.type&&(n.items=e+"[#]",populateSchemaMap(n.items,t.items));if(t.hasOwnProperty("dependsOn")){null===t.dependsOn&&(t.dependsOn=["$"]);for(var p=new Array,a=0;a<t.dependsOn.length;a++)t.dependsOn[a]?t.dependsOn[a].startsWith("$")?p[a]=t.dependsOn[a]:e.endsWith("]")?p[a]=e+"."+t.dependsOn[a]:p[a]=e.substring(0,e.lastIndexOf("."))+"."+t.dependsOn[a]:p[a]="$";schemaMap[e].dependsOn=p;for(var a=0;a<p.length;a++){var f=dependencyMap[p[a]];f||(f=new Array,dependencyMap[p[a]]=f),f[f.length]=e}}}}function renderTitle(e,t,n){if(e&&t){var a=document.createElement("label");"any"!==n.type&&"object"!==n.type&&"array"!==n.type&&(a.htmlFor=getInputId());if(appendChild(a,document.createTextNode(t+":"),n),n.description&&(a.title=n.description),n.required){var r=document.createElement("sup");appendChild(r,document.createTextNode("*"),n),appendChild(a,r,n),a.className="required"}appendChild(e,a,n)}}function getInputId(){return formId+"_"+inputCounter}function validate(e){var t=!0;if(e.hasOwnProperty("getValidationError")){var n=e.getValidationError();n?(BrutusinForms.onValidationError(e,n),t=!1):BrutusinForms.onValidationSuccess(e)}if(e.childNodes)for(var a=0;a<e.childNodes.length;a++)validate(e.childNodes[a])||(t=!1);return t}function clear(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function render(e,t,n,a,r,s){var i=getSchemaId(n),o=getSchema(i);renderInfoMap[i]=new Object,renderInfoMap[i].titleContainer=e,renderInfoMap[i].container=t,renderInfoMap[i].parentObject=a,renderInfoMap[i].propertyProvider=r,renderInfoMap[i].value=s,clear(e),clear(t);var l=renderers[o.type];if(l&&!o.dependsOn)o.title?renderTitle(e,o.title,o):r&&renderTitle(e,r.getValue(),o),s||(s=void 0!==initialValue&&null!==initialValue?getInitialValue(n):o.default),l(t,n,a,r,s);else if(o.$ref&&obj.schemaResolver){var u=function(e){if(e&&e.hasOwnProperty(n)&&JSON.stringify(schemaMap[n])!==JSON.stringify(e[n])){cleanSchemaMap(n),cleanData(n),populateSchemaMap(n,e[n]);var t=renderInfoMap[n];t&&render(t.titleContainer,t.container,n,t.parentObject,t.propertyProvider,t.value)}BrutusinForms.onResolutionFinished(a)};BrutusinForms.onResolutionStarted(a),obj.schemaResolver([n],obj.getData(),u)}}function createPropertyProvider(e,t){var n=new Object;return n.getValue=e,n.onchange=t,n}function getInitialValue(id){var ret;try{eval("ret = initialValue"+id.substring(1))}catch(e){ret=null}return ret}function getValue(schema,input){if("function"==typeof input.getValue)return input.getValue();var value;return value="select"===input.tagName.toLowerCase()?input.options[input.selectedIndex].value:input.value,""===value?null:("integer"===schema.type?(value=parseInt(value),isFinite(value)||(value=null)):"number"===schema.type?(value=parseFloat(value),isFinite(value)||(value=null)):"boolean"===schema.type?"input"===input.tagName.toLowerCase()?(value=input.checked)||(value=!1):"select"===input.tagName.toLowerCase()&&(value="true"===input.value||"false"!==input.value&&null):"any"===schema.type&&value&&eval("value="+value),value)}function getSchemaId(e){return e.replace(/\["[^"]*"\]/g,"[*]").replace(/\[\d*\]/g,"[#]")}function getParentSchemaId(e){return e.substring(0,e.lastIndexOf("."))}function getSchema(e){return schemaMap[e]}function cleanSchemaMap(e){for(var t in schemaMap)e.startsWith(t)&&delete schemaMap[t]}function cleanData(e){new Expression(e).visit(data,function(e,t,n){delete t[n]})}function onDependencyChanged(e,t){var n=dependencyMap[e];if(n&&obj.schemaResolver){var a=function(e){if(e)for(var n in e)if(JSON.stringify(schemaMap[n])!==JSON.stringify(e[n])){cleanSchemaMap(n),cleanData(n),populateSchemaMap(n,e[n]);var a=renderInfoMap[n];a&&render(a.titleContainer,a.container,n,a.parentObject,a.propertyProvider,a.value)}BrutusinForms.onResolutionFinished(t)};BrutusinForms.onResolutionStarted(t),obj.schemaResolver(n,obj.getData(),a)}}function Expression(e){(null===e||0===e.length||"."===e)&&(e="$");for(var t=new Array,n=function(e){if(null===e)return null;for(var t=new Array,n=null,a=0,r=0;r<e.length;r++)'"'===e.charAt(r)?null===n?n='"':'"'===n&&(n=null,t[t.length]=e.substring(a,r+1).trim(),a=r+1):"'"===e.charAt(r)?null===n?n="'":"'"===n&&(n=null,t[t.length]=e.substring(a,r+1).trim(),a=r+1):"["===e.charAt(r)?null===n&&(a!==r&&(t[t.length]=e.substring(a,r).trim()),t[t.length]="[",a=r+1):"]"===e.charAt(r)?null===n&&(a!==r&&(t[t.length]=e.substring(a,r).trim()),t[t.length]="]",a=r+1):"."===e.charAt(r)?null===n&&(a!==r&&(t[t.length]=e.substring(a,r).trim()),a=r+1):r===e.length-1&&(t[t.length]=e.substring(a,r+1).trim());return t}(e),a=!1,r=0,s="",i=0;i<n.length;i++){var o=n[i];if("["===o){if(a)throw"Error parsing expression '"+e+"': Nested [ found";a=!0,r=0,s+=o}else if("]"===o){if(!a)throw"Error parsing expression '"+e+"': Unbalanced ] found";a=!1,s+=o,t[t.length]=s,s=""}else if(a){if(r>0)throw"Error parsing expression '"+e+"': Multiple tokens found inside a bracket";s+=o,r++}else t[t.length]=o;if(i===n.length-1&&a)throw"Error parsing expression '"+e+"': Unbalanced [ found"}this.exp=e,this.queue=t,this.visit=function(e,t){function n(e,a,r,s,i){if(null!=r){var o=a.shift();if("$"===o){e="$";var o=a.shift()}if(o)if(Array.isArray(r)){if(!o.startsWith("["))throw"Node '"+e+"' is of type array";var l=o.substring(1,o.length-1);if(l.equals("#"))for(var u=0;u<r.length;u++){var c=r[u];n(e+o,a.slice(0),c,r,u),n(e+"["+u+"]",a.slice(0),c,r,u)}else if("$"===l){var c=r[r.length-1];n(e+o,a.slice(0),c,r,r.length-1)}else{var d=parseInt(l);if(isNaN(d))throw"Element '"+l+"' of node '"+e+"' is not an integer, or the '$' last element symbol,  or the wilcard symbol '#'";if(0>d)throw"Element '"+l+"' of node '"+e+"' is lower than zero";var c=r[d];n(e+o,a.slice(0),c,r,d)}}else{if("object"!=typeof r)throw"boolean"==typeof r||"number"==typeof r||"string"==typeof r?"Node is leaf but still are tokens remaining: "+o:"Node type '"+typeof r+"' not supported for index field '"+e+"'";if("[*]"===o)for(var p in r){var c=r[p];n(e+o,a.slice(0),c,r,p),n(e+'["'+p+'"]',a.slice(0),c,r,p)}else{var c;if(o.startsWith("[")){var l=o.substring(1,o.length-1);if(!l.startsWith('"')&&!l.startsWith("'"))throw"Element '"+l+"' of node '"+e+"' must be a string expression or wilcard '*'";l=l.substring(1,l.length()-1),e+=o,c=r[l]}else e=e.length>0?e+"."+o:o,c=r[o];n(e,a,c,r,o)}}else t(r,s,i)}}n(this.exp,this.queue,e)}}var SCHEMA_ANY={type:"any"},obj=new Object,schemaMap=new Object,dependencyMap=new Object,renderInfoMap=new Object,container,data,error,initialValue,inputCounter=0,root=schema,formId="BrutusinForms#"+BrutusinForms.instances.length;renameRequiredPropeties(schema),populateSchemaMap("$",schema),validateDepencyMapIsAcyclic();var renderers=new Object;return renderers.integer=function(e,t,n,a,r){renderers.string(e,t,n,a,r)},renderers.number=function(e,t,n,a,r){renderers.string(e,t,n,a,r)},renderers.any=function(e,t,n,a,r){renderers.string(e,t,n,a,r)},renderers.string=function(e,t,n,a,r){var s,i=getSchemaId(t),o=getParentSchemaId(i),l=getSchema(i),u=getSchema(o);if("any"===l.type)s=document.createElement("textarea"),r&&(s.value=JSON.stringify(r,null,4),l.readOnly&&(s.disabled=!0));else if(l.media)s=document.createElement("input"),s.type="file",appendChild(s,c,l);else if(l.enum){if(s=document.createElement("select"),!l.required){var c=document.createElement("option"),d=document.createTextNode("");c.value="",appendChild(c,d,l),appendChild(s,c,l)}for(var p=0,f=0;f<l.enum.length;f++){var c=document.createElement("option"),d=document.createTextNode(l.enum[f]);c.value=l.enum[f],appendChild(c,d,l),appendChild(s,c,l),r&&l.enum[f]===r&&(p=f,l.required||p++,l.readOnly&&(s.disabled=!0))}1===l.enum.length?s.selectedIndex=1:s.selectedIndex=p}else{if(s=document.createElement("input"),"integer"===l.type||"number"===l.type)s.type="number",s.step=l.step?""+l.step:"any","number"!=typeof r&&(r=null);else if("date-time"===l.format)try{s.type="datetime-local"}catch(e){s.type="text"}else"email"===l.format?s.type="email":"text"===l.format?s=document.createElement("textarea"):s.type="text";null!==r&&void 0!==r&&(s.value=r,l.readOnly&&(s.disabled=!0))}return s.schema=i,s.setAttribute("autocorrect","off"),s.getValidationError=function(){try{var e=getValue(l,s);if(null===e){if(l.required){if(!u||"object"!==u.type)return BrutusinForms.messages.required;if(u.required)return BrutusinForms.messages.required;for(var t in n)if(null!==n[t])return BrutusinForms.messages.required}}else{if(l.pattern&&!l.pattern.test(e))return BrutusinForms.messages.pattern.format(l.pattern.source);if(l.minLength&&(!e||l.minLength>e.length))return BrutusinForms.messages.minLength.format(l.minLength);if(l.maxLength&&e&&l.maxLength<e.length)return BrutusinForms.messages.maxLength.format(l.maxLength)}if(null!==e&&!isNaN(e)){if(l.multipleOf&&e%l.multipleOf!=0)return BrutusinForms.messages.multipleOf.format(l.multipleOf);if(l.hasOwnProperty("maximum")){if(l.exclusiveMaximum&&e>=l.maximum)return BrutusinForms.messages.exclusiveMaximum.format(l.maximum);if(!l.exclusiveMaximum&&e>l.maximum)return BrutusinForms.messages.maximum.format(l.maximum)}if(l.hasOwnProperty("minimum")){if(l.exclusiveMinimum&&e<=l.minimum)return BrutusinForms.messages.exclusiveMinimum.format(l.minimum);if(!l.exclusiveMinimum&&e<l.minimum)return BrutusinForms.messages.minimum.format(l.minimum)}}}catch(e){return BrutusinForms.messages.invalidValue}},s.onchange=function(){var e;try{e=getValue(l,s)}catch(t){e=null}n?n[a.getValue()]=e:data=e,onDependencyChanged(i,s)},l.description&&(s.title=l.description,s.placeholder=l.description),s.onchange(),s.id=getInputId(),inputCounter++,appendChild(e,s,l),n},renderers.boolean=function(e,t,n,a,r){var s,i=getSchemaId(t),o=getSchema(i);if(o.required)s=document.createElement("input"),s.type="checkbox",!0===r&&(s.checked=!0);else{s=document.createElement("select");var l=document.createElement("option"),u=document.createTextNode("");u.value="",appendChild(l,u,o),appendChild(s,l,o);var c=document.createElement("option"),d=document.createTextNode(BrutusinForms.messages.true);c.value="true",appendChild(c,d,o),appendChild(s,c,o);var p=document.createElement("option"),f=document.createTextNode(BrutusinForms.messages.false);p.value="false",appendChild(p,f,o),appendChild(s,p,o),!0===r?s.selectedIndex=1:!1===r&&(s.selectedIndex=2)}s.onchange=function(){n?n[a.getValue()]=getValue(o,s):data=getValue(o,s),onDependencyChanged(i,s)},s.schema=i,s.id=getInputId(),inputCounter++,o.description&&(s.title=o.description),s.onchange(),appendChild(e,s,o)},renderers.oneOf=function(e,t,n,a,r){var s=getSchemaId(t),i=getSchema(s),o=document.createElement("select"),l=document.createElement("div");l.innerHTML="",o.type="select",o.schema=s;var u=document.createElement("option");u.value=null,appendChild(o,u,i);for(var c=0;c<i.oneOf.length;c++){var d=document.createElement("option"),p=s+"."+c,f=getSchema(p),m=document.createTextNode(f.title);if(d.value=i.oneOf[c],appendChild(d,m,i),appendChild(o,d,i),void 0!==r&&null!==r&&(i.readOnly&&(o.disabled=!0),r.hasOwnProperty("type")&&f.hasOwnProperty("properties")&&f.properties.hasOwnProperty("type"))){var g=getSchema(f.properties.type);r.type===g.enum[0]&&(o.selectedIndex=c+1,render(null,l,t+"."+(o.selectedIndex-1),n,a,r))}}o.onchange=function(){render(null,l,t+"."+(o.selectedIndex-1),n,a,r)},appendChild(e,o,i),appendChild(e,l,i)},renderers.object=function(e,t,n,a,r){function s(e,t,n,a,r,s){var i=getSchemaId(n),o=getSchema(i),l=t.tBodies[0],u=document.createElement("tr"),c=document.createElement("td");c.className="add-prop-name";var d=document.createElement("table"),p=document.createElement("tr"),f=document.createElement("td"),m=document.createElement("td"),g="$"+Object.keys(e).length+"$",h=document.createElement("td");h.className="prop-value";var v=document.createElement("input");v.type="text";var b;s&&(b=RegExp(s)),v.getValidationError=function(){return v.previousValue!==v.value&&e.hasOwnProperty(v.value)?BrutusinForms.messages.addpropNameExistent:v.value?void 0:BrutusinForms.messages.addpropNameRequired};var _=createPropertyProvider(function(){if(v.value){if(!b)return v.value;if(-1!==v.value.search(b))return v.value}return g},function(t){_.getValue()!==t&&(t&&e.hasOwnProperty(t)||(t=g),(e.hasOwnProperty(t)||b&&-1===_.getValue().search(b))&&(e[_.getValue()]=e[t],delete e[t]))});v.onblur=function(){if(v.previousValue!==v.value){for(var t=v.value,n=1;v.previousValue!==t&&e.hasOwnProperty(t);)t=v.value+"("+n+")",n++;return v.value=t,_.onchange(v.previousValue),void(v.previousValue=v.value)}};var y=document.createElement("button");y.setAttribute("type","button"),y.className="remove",appendChild(y,document.createTextNode("x"),o),y.onclick=function(){delete e[v.value],t.deleteRow(u.rowIndex),v.value=null,_.onchange(v.previousValue)},appendChild(f,v,o),appendChild(m,y,o),appendChild(p,f,o),appendChild(p,m,o),appendChild(d,p,o),appendChild(c,d,o),void 0!==s&&(v.placeholder=s),appendChild(u,c,o),appendChild(u,h,o),appendChild(l,u,o),appendChild(t,l,o),render(null,h,n,e,_,r),a&&(v.value=a,v.onblur())}var i=getSchemaId(t),o=getSchema(i),l=new Object;n?(a.getValue()||0===a.getValue())&&(n[a.getValue()]=l):data=l;var u=document.createElement("table");u.className="object";var c=document.createElement("tbody");appendChild(u,c,o);var d=0;if(o.hasOwnProperty("properties")){d=o.properties.length;for(var p in o.properties){var f=document.createElement("tr"),m=document.createElement("td");m.className="prop-name";var g=t+"."+p,h=getSchema(getSchemaId(g)),v=document.createElement("td");v.className="prop-value",appendChild(c,f,h),appendChild(f,m,h),appendChild(f,v,h);var b=function(e){var t=new Object;return t.getValue=function(){return e},t.onchange=function(e){},t}(p),_=null;r&&(_=r[p]),render(m,v,g,l,b,_)}}var y=[];if(o.patternProperties||o.additionalProperties){var w=document.createElement("div");if(appendChild(w,u,o),o.patternProperties)for(var k in o.patternProperties){var T=o.patternProperties[k],C=document.createElement("div");C.className="add-pattern-div";var $=document.createElement("button");if($.setAttribute("type","button"),$.pattern=k,$.id=t+"["+k+"]",$.onclick=function(){s(l,u,this.id,void 0,void 0,this.pattern)},(o.maxProperties||o.minProperties)&&($.getValidationError=function(){return o.minProperties&&d+u.rows.length<o.minProperties?BrutusinForms.messages.minProperties.format(o.minProperties):o.maxProperties&&d+u.rows.length>o.maxProperties?BrutusinForms.messages.maxProperties.format(o.maxProperties):void 0}),T.description&&($.title=T.description),appendChild($,document.createTextNode("Add "+k),o),appendChild(C,$,o),r)for(var S in r)if(!o.properties||!o.properties.hasOwnProperty(S)){var O=RegExp(k);-1!==S.search(O)&&-1===y.indexOf(S)&&(s(l,u,t+"["+k+"]",S,r[S],k),y.push(S))}appendChild(w,C,o)}if(o.additionalProperties){var x=getSchema(o.additionalProperties),$=document.createElement("button");if($.setAttribute("type","button"),$.onclick=function(){s(l,u,t+"[*]",void 0)},(o.maxProperties||o.minProperties)&&($.getValidationError=function(){return o.minProperties&&d+u.rows.length<o.minProperties?BrutusinForms.messages.minProperties.format(o.minProperties):o.maxProperties&&d+u.rows.length>o.maxProperties?BrutusinForms.messages.maxProperties.format(o.maxProperties):void 0}),x.description&&($.title=x.description),appendChild($,document.createTextNode("Add"),o),appendChild(w,$,o),r)for(var S in r)o.properties&&o.properties.hasOwnProperty(S)||-1===y.indexOf(S)&&s(l,u,t+'["'+p+'"]',S,r[S])}appendChild(e,w,o)}else appendChild(e,u,o)},renderers.array=function(e,t,n,a,r){function s(e,t,n,a,r){var s=getSchemaId(n),i=getSchema(s),o=document.createElement("tbody"),l=document.createElement("tr");l.className="item";var u=document.createElement("td");u.className="item-index";var c=document.createElement("td");c.className="item-action";var d=document.createElement("td");d.className="item-value";var p=document.createElement("button");p.setAttribute("type","button"),p.className="remove",!0===r&&(p.disabled=!0),appendChild(p,document.createTextNode("x"),i);var f=function(){for(var e=0;e<t.rows.length;e++){t.rows[e].cells[0].innerHTML=e+1}};p.onclick=function(){e.splice(l.rowIndex,1),t.deleteRow(l.rowIndex),f()},appendChild(c,p,i),appendChild(u,document.createTextNode(t.rows.length+1),i),appendChild(l,u,i),appendChild(l,c,i),appendChild(l,d,i),appendChild(o,l,i),appendChild(t,o,i);var m=createPropertyProvider(function(){return l.rowIndex});render(null,d,n,e,m,a)}var i=getSchemaId(t),o=getSchema(i),l=getSchema(o.items),u=new Array;n?(a.getValue()||0===a.getValue())&&(n[a.getValue()]=u):data=u,a&&(a.onchange=function(e){delete n[e],n[a.getValue()]=u});var c=document.createElement("div"),d=document.createElement("table");d.className="array",appendChild(c,d,o),appendChild(e,c,o);var p=document.createElement("button");if(o.readOnly&&(p.disabled=!0),p.setAttribute("type","button"),p.getValidationError=function(){if(o.minItems&&o.minItems>d.rows.length)return BrutusinForms.messages.minItems.format(o.minItems);if(o.maxItems&&o.maxItems<d.rows.length)return BrutusinForms.messages.maxItems.format(o.maxItems);if(o.uniqueItems)for(var e=0;e<u.length;e++)for(var t=e+1;t<u.length;t++)if(JSON.stringify(u[e])===JSON.stringify(u[t]))return BrutusinForms.messages.uniqueItems},p.onclick=function(){s(u,d,t+"[#]",null)},l.description&&(p.title=l.description),appendChild(p,document.createTextNode(BrutusinForms.messages.addItem),o),appendChild(c,d,o),appendChild(c,p,o),r&&r instanceof Array)for(var f=0;f<r.length;f++)s(u,d,t+"["+f+"]",r[f],o.readOnly);appendChild(e,c,o)},obj.render=function(e,t){container=e,initialValue=t;var n=document.createElement("form");if(n.className="brutusin-form",n.onsubmit=function(e){return!1},container?appendChild(container,n):appendChild(document.body,n),error){var a=document.createElement("label");appendChild(a,document.createTextNode(error)),a.className="error-message",appendChild(n,a)}else render(null,n,"$",null,null);dependencyMap.hasOwnProperty("$")&&onDependencyChanged("$"),BrutusinForms.postRender&&BrutusinForms.postRender(obj)},obj.getRenderingContainer=function(){return container},obj.validate=function(){return validate(container)},obj.getData=function(){function e(t,n){if(null===o&&(o=SCHEMA_ANY),n.$ref&&(n=getDefinition(n.$ref)),t instanceof Array){if(0===t.length)return null;for(var a=new Array,r=0;r<t.length;r++)a[r]=e(t[r],n.items);return a}if(""===t)return null;if(t instanceof Object){var a=new Object,s=!1;for(var i in t)if(!i.startsWith("$")||!i.endsWith("$")){var o=null;if(n.hasOwnProperty("properties")&&n.properties.hasOwnProperty(i)&&(o=n.properties[i]),null===o&&n.hasOwnProperty("additionalProperties")&&"object"==typeof n.additionalProperties&&(o=n.additionalProperties),null===o&&n.hasOwnProperty("patternProperties"))for(var l in n.patternProperties){var u=RegExp(l);if(-1!==i.search(u)){o=n.patternProperties[l];break}}var c=e(t[i],o);null!==c&&(a[i]=c,s=!0)}return s||n.required?a:null}return t}return container?e(data,schema):null},BrutusinForms.instances[BrutusinForms.instances.length]=obj,obj},brutusin["json-forms"]=BrutusinForms}()},function(e,t){},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";function a(e){return e&&DataView.prototype.isPrototypeOf(e)}function r(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function i(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return w.iterable&&(t[Symbol.iterator]=function(){return t}),t}function o(e){this.map={},e instanceof o?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function u(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function c(e){var t=new FileReader,n=u(t);return t.readAsArrayBuffer(e),n}function d(e){var t=new FileReader,n=u(t);return t.readAsText(e),n}function p(e){for(var t=new Uint8Array(e),n=new Array(t.length),a=0;a<t.length;a++)n[a]=String.fromCharCode(t[a]);return n.join("")}function f(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:w.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:w.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:w.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():w.arrayBuffer&&w.blob&&a(e)?(this._bodyArrayBuffer=f(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):w.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||T(e))?this._bodyArrayBuffer=f(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):w.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},w.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(c)}),this.text=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return d(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(p(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},w.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(e){var t=e.toUpperCase();return C.indexOf(t)>-1?t:e}function h(e,t){t=t||{};var n=t.body;if(e instanceof h){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new o(t.headers)),this.method=g(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function v(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),a=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(a),decodeURIComponent(r))}}),t}function b(e){var t=new o;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),a=n.shift().trim();if(a){var r=n.join(":").trim();t.append(a,r)}}),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new o(t.headers),this.url=t.url||"",this._initBody(e)}function y(e,t){return new Promise(function(n,a){function r(){i.abort()}var s=new h(e,t);if(s.signal&&s.signal.aborted)return a(new S("Aborted","AbortError"));var i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:b(i.getAllResponseHeaders()||"")};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;n(new _(t,e))},i.onerror=function(){a(new TypeError("Network request failed"))},i.ontimeout=function(){a(new TypeError("Network request failed"))},i.onabort=function(){a(new S("Aborted","AbortError"))},i.open(s.method,s.url,!0),"include"===s.credentials?i.withCredentials=!0:"omit"===s.credentials&&(i.withCredentials=!1),"responseType"in i&&w.blob&&(i.responseType="blob"),s.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),s.signal&&(s.signal.addEventListener("abort",r),i.onreadystatechange=function(){4===i.readyState&&s.signal.removeEventListener("abort",r)}),i.send(void 0===s._bodyInit?null:s._bodyInit)})}Object.defineProperty(t,"__esModule",{value:!0}),t.Headers=o,t.Request=h,t.Response=_,n.d(t,"DOMException",function(){return S}),t.fetch=y;var w={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(w.arrayBuffer)var k=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],T=ArrayBuffer.isView||function(e){return e&&k.indexOf(Object.prototype.toString.call(e))>-1};o.prototype.append=function(e,t){e=r(e),t=s(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},o.prototype.delete=function(e){delete this.map[r(e)]},o.prototype.get=function(e){return e=r(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},o.prototype.set=function(e,t){this.map[r(e)]=s(t)},o.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},o.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),i(e)},o.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),i(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),i(e)},w.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var C=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];h.prototype.clone=function(){return new h(this,{body:this._bodyInit})},m.call(h.prototype),m.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var $=[301,302,303,307,308];_.redirect=function(e,t){if(-1===$.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})};var S=self.DOMException;try{new S}catch(e){S=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},S.prototype=Object.create(Error.prototype),S.prototype.constructor=S}y.polyfill=!0,self.fetch||(self.fetch=y,self.Headers=o,self.Request=h,self.Response=_)},function(e,t,n){e.exports=n(23)}]);