!function(e){function t(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=17)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CONST={url:{base:"http://api.luxgram.ru/v1/",registration:"registration/basic/",login:"registration/basic/login",confirmation:"registration/basic/confirmation?token",instagram_addAccount:"instagram-accounts/",instagramAccount_getMetaData:"instagram-accounts/meta",instagramAccount_checkpoint:"instagram-accounts/checkpoint/",instagramAccount_confirmKey:"instagram-accounts/checkpoint/"},user:{email:"",password:"",token:""},cookieStorage:{token:"user_logged",emailConfirmed:"email_confirmed"},uiSelectors:{headerLoginBox:"nav .login-box",headerNavLoginBtn:"nav ul li .js_login",headerRegBox:"nav .register-box",headerRegBtn:"nav ul li .js_register",instagram:{addAccountBtnSelector:"#js_show-login-box",addAccountBtnId:"js_show-login-box"}},events:{USER_LOGGED:"user_logged",USER_LOGOUT:"user_logout",USER_EMAIL_CONFIRMED:"user_email_confirmed",STOP_FIXED_SPINNER:"stop_fixed_spinner"},getPath:function(e){return this.url.base+this.url[e]}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),u=n(12),c=o(u),l=n(3),d=o(l),f=function(){function e(){a(this,e),this.network=new c.default,this.cookieStorage=d.default,this.settingPost={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"}}}return i(e,[{key:"isLoggedIn",value:function(){return!!this.getToken()}},{key:"isEmailConfirmed",value:function(){return"confirmed"===this.cookieStorage.get(r.CONST.cookieStorage.emailConfirmed)}},{key:"getToken",value:function(){return this.cookieStorage.get(r.CONST.cookieStorage.token)}},{key:"login",value:function(e,t){var n=s({},this.settingPost,{body:JSON.stringify(e)});return this.network.sendRequest(r.CONST.getPath("login"),n,t)}},{key:"addInstagramAccount",value:function(e,t){var n=s({},this.settingPost,{body:JSON.stringify(e),headers:s({},this.settingPost.headers,{token:this.getToken()})});return this.network.sendRequest(r.CONST.getPath("instagram_addAccount"),n,t)}},{key:"getInstagramAccount",value:function(){var e=s({},this.settingPost,{method:"GET",headers:s({},this.settingPost.headers,{token:this.getToken()})});return this.network.sendRequest(r.CONST.getPath("instagram_addAccount"),e)}},{key:"confirm",value:function(e){return this.network.sendRequest(""+(r.CONST.getPath("confirmation")+e))}},{key:"register",value:function(e){var t=s({},this.settingPost,{body:JSON.stringify(e)});return this.network.sendRequest(r.CONST.getPath("registration"),t)}},{key:"getMetadata",value:function(e,t){return this.network.sendRequest(""+r.CONST.getPath("instagramAccount_getMetaData"),{headers:{token:e}},t)}},{key:"getSecurityKey",value:function(e,t){var n=s({},this.settingPost,{body:JSON.stringify({type:t}),headers:s({},this.settingPost.headers,{token:"3e321e60029711e99264a0481c8e17d4"})});return this.network.sendRequest(""+r.CONST.getPath("instagramAccount_checkpoint")+e,n)}},{key:"confirmSecurityKey",value:function(e,t){var n={method:"DELETE",body:JSON.stringify({security_code:e}),headers:s({},this.settingPost.headers,{token:"3e321e60029711e99264a0481c8e17d4"})};return this.network.sendRequest(""+r.CONST.getPath("instagramAccount_confirmKey")+t,n)}}]),e}(),g=null;g||(g=new f),t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(e,t,n){$(e).empty().append(t?"<p>status: "+t+"</p>":"").append("<p>"+n+" </p>")}function t(e,t){var n=t,o=e;o.empty(),n.forEach(function(e,t){var n=$('<li class="list-group-item"></li>').appendTo(o);$("<a/>").addClass("ui-all").text(e.username).appendTo(n)})}function n(e){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e)}return{showInfoMessage:e,fillList:t,isEmail:n}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a=function(){function e(e,t){var n=[],o=!0,a=!1,s=void 0;try{for(var i,r=e[Symbol.iterator]();!(o=(i=r.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){a=!0,s=e}finally{try{!o&&r.return&&r.return()}finally{if(a)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s={get:function(e){var t=document.cookie.match("(?:(?:^|.*; *)"+e+" *= *([^;]*).*$)|^.*$")[1];if(t)return decodeURIComponent(t)},set:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{path:"/",days:365};n.days&&(n["max-age"]=60*n.days*60*24,delete n.days),n=Object.entries(n).reduce(function(e,t){var n=a(t,2);return e+"; "+n[0]+"="+n[1]},""),document.cookie=e+"="+(encodeURIComponent(t)+n)},remove:function(e,t){return s.set(e,"",o({"max-age":-1,path:"/",days:0},t))}};t.default=s},function(e,t,n){(function(e){!function(n,o){"use strict";var a={};n.PubSub=a;var s=n.define;!function(e){function t(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function n(e){return function(){throw e}}function o(e,t,o){try{e(t,o)}catch(e){setTimeout(n(e),0)}}function a(e,t,n){e(t,n)}function s(e,t,n,s){var i,r=c[t],u=s?a:o;if(c.hasOwnProperty(t))for(i in r)r.hasOwnProperty(i)&&u(r[i],e,n)}function i(e,t,n){return function(){var o=String(e),a=o.lastIndexOf(".");for(s(e,e,t,n);-1!==a;)o=o.substr(0,a),a=o.lastIndexOf("."),s(e,o,t,n)}}function r(e){for(var n=String(e),o=Boolean(c.hasOwnProperty(n)&&t(c[n])),a=n.lastIndexOf(".");!o&&-1!==a;)n=n.substr(0,a),a=n.lastIndexOf("."),o=Boolean(c.hasOwnProperty(n)&&t(c[n]));return o}function u(e,t,n,o){e="symbol"==typeof e?e.toString():e;var a=i(e,t,o);return!!r(e)&&(!0===n?a():setTimeout(a,0),!0)}var c={},l=-1;e.publish=function(t,n){return u(t,n,!1,e.immediateExceptions)},e.publishSync=function(t,n){return u(t,n,!0,e.immediateExceptions)},e.subscribe=function(e,t){if("function"!=typeof t)return!1;e="symbol"==typeof e?e.toString():e,c.hasOwnProperty(e)||(c[e]={});var n="uid_"+String(++l);return c[e][n]=t,n},e.subscribeOnce=function(t,n){var o=e.subscribe(t,function(){e.unsubscribe(o),n.apply(this,arguments)});return e},e.clearAllSubscriptions=function(){c={}},e.clearSubscriptions=function(e){var t;for(t in c)c.hasOwnProperty(t)&&0===t.indexOf(e)&&delete c[t]},e.unsubscribe=function(t){var n,o,a,s="string"==typeof t&&(c.hasOwnProperty(t)||function(e){var t;for(t in c)if(c.hasOwnProperty(t)&&0===t.indexOf(e))return!0;return!1}(t)),i=!s&&"string"==typeof t,r="function"==typeof t,u=!1;if(s)return void e.clearSubscriptions(t);for(n in c)if(c.hasOwnProperty(n)){if(o=c[n],i&&o[t]){delete o[t],u=t;break}if(r)for(a in o)o.hasOwnProperty(a)&&o[a]===t&&(delete o[a],u=!0)}return u}}(a),"function"==typeof s&&s.amd?s(function(){return a}):(void 0!==e&&e.exports&&(t=e.exports=a),t.PubSub=a,e.exports=t=a)}("object"==typeof window&&window||this)}).call(t,n(16)(e))},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}n(15);var a=n(11),s=function(e){return e&&e.__esModule?e:{default:e}}(a),i=n(10),r=n(13),u=n(6),c=n(14),l=n(8),d=o(l),f=n(7),g=o(f),m=n(0),h=n(9),p=o(h),v={_loginBox:m.CONST.uiSelectors.headerLoginBox,_formId:"#js_login-form",_buttonSubmitId:"#js_login_btn",_showLoginBoxBtnId:m.CONST.uiSelectors.headerNavLoginBtn},b={_loginBox:"main .login-box",_formId:"#js_instagram-add-account",_buttonSubmitId:"#js_instagram-add-account--btn",_showLoginBoxBtnId:"#js_show-login-box",isLoginInstagram:!0},y=function(){(new s.default).init(),(0,i.LoginForm)(v).init(),(0,i.LoginForm)(b).init(),(0,r.LoginPage)({_loginBox:".auth.login .card-signin",_formId:".form-signin",_buttonSubmitId:'.form-signin [type="submit"]'}).init(),(0,c.Instagram)().init(),(0,u.confirmationWithRedirect)().init(),d.initHeader(),g.init(),p.init()};!function(){y()}()},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(){function e(){a()}var t=i.default,n=l(),o=function(e){t.confirm(e).then(function(e){if(e.status&&"ok"===e.status.state){c.default.set(r.CONST.cookieStorage.emailConfirmed,"confirmed"),c.default.set(r.CONST.cookieStorage.token,e.data.token);var t=sessionStorage.getItem("customersData");console.log(t),console.log("request succeeded with JSON response",e),$(".confirm-registration").append("<p>confirmation status: "+e.status.state+"</p>"),setTimeout(function(){window.location="./profile.html"},1e3)}else e.status,console.log(e)})},a=function(){var e=n.token;location.pathname.indexOf("confirm-registration")&&e&&(console.log("send req to ",e),o(e))};return{init:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.confirmationWithRedirect=a;var s=n(1),i=o(s),r=n(0),u=n(3),c=o(u),l=function(){var e=window.location.search,t={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,n,o){t[n]=o}),t}},function(e,t,n){"use strict";function o(e){var t=s[e],n=t.hamburgerMenuCls,o=t.hamburgerButtonCls,a=t.hamburgerButtonCloseClass,i=t.hamburgerMenuOpenedClass;$(o).toggleClass(a),$(n).toggleClass(i)}function a(){$(s.leftMenu.hamburgerButtonCls).on("click",o.bind(this,"leftMenu")),$(s.rightMenu.hamburgerButtonCls).on("click",o.bind(this,"rightMenu")),$(s.subHeader.hamburgerButtonCls).on("click",o.bind(this,"subHeader"))}Object.defineProperty(t,"__esModule",{value:!0}),t.init=a;var s={leftMenu:{hamburgerButtonCls:"#aside_mobile__button",hamburgerMenuCls:".aside-burger-menu",hamburgerMenuOpenedClass:"burger-menu--closed",hamburgerButtonCloseClass:"burger-menu__button--close"},rightMenu:{hamburgerButtonCls:"#header_mobile_toggler",hamburgerMenuCls:".r-side-burger-menu",hamburgerMenuOpenedClass:"r-side-burger-menu--open",hamburgerButtonCloseClass:"burger-menu-right__button--close"},subHeader:{hamburgerButtonCls:"#header_mobile_topbar_toggler",hamburgerMenuCls:".sub-header",hamburgerMenuOpenedClass:"sub-header--open",hamburgerButtonCloseClass:"sub-header-button--close"}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(){$(m).text("**emailNotConfirmed** Email не подтвержден.").css("color","lightcoral")}function s(e,t){$(f.CONST.uiSelectors.headerNavLoginBtn).addClass(h).removeClass(p),$(f.CONST.uiSelectors.headerRegBtn).addClass(h).removeClass(p),$(f.CONST.uiSelectors.headerLoginBox).addClass(h).removeClass(p),$(".nav-link.js_logOut").addClass(p).removeClass(h),$(g).text("**onLoginSubscribe** вы залогинились в Luxgram успешно").css("color","lightblue"),c.default.isEmailConfirmed()||a()}function i(){var e=c.default.isLoggedIn();(c.default.isEmailConfirmed()||a(),e)?($(".nav-link.js_logOut").parent().show(),$(".js_email-confirm--text").text("вы залогинились успешно"),document.referrer.includes("confirm-registration")&&$(".js_message_logged--text").text("вы подтвердили регистрацию"),s()):($(g).text("Привет анонимный пользователь"),$(m).empty())}function r(){var e=$(f.CONST.uiSelectors.headerLoginBox),t=$(f.CONST.uiSelectors.headerRegBox);d.default.subscribe(f.CONST.events.USER_LOGGED,s),i(),$(f.CONST.uiSelectors.headerRegBtn).on("click",function(){e.hide(),t.css({top:0,right:0}).addClass("bg-light border mt-5 mx-auto position-absolute px-3 d-block").removeClass("d-none")}),$(f.CONST.uiSelectors.headerNavLoginBtn).on("click",function(){e.addClass("d-block").removeClass("d-none"),t.addClass("d-none").removeClass("d-block")})}Object.defineProperty(t,"__esModule",{value:!0}),t.initHeader=r;var u=n(1),c=o(u),l=n(4),d=o(l),f=n(0),g=".js_message_logged--text",m=".js_email-confirm--text",h="d-none",p="d-block"},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(){$(".js_add-instagram-account").on("click",function(e){var t=$(e.target),n=t.closest(".modal").find(".modal-dialog .modal-body"),o=n.find('input[name="username"]').val().trim(),a=n.find('input[name="pass"]').val().trim(),s=$("form",n),i=s.get(0);if(e.preventDefault(),i.checkValidity()?f({username:o,password:a}):(i.reportValidity&&i.reportValidity(),s.addClass("form-validation")),!o||!a)return void console.log("not valid - Empty fields")})}function s(){function e(e){var t=$(e.target);t.find(".first-step").removeClass("d-none"),t.find(".second-step").addClass("d-none"),$(".js_confirm-key").val(""),$(".js_success-feedback",t).removeAttr("style").empty()}var t="";$(".js_pass-checkpoint-btn").on("click",function(e){var n=$(e.target),o=n.data("username");t=n.data("checkpointType")||t;var a="PHONE"===t?"телефон":"email";if("EMAIL_OR_PHONE"===t)return e.stopPropagation(),void $("#security-code-phoneOremail").modal({show:!0,username:o});c.default.getSecurityKey(o,t).then(function(e){if(console.log("SecurityKey received:",e.status.state),"ok"===e.status.state){var t=$("#security-code");$(".js_success-feedback",t).empty().text("Ключ подтверждения был отправлен Вам на "+a)}})}),$(".js_confirm-security-code").on("click",function(e){var t=$(e.target),n=t.data("username"),o=t.closest(".modal").find(".modal-dialog form input.js_confirm-key"),a=o.val().trim(),s=t.closest(".modal");e.stopPropagation(),6===a.length&&c.default.confirmSecurityKey(a,n).then(function(e){"ok"===e.status.state&&(console.log("js_confirm:",e.status.state,"close modal"),s.modal("hide"))}).catch(function(e){console.log("err"),$(".js_success-feedback",s).text("Запрос не отправлен").css("color","red"),console.log(e)})}),$("form input[minlength]").on("blur",function(){var e=$(this).val().trim().length;Number($(this).attr("minlength"))!==e?$(this).css("borderColor","red"):$(this).css("borderColor","#ced4da")}),$("#security-code-phoneOremail").on("hide.bs.modal",e),$("#security-code").on("hide.bs.modal",e),$(".js_get-security-code-phoneOremail").on("click",function(e){var t=$("#security-code-phoneOremail"),n=$(e.target).closest(t).find(".js_btn-type-switcher input:checked"),o=n.val(),a="PHONE"===o?"телефон":"email",s=t.data()["bs.modal"]._config,i=s.username;c.default.getSecurityKey(i,o).then(function(e){console.log("SecurityKey received:",e.status.state),"ok"===e.status.state&&($(".first-step",t).addClass("d-none"),$(".second-step",t).removeClass("d-none"),$(".js_success-feedback",t).empty().text("Ключ подтверждения был отправлен Вам на "+a))})})}function i(e,t){var n=t,o=e,a=function(e,t,n){return e?'<li class="list-inline-item '+n+'"><span class="figure">'+e+"</span><span>"+t+"</span></li>":'<li class="list-inline-item '+n+'"><span class="figure">-</span><span>'+t+"</span></li>"},s=function(e){return'<div class="col">\n            <ul class="list-inline text-center counts-list">\n            '+(e?a(e.media_count,"Публикации","media-count")+"\n                "+a(e.follower_count,"Подписчики","follower-count")+"\n                "+a(e.following_count,"Подписки","following-count"):a(!1,"Публикации","media-count")+"\n                "+a(!1,"Подписчики","follower-count")+"\n                "+a(!1,"Подписки","following-count"))+"\n            </ul>\n        </div>"};o.empty().addClass("border-light-color"),n.forEach(function(e){var t=e.info,n=e.checkpoint;t?$('<li class="media py-3">\n            '+(t.profile_pic_url?'<img class="ml-3 rounded" alt="User photo" src="'+t.profile_pic_url+'">':'<img class="ml-3 rounded" alt="default avatar" src="https://i.imgur.com/jNNT4LE.png">')+'\n            <div class="media-body d-flex">\n                <div class="col user-info">\n                    '+(e.username?'<p class="mt-0 mb-1 name">'+e.username+"</p>":"")+"\n                    "+(t.name?'<p class="mt-0 mb-1">'+t.name+"</p>":"")+"\n                    "+(t.email?'<p class="mt-0 mb-1">'+t.email+"</p>":"")+"\n                    "+(t.phone?'<p class="mt-0 mb-1">'+t.phone+"</p>":"")+'\n                </div>\n                <div class="col">                        \n                    '+("TRIGGERED"===n.status?'<button class="btn btn-outline-secondary js_pass-checkpoint-btn d-block mx-auto" data-checkpoint-type="'+n.type+'" data-toggle="modal" data-target="#security-code">\n                    <i class="fas fa-key"></i>Пройти чекпоинт</button>':"")+"\n                </div>\n                "+s(t)+"\n            </div>\n        </li>").appendTo(o):$('<li class="media py-3">\n                <img class="ml-3 rounded" alt="default avatar" src="https://i.imgur.com/jNNT4LE.png">\n                <div class="media-body d-flex">\n                    <div class="col user-info">\n                        '+(e.username?'<p class="mt-0 mb-1 name">'+e.username+"</p>":"")+'\n                    </div>\n                    <div class="col">                        \n                        '+("TRIGGERED"===n.status?'<button class="btn btn-outline-secondary js_pass-checkpoint-btn d-block mx-auto" \n                            data-checkpoint-type="'+n.type+'"\n                            data-username="'+(e.username||"")+'"\n                            data-toggle="modal" data-target="#security-code">\n                            <i class="fas fa-key"></i>Пройти чекпоинт</button>':"")+"\n                    </div>\n                    "+s()+"\n                </div>\n            </li>").appendTo(o)})}function r(){var e=$(".accounts-list");if(e.length){var t=c.default.getToken(),n=c.default.getMetadata(t),o=function(){return c.default.getMetadata(t)},r=!1,u=function t(n,a){if("ok"===!n.status.state||!n.data||!e.length||a)return e.empty(),$('<li class="media">\n                <div class="media-body">\n                    <h3 class="mt-0 mb-3">Ни одного Аккаунта не добавлено</h3>\n                </div>\n            </li>').appendTo(e),void setTimeout(function(){o().then(function(e){t(e,!1)}),console.log("Request resend")},3500);$(".profile-user .spinner-box").addClass("d-none"),i(e,n.data.accounts),s()};e.length&&(a(),n.then(function(e){var t=!1;e.data&&e.data.accounts&&!r&&e.data.accounts.forEach(function(e){if(!e.info)return t=!0,void(r=!0)}),u(e,t)}).catch(function(e){setTimeout(function(){d.default.showInfoMessage($(".error-msg"),e.status||"","Не получилось загрузить доступные Instagram аккаунты")},3e3),$(".spinner-box").addClass("d-none")}))}}Object.defineProperty(t,"__esModule",{value:!0}),t.init=r;var u=n(1),c=o(u),l=n(2),d=o(l),f=function(e){var t=function(e){console.log("ERROR",e),d.default.showInfoMessage($(".error-msg"),e.status.state,e.status.message||"Login error")};c.default.addInstagramAccount(e,t).then(function(e){if(e&&e.status){console.log(e,e.status);$(".accounts-list").empty()}}).catch(function(e){console.log(e)}),console.log("submit",e)}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e){function t(){y()}var n=this,o=e._formId,a=e._buttonSubmitId,s=e._showLoginBoxBtnId,r=e._loginBox,c=i.default,d=$(o),m=d.find('input[name="mail"]'),h=$("#description"),p=function(e){var t=function(e){$(r).append("<p>result.status.message</p>")};return c.login(e,t).then(function(e){e&&e.data&&e.data.token?(l.default.set(g.CONST.cookieStorage.token,e.data.token),$(".nav-link.js_logOut").parent().show(),f.default.showInfoMessage(h,e.status.state,e.status.message||"Login succsess")):e.status?(console.log(e),f.default.showInfoMessage(n.$textAreaDescription,"<p>status: "+e.status.state+"</p><p> message: "+e.status.message+"</p>")):console.log(e)}).then(function(e){e&&e.status&&(console.log(e),f.default.showInfoMessage(h,e.status.state,e.status.message||"Login error"))})},v=function(t){var n=m.val(),o=d.find('input[name="pass"]').val(),a=t||{email:n,password:o};e.isLoginInstagram||(m.val(m.val().toLocaleLowerCase()),p(a).then(function(){u.default.publish(g.CONST.events.USER_LOGGED,"login")}))},b=function(){l.default.remove(g.CONST.cookieStorage.token),u.default.publish(g.CONST.events.USER_LOGOUT)},y=function(){var t=$(s),n=$(r);t.on("click",function(){e.isLoginInstagram||n.css({top:0,right:0}).addClass("bg-light border mt-5 mx-auto position-absolute"),n.addClass("d-block").removeClass("d-none")});$(a).on("click",function(e){e.preventDefault();var t=d.get(0);t.checkValidity()&&f.default.isEmail(m.val())?v():(t.reportValidity&&t.reportValidity(),d.addClass("form-validation"))}),$(".nav-link.js_logOut").on("click",function(e){e.preventDefault(),b(),$(e.target).parent().hide(),f.default.showInfoMessage(h,"Logged out")}),u.default.subscribe(g.CONST.events.USER_LOGOUT,function(e){$(g.CONST.uiSelectors.headerNavLoginBtn).addClass("d-block").removeClass("d-none"),$(g.CONST.uiSelectors.headerRegBtn).addClass("d-block").removeClass("d-none"),$(".nav-link.js_logOut").addClass("d-none").removeClass("d-block"),$(".js_message_logged--text").text("Вы вышли из аккаунта")}),$(document).on("click",function(e){var t=$(e.target).closest("nav.navbar").find(n).length,o=$(e.target).attr("id")===g.CONST.uiSelectors.instagram.addAccountBtnId;t||!n.hasClass("d-block")||o||n.addClass("d-none").removeClass("d-block")})};return{init:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.LoginForm=a;var s=n(1),i=o(s),r=n(4),u=o(r),c=n(3),l=o(c),d=n(2),f=o(d),g=n(0);window.$=$},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(4),r=o(i),u=n(1),c=o(u),l=n(3),d=o(l),f=n(0),g=n(2),m=o(g),h={form:".auth .register .form-signin",submitBtn:'[type="submit"]'},p=function(){function e(){a(this,e),this.user=c.default,this.$form=$(h.form),this.$email=this.$form.find('input[name="mail"]'),this.$textAreaDescription=$("#description"),this.formData={email:"test1_email@m.ru",password:"password"}}return s(e,[{key:"init",value:function(){$(".auth.register").length&&this.bindEvents()}},{key:"submitForm",value:function(e){var t=this,n=this.$email.val(),o=this.$form.find('input[name="pass"]'),a=this.$form.find('input[name="pass-confirm"]'),s=this.$form.find('input[name="pass"]').val();if(this.$form.find('input[name="pass-confirm"]').val()!==s)return o.addClass("input-error"),void a.addClass("input-error");this.$email.val(this.$email.val().toLocaleLowerCase()),this.formData=e||{email:n,password:s},this.user.register(this.formData).then(function(e){e.data&&e.data.token?(d.default.set(f.CONST.cookieStorage.emailConfirmed,"false"),d.default.set(f.CONST.cookieStorage.token,e.data.token),r.default.publish(f.CONST.events.USER_LOGGED),m.default.showInfoMessage(t.$textAreaDescription,e.status.state,e.status.message||"Register and Login succsess")):m.default.showInfoMessage(t.$textAreaDescription,e.status.state,e.status.message||"no result.data found")}).then(function(e){e&&e.status&&(console.log(e),m.default.showInfoMessage(t.$textAreaDescription,e.status.state),$(".login-box").show())}).catch(function(e){console.log("request failed",e),m.default.showInfoMessage(t.$textAreaDescription,e.message),console.log("do something")})}},{key:"bindEvents",value:function(){var e=this,t=f.CONST.uiSelectors.headerRegBox,n=$(h.submitBtn);n.on("click",function(t){var o=e.$form.get(0);t.preventDefault(),n.is(":disabled")||(o.checkValidity()?e.submitForm():(o.reportValidity&&o.reportValidity(),e.$form.addClass("form-validation")))}),$(document).on("click",function(e){!$(e.target).closest("nav.navbar").find(".register-box").length&&$(t).hasClass("d-block")&&$(t).addClass("d-none").removeClass("d-block")})}}]),e}();t.default=p},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var n=[],o=!0,a=!1,s=void 0;try{for(var i,r=e[Symbol.iterator]();!(o=(i=r.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){a=!0,s=e}finally{try{!o&&r.return&&r.return()}finally{if(a)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(2),r=function(e){return e&&e.__esModule?e:{default:e}}(i),u=function(){function e(){o(this,e)}return s(e,[{key:"cbErrorDefault",value:function(e){var t=$("#description").length?$("#description"):$(".error-msg");r.default.showInfoMessage(t,e.status.state,e.status.message||"Login error")}},{key:"checkStatus",value:function(e){if(e.status&&e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}},{key:"sendRequest",value:function(e,t,n){var o=this;return fetch(e,t).then(function(e){return Promise.all([e,e.json()])}).then(function(e){var t=a(e,2),s=t[0],i=t[1];return s.ok||(n?n(i):o.cbErrorDefault(i),o.checkStatus(s)),i})}}]),e}();t.default=u},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e){function t(){$(".auth.login").length&&b()}var n=this,o=e._formId,a=e._buttonSubmitId,s=e._loginBox,r=i.default,c=$(o),d=c.find('input[name="mail"]'),m=$("#description"),h=function(e){var t=function(e){$(s).append("<p>result.status.message</p>")};return r.login(e,t).then(function(e){e&&e.data&&e.data.token?(l.default.set(g.CONST.cookieStorage.token,e.data.token),$(".nav-link.js_logOut").parent().show(),f.default.showInfoMessage(m,e.status.state,e.status.message||"Login succsess")):e.status?(console.log(e),f.default.showInfoMessage(n.$textAreaDescription,"<p>status: "+e.status.state+"</p><p> message: "+e.status.message+"</p>")):console.log(e)}).then(function(e){e&&e.status&&(console.log(e),f.default.showInfoMessage(m,e.status.state,e.status.message||"Login error"))})},p=function(t){var n=d.val(),o=c.find('input[name="pass"]').val(),a=t||{email:n,password:o};e.isLoginInstagram||(d.val(d.val().toLocaleLowerCase()),h(a).then(function(){window.location.href="/instagram-integration/instagram-accounts.html"}))},v=function(){l.default.remove(g.CONST.cookieStorage.token),u.default.publish(g.CONST.events.USER_LOGOUT)},b=function(){var e=$(s);$(a).on("click",function(e){e.preventDefault();var t=c.get(0);console.log(f.default,f.default.isEmail(d.val())),t.checkValidity()&&f.default.isEmail(d.val())?p():(t.reportValidity&&t.reportValidity(),c.addClass("form-validation"))}),$(".nav-link.js_logOut").on("click",function(e){e.preventDefault(),v(),$(e.target).parent().hide(),f.default.showInfoMessage(m,"Logged out")}),u.default.subscribe(g.CONST.events.USER_LOGOUT,function(e){$(g.CONST.uiSelectors.headerNavLoginBtn).addClass("d-block").removeClass("d-none"),$(g.CONST.uiSelectors.headerRegBtn).addClass("d-block").removeClass("d-none"),$(".nav-link.js_logOut").addClass("d-none").removeClass("d-block"),$(".js_message_logged--text").text("Вы вышли из аккаунта")}),$(document).on("click",function(t){var n=$(t.target).closest("nav.navbar").find(e).length,o=$(t.target).attr("id")===g.CONST.uiSelectors.instagram.addAccountBtnId;n||!e.hasClass("d-block")||o||e.addClass("d-none").removeClass("d-block")})};return{init:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.LoginPage=a;var s=n(1),i=o(s),r=n(4),u=o(r),c=n(3),l=o(c),d=n(2),f=o(d),g=n(0)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(){function e(){s()}var t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],$("#js_instagram-get-accounts--btn")),n=i.default,o=$(".instagram-accounts-list"),a=function(e){if(t.length)return n.getInstagramAccount().then(function(e){e&&e.status&&(console.log(e),u.default.fillList(o,e.data.accounts||"Login error"))}),void console.log("getInstagramAccount ",t)},s=function(){t.on("click",function(e){e.preventDefault(),a()})};return{init:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Instagram=a;var s=n(1),i=o(s),r=n(2),u=o(r)},function(e,t){},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){e.exports=n(5)}]);
//# sourceMappingURL=index-app.map